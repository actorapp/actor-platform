//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/ex3ndr/Develop/actor-model/library/actor-cocoa-base/build/java/org/bouncycastle/math/ec/ECPoint.java
//


#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/lang/IllegalArgumentException.h"
#include "java/lang/IllegalStateException.h"
#include "java/lang/StringBuffer.h"
#include "java/lang/System.h"
#include "java/math/BigInteger.h"
#include "java/util/HashMap.h"
#include "org/bouncycastle/math/ec/ECAlgorithms.h"
#include "org/bouncycastle/math/ec/ECConstants.h"
#include "org/bouncycastle/math/ec/ECCurve.h"
#include "org/bouncycastle/math/ec/ECFieldElement.h"
#include "org/bouncycastle/math/ec/ECMultiplier.h"
#include "org/bouncycastle/math/ec/ECPoint.h"

#pragma clang diagnostic ignored "-Wprotocol"
#pragma clang diagnostic ignored "-Wincomplete-implementation"

__attribute__((unused)) static OrgBouncycastleMathEcECFieldElement *OrgBouncycastleMathEcECPoint_getRawXCoord(OrgBouncycastleMathEcECPoint *self);

__attribute__((unused)) static OrgBouncycastleMathEcECFieldElement *OrgBouncycastleMathEcECPoint_getRawYCoord(OrgBouncycastleMathEcECPoint *self);

__attribute__((unused)) static IOSObjectArray *OrgBouncycastleMathEcECPoint_getRawZCoords(OrgBouncycastleMathEcECPoint *self);

@interface OrgBouncycastleMathEcECPoint_F2m ()

+ (void)checkPointsWithOrgBouncycastleMathEcECPoint:(OrgBouncycastleMathEcECPoint *)a
                   withOrgBouncycastleMathEcECPoint:(OrgBouncycastleMathEcECPoint *)b;

@end

__attribute__((unused)) static void OrgBouncycastleMathEcECPoint_F2m_checkPointsWithOrgBouncycastleMathEcECPoint_withOrgBouncycastleMathEcECPoint_(OrgBouncycastleMathEcECPoint *a, OrgBouncycastleMathEcECPoint *b);

J2OBJC_INITIALIZED_DEFN(OrgBouncycastleMathEcECPoint)

IOSObjectArray *OrgBouncycastleMathEcECPoint_EMPTY_ZS_;

@implementation OrgBouncycastleMathEcECPoint

+ (IOSObjectArray *)getInitialZCoordsWithOrgBouncycastleMathEcECCurve:(OrgBouncycastleMathEcECCurve *)curve {
  return OrgBouncycastleMathEcECPoint_getInitialZCoordsWithOrgBouncycastleMathEcECCurve_(curve);
}

- (instancetype)initWithOrgBouncycastleMathEcECCurve:(OrgBouncycastleMathEcECCurve *)curve
             withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)x
             withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)y {
  OrgBouncycastleMathEcECPoint_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_(self, curve, x, y);
  return self;
}

- (instancetype)initWithOrgBouncycastleMathEcECCurve:(OrgBouncycastleMathEcECCurve *)curve
             withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)x
             withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)y
        withOrgBouncycastleMathEcECFieldElementArray:(IOSObjectArray *)zs {
  OrgBouncycastleMathEcECPoint_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_(self, curve, x, y, zs);
  return self;
}

- (jboolean)satisfiesCofactor {
  JavaMathBigInteger *h = [((OrgBouncycastleMathEcECCurve *) nil_chk(curve_)) getCofactor];
  return h == nil || [h isEqual:OrgBouncycastleMathEcECConstants_get_ONE_()] || ![((OrgBouncycastleMathEcECPoint *) nil_chk(OrgBouncycastleMathEcECAlgorithms_referenceMultiplyWithOrgBouncycastleMathEcECPoint_withJavaMathBigInteger_(self, h))) isInfinity];
}

- (OrgBouncycastleMathEcECPoint *)getDetachedPoint {
  return [((OrgBouncycastleMathEcECPoint *) nil_chk([self normalize])) detach];
}

- (OrgBouncycastleMathEcECCurve *)getCurve {
  return curve_;
}

- (jint)getCurveCoordinateSystem {
  return nil == curve_ ? OrgBouncycastleMathEcECCurve_COORD_AFFINE : [curve_ getCoordinateSystem];
}

- (OrgBouncycastleMathEcECFieldElement *)getX {
  return [((OrgBouncycastleMathEcECPoint *) nil_chk([self normalize])) getXCoord];
}

- (OrgBouncycastleMathEcECFieldElement *)getY {
  return [((OrgBouncycastleMathEcECPoint *) nil_chk([self normalize])) getYCoord];
}

- (OrgBouncycastleMathEcECFieldElement *)getAffineXCoord {
  [self checkNormalized];
  return [self getXCoord];
}

- (OrgBouncycastleMathEcECFieldElement *)getAffineYCoord {
  [self checkNormalized];
  return [self getYCoord];
}

- (OrgBouncycastleMathEcECFieldElement *)getXCoord {
  return x_;
}

- (OrgBouncycastleMathEcECFieldElement *)getYCoord {
  return y_;
}

- (OrgBouncycastleMathEcECFieldElement *)getZCoordWithInt:(jint)index {
  return (index < 0 || index >= ((IOSObjectArray *) nil_chk(zs_))->size_) ? nil : IOSObjectArray_Get(zs_, index);
}

- (IOSObjectArray *)getZCoords {
  jint zsLen = ((IOSObjectArray *) nil_chk(zs_))->size_;
  if (zsLen == 0) {
    return zs_;
  }
  IOSObjectArray *copy_ = [IOSObjectArray newArrayWithLength:zsLen type:OrgBouncycastleMathEcECFieldElement_class_()];
  JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(zs_, 0, copy_, 0, zsLen);
  return copy_;
}

- (OrgBouncycastleMathEcECFieldElement *)getRawXCoord {
  return OrgBouncycastleMathEcECPoint_getRawXCoord(self);
}

- (OrgBouncycastleMathEcECFieldElement *)getRawYCoord {
  return OrgBouncycastleMathEcECPoint_getRawYCoord(self);
}

- (IOSObjectArray *)getRawZCoords {
  return OrgBouncycastleMathEcECPoint_getRawZCoords(self);
}

- (void)checkNormalized {
  if (![self isNormalized]) {
    @throw new_JavaLangIllegalStateException_initWithNSString_(@"point not in normal form");
  }
}

- (jboolean)isNormalized {
  jint coord = [self getCurveCoordinateSystem];
  return coord == OrgBouncycastleMathEcECCurve_COORD_AFFINE || coord == OrgBouncycastleMathEcECCurve_COORD_LAMBDA_AFFINE || [self isInfinity] || [((OrgBouncycastleMathEcECFieldElement *) nil_chk(IOSObjectArray_Get(nil_chk(zs_), 0))) isOne];
}

- (OrgBouncycastleMathEcECPoint *)normalize {
  if ([self isInfinity]) {
    return self;
  }
  switch ([self getCurveCoordinateSystem]) {
    case OrgBouncycastleMathEcECCurve_COORD_AFFINE:
    case OrgBouncycastleMathEcECCurve_COORD_LAMBDA_AFFINE:
    {
      return self;
    }
    default:
    {
      OrgBouncycastleMathEcECFieldElement *Z1 = [self getZCoordWithInt:0];
      if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z1)) isOne]) {
        return self;
      }
      return [self normalizeWithOrgBouncycastleMathEcECFieldElement:[Z1 invert]];
    }
  }
}

- (OrgBouncycastleMathEcECPoint *)normalizeWithOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)zInv {
  switch ([self getCurveCoordinateSystem]) {
    case OrgBouncycastleMathEcECCurve_COORD_HOMOGENEOUS:
    case OrgBouncycastleMathEcECCurve_COORD_LAMBDA_PROJECTIVE:
    {
      return [self createScaledPointWithOrgBouncycastleMathEcECFieldElement:zInv withOrgBouncycastleMathEcECFieldElement:zInv];
    }
    case OrgBouncycastleMathEcECCurve_COORD_JACOBIAN:
    case OrgBouncycastleMathEcECCurve_COORD_JACOBIAN_CHUDNOVSKY:
    case OrgBouncycastleMathEcECCurve_COORD_JACOBIAN_MODIFIED:
    {
      OrgBouncycastleMathEcECFieldElement *zInv2 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(zInv)) square], *zInv3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(zInv2)) multiplyWithOrgBouncycastleMathEcECFieldElement:zInv];
      return [self createScaledPointWithOrgBouncycastleMathEcECFieldElement:zInv2 withOrgBouncycastleMathEcECFieldElement:zInv3];
    }
    default:
    {
      @throw new_JavaLangIllegalStateException_initWithNSString_(@"not a projective coordinate system");
    }
  }
}

- (OrgBouncycastleMathEcECPoint *)createScaledPointWithOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)sx
                                                   withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)sy {
  return [((OrgBouncycastleMathEcECCurve *) nil_chk([self getCurve])) createRawPointWithOrgBouncycastleMathEcECFieldElement:[((OrgBouncycastleMathEcECFieldElement *) nil_chk(OrgBouncycastleMathEcECPoint_getRawXCoord(self))) multiplyWithOrgBouncycastleMathEcECFieldElement:sx] withOrgBouncycastleMathEcECFieldElement:[((OrgBouncycastleMathEcECFieldElement *) nil_chk(OrgBouncycastleMathEcECPoint_getRawYCoord(self))) multiplyWithOrgBouncycastleMathEcECFieldElement:sy] withBoolean:self->withCompression_];
}

- (jboolean)isInfinity {
  return x_ == nil || y_ == nil || (((IOSObjectArray *) nil_chk(zs_))->size_ > 0 && [((OrgBouncycastleMathEcECFieldElement *) nil_chk(IOSObjectArray_Get(zs_, 0))) isZero]);
}

- (jboolean)isCompressed {
  return self->withCompression_;
}

- (jboolean)isValid {
  if ([self isInfinity]) {
    return YES;
  }
  OrgBouncycastleMathEcECCurve *curve = [self getCurve];
  if (curve != nil) {
    if (![self satisfiesCurveEquation]) {
      return NO;
    }
    if (![self satisfiesCofactor]) {
      return NO;
    }
  }
  return YES;
}

- (OrgBouncycastleMathEcECPoint *)scaleXWithOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)scale_ {
  return [self isInfinity] ? self : [((OrgBouncycastleMathEcECCurve *) nil_chk([self getCurve])) createRawPointWithOrgBouncycastleMathEcECFieldElement:[((OrgBouncycastleMathEcECFieldElement *) nil_chk(OrgBouncycastleMathEcECPoint_getRawXCoord(self))) multiplyWithOrgBouncycastleMathEcECFieldElement:scale_] withOrgBouncycastleMathEcECFieldElement:OrgBouncycastleMathEcECPoint_getRawYCoord(self) withOrgBouncycastleMathEcECFieldElementArray:OrgBouncycastleMathEcECPoint_getRawZCoords(self) withBoolean:self->withCompression_];
}

- (OrgBouncycastleMathEcECPoint *)scaleYWithOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)scale_ {
  return [self isInfinity] ? self : [((OrgBouncycastleMathEcECCurve *) nil_chk([self getCurve])) createRawPointWithOrgBouncycastleMathEcECFieldElement:OrgBouncycastleMathEcECPoint_getRawXCoord(self) withOrgBouncycastleMathEcECFieldElement:[((OrgBouncycastleMathEcECFieldElement *) nil_chk(OrgBouncycastleMathEcECPoint_getRawYCoord(self))) multiplyWithOrgBouncycastleMathEcECFieldElement:scale_] withOrgBouncycastleMathEcECFieldElementArray:OrgBouncycastleMathEcECPoint_getRawZCoords(self) withBoolean:self->withCompression_];
}

- (jboolean)equalsWithOrgBouncycastleMathEcECPoint:(OrgBouncycastleMathEcECPoint *)other {
  if (nil == other) {
    return NO;
  }
  OrgBouncycastleMathEcECCurve *c1 = [self getCurve], *c2 = [((OrgBouncycastleMathEcECPoint *) nil_chk(other)) getCurve];
  jboolean n1 = nil == c1, n2 = nil == c2;
  jboolean i1 = [self isInfinity], i2 = [other isInfinity];
  if (i1 || i2) {
    return (i1 && i2) && (n1 || n2 || [((OrgBouncycastleMathEcECCurve *) nil_chk(c1)) equalsWithOrgBouncycastleMathEcECCurve:c2]);
  }
  OrgBouncycastleMathEcECPoint *p1 = self, *p2 = other;
  if (n1 && n2) {
  }
  else if (n1) {
    p2 = [p2 normalize];
  }
  else if (n2) {
    p1 = [p1 normalize];
  }
  else if (![((OrgBouncycastleMathEcECCurve *) nil_chk(c1)) equalsWithOrgBouncycastleMathEcECCurve:c2]) {
    return NO;
  }
  else {
    IOSObjectArray *points = [IOSObjectArray newArrayWithObjects:(id[]){ self, [c1 importPointWithOrgBouncycastleMathEcECPoint:p2] } count:2 type:OrgBouncycastleMathEcECPoint_class_()];
    [c1 normalizeAllWithOrgBouncycastleMathEcECPointArray:points];
    p1 = IOSObjectArray_Get(points, 0);
    p2 = IOSObjectArray_Get(points, 1);
  }
  return [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECPoint *) nil_chk(p1)) getXCoord])) isEqual:[((OrgBouncycastleMathEcECPoint *) nil_chk(p2)) getXCoord]] && [((OrgBouncycastleMathEcECFieldElement *) nil_chk([p1 getYCoord])) isEqual:[p2 getYCoord]];
}

- (jboolean)isEqual:(id)other {
  if (other == self) {
    return YES;
  }
  if (!([other isKindOfClass:[OrgBouncycastleMathEcECPoint class]])) {
    return NO;
  }
  return [self equalsWithOrgBouncycastleMathEcECPoint:(OrgBouncycastleMathEcECPoint *) check_class_cast(other, [OrgBouncycastleMathEcECPoint class])];
}

- (NSUInteger)hash {
  OrgBouncycastleMathEcECCurve *c = [self getCurve];
  jint hc = (nil == c) ? 0 : ~((jint) [c hash]);
  if (![self isInfinity]) {
    OrgBouncycastleMathEcECPoint *p = [self normalize];
    hc ^= ((jint) [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECPoint *) nil_chk(p)) getXCoord])) hash]) * 17;
    hc ^= ((jint) [((OrgBouncycastleMathEcECFieldElement *) nil_chk([p getYCoord])) hash]) * 257;
  }
  return hc;
}

- (NSString *)description {
  if ([self isInfinity]) {
    return @"INF";
  }
  JavaLangStringBuffer *sb = new_JavaLangStringBuffer_init();
  (void) [sb appendWithChar:'('];
  (void) [sb appendWithId:OrgBouncycastleMathEcECPoint_getRawXCoord(self)];
  (void) [sb appendWithChar:','];
  (void) [sb appendWithId:OrgBouncycastleMathEcECPoint_getRawYCoord(self)];
  for (jint i = 0; i < ((IOSObjectArray *) nil_chk(zs_))->size_; ++i) {
    (void) [sb appendWithChar:','];
    (void) [sb appendWithId:IOSObjectArray_Get(zs_, i)];
  }
  (void) [sb appendWithChar:')'];
  return [sb description];
}

- (IOSByteArray *)getEncoded {
  return [self getEncodedWithBoolean:self->withCompression_];
}

- (IOSByteArray *)getEncodedWithBoolean:(jboolean)compressed {
  if ([self isInfinity]) {
    return [IOSByteArray newArrayWithLength:1];
  }
  OrgBouncycastleMathEcECPoint *normed = [self normalize];
  IOSByteArray *X = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECPoint *) nil_chk(normed)) getXCoord])) getEncoded];
  if (compressed) {
    IOSByteArray *PO = [IOSByteArray newArrayWithLength:((IOSByteArray *) nil_chk(X))->size_ + 1];
    *IOSByteArray_GetRef(PO, 0) = (jbyte) ([normed getCompressionYTilde] ? (jint) 0x03 : (jint) 0x02);
    JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(X, 0, PO, 1, X->size_);
    return PO;
  }
  IOSByteArray *Y = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([normed getYCoord])) getEncoded];
  IOSByteArray *PO = [IOSByteArray newArrayWithLength:((IOSByteArray *) nil_chk(X))->size_ + ((IOSByteArray *) nil_chk(Y))->size_ + 1];
  *IOSByteArray_GetRef(PO, 0) = (jint) 0x04;
  JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(X, 0, PO, 1, X->size_);
  JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(Y, 0, PO, X->size_ + 1, Y->size_);
  return PO;
}

- (OrgBouncycastleMathEcECPoint *)timesPow2WithInt:(jint)e {
  if (e < 0) {
    @throw new_JavaLangIllegalArgumentException_initWithNSString_(@"'e' cannot be negative");
  }
  OrgBouncycastleMathEcECPoint *p = self;
  while (--e >= 0) {
    p = [p twice];
  }
  return p;
}

- (OrgBouncycastleMathEcECPoint *)twicePlusWithOrgBouncycastleMathEcECPoint:(OrgBouncycastleMathEcECPoint *)b {
  return [((OrgBouncycastleMathEcECPoint *) nil_chk([self twice])) addWithOrgBouncycastleMathEcECPoint:b];
}

- (OrgBouncycastleMathEcECPoint *)threeTimes {
  return [self twicePlusWithOrgBouncycastleMathEcECPoint:self];
}

- (OrgBouncycastleMathEcECPoint *)multiplyWithJavaMathBigInteger:(JavaMathBigInteger *)k {
  return [((id<OrgBouncycastleMathEcECMultiplier>) nil_chk([((OrgBouncycastleMathEcECCurve *) nil_chk([self getCurve])) getMultiplier])) multiplyWithOrgBouncycastleMathEcECPoint:self withJavaMathBigInteger:k];
}

+ (void)initialize {
  if (self == [OrgBouncycastleMathEcECPoint class]) {
    OrgBouncycastleMathEcECPoint_EMPTY_ZS_ = [IOSObjectArray newArrayWithLength:0 type:OrgBouncycastleMathEcECFieldElement_class_()];
    J2OBJC_SET_INITIALIZED(OrgBouncycastleMathEcECPoint)
  }
}

@end

IOSObjectArray *OrgBouncycastleMathEcECPoint_getInitialZCoordsWithOrgBouncycastleMathEcECCurve_(OrgBouncycastleMathEcECCurve *curve) {
  OrgBouncycastleMathEcECPoint_initialize();
  jint coord = nil == curve ? OrgBouncycastleMathEcECCurve_COORD_AFFINE : [curve getCoordinateSystem];
  switch (coord) {
    case OrgBouncycastleMathEcECCurve_COORD_AFFINE:
    case OrgBouncycastleMathEcECCurve_COORD_LAMBDA_AFFINE:
    return OrgBouncycastleMathEcECPoint_EMPTY_ZS_;
    default:
    break;
  }
  OrgBouncycastleMathEcECFieldElement *one = [((OrgBouncycastleMathEcECCurve *) nil_chk(curve)) fromBigIntegerWithJavaMathBigInteger:OrgBouncycastleMathEcECConstants_get_ONE_()];
  switch (coord) {
    case OrgBouncycastleMathEcECCurve_COORD_HOMOGENEOUS:
    case OrgBouncycastleMathEcECCurve_COORD_JACOBIAN:
    case OrgBouncycastleMathEcECCurve_COORD_LAMBDA_PROJECTIVE:
    return [IOSObjectArray newArrayWithObjects:(id[]){ one } count:1 type:OrgBouncycastleMathEcECFieldElement_class_()];
    case OrgBouncycastleMathEcECCurve_COORD_JACOBIAN_CHUDNOVSKY:
    return [IOSObjectArray newArrayWithObjects:(id[]){ one, one, one } count:3 type:OrgBouncycastleMathEcECFieldElement_class_()];
    case OrgBouncycastleMathEcECCurve_COORD_JACOBIAN_MODIFIED:
    return [IOSObjectArray newArrayWithObjects:(id[]){ one, [curve getA] } count:2 type:OrgBouncycastleMathEcECFieldElement_class_()];
    default:
    @throw new_JavaLangIllegalArgumentException_initWithNSString_(@"unknown coordinate system");
  }
}

void OrgBouncycastleMathEcECPoint_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_(OrgBouncycastleMathEcECPoint *self, OrgBouncycastleMathEcECCurve *curve, OrgBouncycastleMathEcECFieldElement *x, OrgBouncycastleMathEcECFieldElement *y) {
  (void) OrgBouncycastleMathEcECPoint_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_(self, curve, x, y, OrgBouncycastleMathEcECPoint_getInitialZCoordsWithOrgBouncycastleMathEcECCurve_(curve));
}

void OrgBouncycastleMathEcECPoint_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_(OrgBouncycastleMathEcECPoint *self, OrgBouncycastleMathEcECCurve *curve, OrgBouncycastleMathEcECFieldElement *x, OrgBouncycastleMathEcECFieldElement *y, IOSObjectArray *zs) {
  (void) NSObject_init(self);
  self->preCompTable_ = nil;
  self->curve_ = curve;
  self->x_ = x;
  self->y_ = y;
  self->zs_ = zs;
}

OrgBouncycastleMathEcECFieldElement *OrgBouncycastleMathEcECPoint_getRawXCoord(OrgBouncycastleMathEcECPoint *self) {
  return self->x_;
}

OrgBouncycastleMathEcECFieldElement *OrgBouncycastleMathEcECPoint_getRawYCoord(OrgBouncycastleMathEcECPoint *self) {
  return self->y_;
}

IOSObjectArray *OrgBouncycastleMathEcECPoint_getRawZCoords(OrgBouncycastleMathEcECPoint *self) {
  return self->zs_;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgBouncycastleMathEcECPoint)

@implementation OrgBouncycastleMathEcECPoint_AbstractFp

- (instancetype)initWithOrgBouncycastleMathEcECCurve:(OrgBouncycastleMathEcECCurve *)curve
             withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)x
             withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)y {
  OrgBouncycastleMathEcECPoint_AbstractFp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_(self, curve, x, y);
  return self;
}

- (instancetype)initWithOrgBouncycastleMathEcECCurve:(OrgBouncycastleMathEcECCurve *)curve
             withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)x
             withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)y
        withOrgBouncycastleMathEcECFieldElementArray:(IOSObjectArray *)zs {
  OrgBouncycastleMathEcECPoint_AbstractFp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_(self, curve, x, y, zs);
  return self;
}

- (jboolean)getCompressionYTilde {
  return [((OrgBouncycastleMathEcECFieldElement *) nil_chk([self getAffineYCoord])) testBitZero];
}

- (jboolean)satisfiesCurveEquation {
  OrgBouncycastleMathEcECFieldElement *X = self->x_, *Y = self->y_, *A = [((OrgBouncycastleMathEcECCurve *) nil_chk(curve_)) getA], *B = [curve_ getB];
  OrgBouncycastleMathEcECFieldElement *lhs = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y)) square];
  switch ([self getCurveCoordinateSystem]) {
    case OrgBouncycastleMathEcECCurve_COORD_AFFINE:
    break;
    case OrgBouncycastleMathEcECCurve_COORD_HOMOGENEOUS:
    {
      OrgBouncycastleMathEcECFieldElement *Z = IOSObjectArray_Get(nil_chk(self->zs_), 0);
      if (![((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z)) isOne]) {
        OrgBouncycastleMathEcECFieldElement *Z2 = [Z square], *Z3 = [Z multiplyWithOrgBouncycastleMathEcECFieldElement:Z2];
        lhs = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(lhs)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z];
        A = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(A)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z2];
        B = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(B)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z3];
      }
      break;
    }
    case OrgBouncycastleMathEcECCurve_COORD_JACOBIAN:
    case OrgBouncycastleMathEcECCurve_COORD_JACOBIAN_CHUDNOVSKY:
    case OrgBouncycastleMathEcECCurve_COORD_JACOBIAN_MODIFIED:
    {
      OrgBouncycastleMathEcECFieldElement *Z = IOSObjectArray_Get(nil_chk(self->zs_), 0);
      if (![((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z)) isOne]) {
        OrgBouncycastleMathEcECFieldElement *Z2 = [Z square], *Z4 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z2)) square], *Z6 = [Z2 multiplyWithOrgBouncycastleMathEcECFieldElement:Z4];
        A = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(A)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z4];
        B = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(B)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z6];
      }
      break;
    }
    default:
    @throw new_JavaLangIllegalStateException_initWithNSString_(@"unsupported coordinate system");
  }
  OrgBouncycastleMathEcECFieldElement *rhs = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(X)) square])) addWithOrgBouncycastleMathEcECFieldElement:A])) multiplyWithOrgBouncycastleMathEcECFieldElement:X])) addWithOrgBouncycastleMathEcECFieldElement:B];
  return [((OrgBouncycastleMathEcECFieldElement *) nil_chk(lhs)) isEqual:rhs];
}

- (OrgBouncycastleMathEcECPoint *)subtractWithOrgBouncycastleMathEcECPoint:(OrgBouncycastleMathEcECPoint *)b {
  if ([((OrgBouncycastleMathEcECPoint *) nil_chk(b)) isInfinity]) {
    return self;
  }
  return [self addWithOrgBouncycastleMathEcECPoint:[b negate]];
}

@end

void OrgBouncycastleMathEcECPoint_AbstractFp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_(OrgBouncycastleMathEcECPoint_AbstractFp *self, OrgBouncycastleMathEcECCurve *curve, OrgBouncycastleMathEcECFieldElement *x, OrgBouncycastleMathEcECFieldElement *y) {
  (void) OrgBouncycastleMathEcECPoint_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_(self, curve, x, y);
}

void OrgBouncycastleMathEcECPoint_AbstractFp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_(OrgBouncycastleMathEcECPoint_AbstractFp *self, OrgBouncycastleMathEcECCurve *curve, OrgBouncycastleMathEcECFieldElement *x, OrgBouncycastleMathEcECFieldElement *y, IOSObjectArray *zs) {
  (void) OrgBouncycastleMathEcECPoint_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_(self, curve, x, y, zs);
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgBouncycastleMathEcECPoint_AbstractFp)

@implementation OrgBouncycastleMathEcECPoint_Fp

- (instancetype)initWithOrgBouncycastleMathEcECCurve:(OrgBouncycastleMathEcECCurve *)curve
             withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)x
             withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)y {
  OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_(self, curve, x, y);
  return self;
}

- (instancetype)initWithOrgBouncycastleMathEcECCurve:(OrgBouncycastleMathEcECCurve *)curve
             withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)x
             withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)y
                                         withBoolean:(jboolean)withCompression {
  OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(self, curve, x, y, withCompression);
  return self;
}

- (instancetype)initWithOrgBouncycastleMathEcECCurve:(OrgBouncycastleMathEcECCurve *)curve
             withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)x
             withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)y
        withOrgBouncycastleMathEcECFieldElementArray:(IOSObjectArray *)zs
                                         withBoolean:(jboolean)withCompression {
  OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_(self, curve, x, y, zs, withCompression);
  return self;
}

- (OrgBouncycastleMathEcECPoint *)detach {
  return new_OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_(nil, [self getAffineXCoord], [self getAffineYCoord]);
}

- (OrgBouncycastleMathEcECFieldElement *)getZCoordWithInt:(jint)index {
  if (index == 1 && OrgBouncycastleMathEcECCurve_COORD_JACOBIAN_MODIFIED == [self getCurveCoordinateSystem]) {
    return [self getJacobianModifiedW];
  }
  return [super getZCoordWithInt:index];
}

- (OrgBouncycastleMathEcECPoint *)addWithOrgBouncycastleMathEcECPoint:(OrgBouncycastleMathEcECPoint *)b {
  if ([self isInfinity]) {
    return b;
  }
  if ([((OrgBouncycastleMathEcECPoint *) nil_chk(b)) isInfinity]) {
    return self;
  }
  if (self == b) {
    return [self twice];
  }
  OrgBouncycastleMathEcECCurve *curve = [self getCurve];
  jint coord = [((OrgBouncycastleMathEcECCurve *) nil_chk(curve)) getCoordinateSystem];
  OrgBouncycastleMathEcECFieldElement *X1 = self->x_, *Y1 = self->y_;
  OrgBouncycastleMathEcECFieldElement *X2 = b->x_, *Y2 = b->y_;
  switch (coord) {
    case OrgBouncycastleMathEcECCurve_COORD_AFFINE:
    {
      OrgBouncycastleMathEcECFieldElement *dx = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(X2)) subtractWithOrgBouncycastleMathEcECFieldElement:X1], *dy = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y2)) subtractWithOrgBouncycastleMathEcECFieldElement:Y1];
      if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(dx)) isZero]) {
        if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(dy)) isZero]) {
          return [self twice];
        }
        return [curve getInfinity];
      }
      OrgBouncycastleMathEcECFieldElement *gamma = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(dy)) divideWithOrgBouncycastleMathEcECFieldElement:dx];
      OrgBouncycastleMathEcECFieldElement *X3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(gamma)) square])) subtractWithOrgBouncycastleMathEcECFieldElement:X1])) subtractWithOrgBouncycastleMathEcECFieldElement:X2];
      OrgBouncycastleMathEcECFieldElement *Y3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([gamma multiplyWithOrgBouncycastleMathEcECFieldElement:[((OrgBouncycastleMathEcECFieldElement *) nil_chk(X1)) subtractWithOrgBouncycastleMathEcECFieldElement:X3]])) subtractWithOrgBouncycastleMathEcECFieldElement:Y1];
      return new_OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(curve, X3, Y3, self->withCompression_);
    }
    case OrgBouncycastleMathEcECCurve_COORD_HOMOGENEOUS:
    {
      OrgBouncycastleMathEcECFieldElement *Z1 = IOSObjectArray_Get(nil_chk(self->zs_), 0);
      OrgBouncycastleMathEcECFieldElement *Z2 = IOSObjectArray_Get(b->zs_, 0);
      jboolean Z1IsOne = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z1)) isOne];
      jboolean Z2IsOne = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z2)) isOne];
      OrgBouncycastleMathEcECFieldElement *u1 = Z1IsOne ? Y2 : [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y2)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z1];
      OrgBouncycastleMathEcECFieldElement *u2 = Z2IsOne ? Y1 : [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y1)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z2];
      OrgBouncycastleMathEcECFieldElement *u = [u1 subtractWithOrgBouncycastleMathEcECFieldElement:u2];
      OrgBouncycastleMathEcECFieldElement *v1 = Z1IsOne ? X2 : [((OrgBouncycastleMathEcECFieldElement *) nil_chk(X2)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z1];
      OrgBouncycastleMathEcECFieldElement *v2 = Z2IsOne ? X1 : [((OrgBouncycastleMathEcECFieldElement *) nil_chk(X1)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z2];
      OrgBouncycastleMathEcECFieldElement *v = [v1 subtractWithOrgBouncycastleMathEcECFieldElement:v2];
      if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(v)) isZero]) {
        if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(u)) isZero]) {
          return [self twice];
        }
        return [curve getInfinity];
      }
      OrgBouncycastleMathEcECFieldElement *w = Z1IsOne ? Z2 : Z2IsOne ? Z1 : [Z1 multiplyWithOrgBouncycastleMathEcECFieldElement:Z2];
      OrgBouncycastleMathEcECFieldElement *vSquared = [v square];
      OrgBouncycastleMathEcECFieldElement *vCubed = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(vSquared)) multiplyWithOrgBouncycastleMathEcECFieldElement:v];
      OrgBouncycastleMathEcECFieldElement *vSquaredV2 = [vSquared multiplyWithOrgBouncycastleMathEcECFieldElement:v2];
      OrgBouncycastleMathEcECFieldElement *A = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(u)) square])) multiplyWithOrgBouncycastleMathEcECFieldElement:w])) subtractWithOrgBouncycastleMathEcECFieldElement:vCubed])) subtractWithOrgBouncycastleMathEcECFieldElement:[self twoWithOrgBouncycastleMathEcECFieldElement:vSquaredV2]];
      OrgBouncycastleMathEcECFieldElement *X3 = [v multiplyWithOrgBouncycastleMathEcECFieldElement:A];
      OrgBouncycastleMathEcECFieldElement *Y3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(vSquaredV2)) subtractWithOrgBouncycastleMathEcECFieldElement:A])) multiplyMinusProductWithOrgBouncycastleMathEcECFieldElement:u withOrgBouncycastleMathEcECFieldElement:u2 withOrgBouncycastleMathEcECFieldElement:vCubed];
      OrgBouncycastleMathEcECFieldElement *Z3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(vCubed)) multiplyWithOrgBouncycastleMathEcECFieldElement:w];
      return new_OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_(curve, X3, Y3, [IOSObjectArray newArrayWithObjects:(id[]){ Z3 } count:1 type:OrgBouncycastleMathEcECFieldElement_class_()], self->withCompression_);
    }
    case OrgBouncycastleMathEcECCurve_COORD_JACOBIAN:
    case OrgBouncycastleMathEcECCurve_COORD_JACOBIAN_MODIFIED:
    {
      OrgBouncycastleMathEcECFieldElement *Z1 = IOSObjectArray_Get(nil_chk(self->zs_), 0);
      OrgBouncycastleMathEcECFieldElement *Z2 = IOSObjectArray_Get(b->zs_, 0);
      jboolean Z1IsOne = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z1)) isOne];
      OrgBouncycastleMathEcECFieldElement *X3, *Y3, *Z3, *Z3Squared = nil;
      if (!Z1IsOne && [Z1 isEqual:Z2]) {
        OrgBouncycastleMathEcECFieldElement *dx = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(X1)) subtractWithOrgBouncycastleMathEcECFieldElement:X2], *dy = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y1)) subtractWithOrgBouncycastleMathEcECFieldElement:Y2];
        if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(dx)) isZero]) {
          if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(dy)) isZero]) {
            return [self twice];
          }
          return [curve getInfinity];
        }
        OrgBouncycastleMathEcECFieldElement *C = [dx square];
        OrgBouncycastleMathEcECFieldElement *W1 = [X1 multiplyWithOrgBouncycastleMathEcECFieldElement:C], *W2 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(X2)) multiplyWithOrgBouncycastleMathEcECFieldElement:C];
        OrgBouncycastleMathEcECFieldElement *A1 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(W1)) subtractWithOrgBouncycastleMathEcECFieldElement:W2])) multiplyWithOrgBouncycastleMathEcECFieldElement:Y1];
        X3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(dy)) square])) subtractWithOrgBouncycastleMathEcECFieldElement:W1])) subtractWithOrgBouncycastleMathEcECFieldElement:W2];
        Y3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([W1 subtractWithOrgBouncycastleMathEcECFieldElement:X3])) multiplyWithOrgBouncycastleMathEcECFieldElement:dy])) subtractWithOrgBouncycastleMathEcECFieldElement:A1];
        Z3 = dx;
        if (Z1IsOne) {
          Z3Squared = C;
        }
        else {
          Z3 = [Z3 multiplyWithOrgBouncycastleMathEcECFieldElement:Z1];
        }
      }
      else {
        OrgBouncycastleMathEcECFieldElement *Z1Squared, *U2, *S2;
        if (Z1IsOne) {
          Z1Squared = Z1;
          U2 = X2;
          S2 = Y2;
        }
        else {
          Z1Squared = [Z1 square];
          U2 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z1Squared)) multiplyWithOrgBouncycastleMathEcECFieldElement:X2];
          OrgBouncycastleMathEcECFieldElement *Z1Cubed = [Z1Squared multiplyWithOrgBouncycastleMathEcECFieldElement:Z1];
          S2 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z1Cubed)) multiplyWithOrgBouncycastleMathEcECFieldElement:Y2];
        }
        jboolean Z2IsOne = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z2)) isOne];
        OrgBouncycastleMathEcECFieldElement *Z2Squared, *U1, *S1;
        if (Z2IsOne) {
          Z2Squared = Z2;
          U1 = X1;
          S1 = Y1;
        }
        else {
          Z2Squared = [Z2 square];
          U1 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z2Squared)) multiplyWithOrgBouncycastleMathEcECFieldElement:X1];
          OrgBouncycastleMathEcECFieldElement *Z2Cubed = [Z2Squared multiplyWithOrgBouncycastleMathEcECFieldElement:Z2];
          S1 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z2Cubed)) multiplyWithOrgBouncycastleMathEcECFieldElement:Y1];
        }
        OrgBouncycastleMathEcECFieldElement *H = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(U1)) subtractWithOrgBouncycastleMathEcECFieldElement:U2];
        OrgBouncycastleMathEcECFieldElement *R = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(S1)) subtractWithOrgBouncycastleMathEcECFieldElement:S2];
        if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(H)) isZero]) {
          if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(R)) isZero]) {
            return [self twice];
          }
          return [curve getInfinity];
        }
        OrgBouncycastleMathEcECFieldElement *HSquared = [H square];
        OrgBouncycastleMathEcECFieldElement *G = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(HSquared)) multiplyWithOrgBouncycastleMathEcECFieldElement:H];
        OrgBouncycastleMathEcECFieldElement *V = [HSquared multiplyWithOrgBouncycastleMathEcECFieldElement:U1];
        X3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(R)) square])) addWithOrgBouncycastleMathEcECFieldElement:G])) subtractWithOrgBouncycastleMathEcECFieldElement:[self twoWithOrgBouncycastleMathEcECFieldElement:V]];
        Y3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(V)) subtractWithOrgBouncycastleMathEcECFieldElement:X3])) multiplyMinusProductWithOrgBouncycastleMathEcECFieldElement:R withOrgBouncycastleMathEcECFieldElement:G withOrgBouncycastleMathEcECFieldElement:S1];
        Z3 = H;
        if (!Z1IsOne) {
          Z3 = [Z3 multiplyWithOrgBouncycastleMathEcECFieldElement:Z1];
        }
        if (!Z2IsOne) {
          Z3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z3)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z2];
        }
        if (Z3 == H) {
          Z3Squared = HSquared;
        }
      }
      IOSObjectArray *zs;
      if (coord == OrgBouncycastleMathEcECCurve_COORD_JACOBIAN_MODIFIED) {
        OrgBouncycastleMathEcECFieldElement *W3 = [self calculateJacobianModifiedWWithOrgBouncycastleMathEcECFieldElement:Z3 withOrgBouncycastleMathEcECFieldElement:Z3Squared];
        zs = [IOSObjectArray newArrayWithObjects:(id[]){ Z3, W3 } count:2 type:OrgBouncycastleMathEcECFieldElement_class_()];
      }
      else {
        zs = [IOSObjectArray newArrayWithObjects:(id[]){ Z3 } count:1 type:OrgBouncycastleMathEcECFieldElement_class_()];
      }
      return new_OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_(curve, X3, Y3, zs, self->withCompression_);
    }
    default:
    {
      @throw new_JavaLangIllegalStateException_initWithNSString_(@"unsupported coordinate system");
    }
  }
}

- (OrgBouncycastleMathEcECPoint *)twice {
  if ([self isInfinity]) {
    return self;
  }
  OrgBouncycastleMathEcECCurve *curve = [self getCurve];
  OrgBouncycastleMathEcECFieldElement *Y1 = self->y_;
  if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y1)) isZero]) {
    return [((OrgBouncycastleMathEcECCurve *) nil_chk(curve)) getInfinity];
  }
  jint coord = [((OrgBouncycastleMathEcECCurve *) nil_chk(curve)) getCoordinateSystem];
  OrgBouncycastleMathEcECFieldElement *X1 = self->x_;
  switch (coord) {
    case OrgBouncycastleMathEcECCurve_COORD_AFFINE:
    {
      OrgBouncycastleMathEcECFieldElement *X1Squared = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(X1)) square];
      OrgBouncycastleMathEcECFieldElement *gamma = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([self threeWithOrgBouncycastleMathEcECFieldElement:X1Squared])) addWithOrgBouncycastleMathEcECFieldElement:[((OrgBouncycastleMathEcECCurve *) nil_chk([self getCurve])) getA]])) divideWithOrgBouncycastleMathEcECFieldElement:[self twoWithOrgBouncycastleMathEcECFieldElement:Y1]];
      OrgBouncycastleMathEcECFieldElement *X3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(gamma)) square])) subtractWithOrgBouncycastleMathEcECFieldElement:[self twoWithOrgBouncycastleMathEcECFieldElement:X1]];
      OrgBouncycastleMathEcECFieldElement *Y3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([gamma multiplyWithOrgBouncycastleMathEcECFieldElement:[X1 subtractWithOrgBouncycastleMathEcECFieldElement:X3]])) subtractWithOrgBouncycastleMathEcECFieldElement:Y1];
      return new_OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(curve, X3, Y3, self->withCompression_);
    }
    case OrgBouncycastleMathEcECCurve_COORD_HOMOGENEOUS:
    {
      OrgBouncycastleMathEcECFieldElement *Z1 = IOSObjectArray_Get(nil_chk(self->zs_), 0);
      jboolean Z1IsOne = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z1)) isOne];
      OrgBouncycastleMathEcECFieldElement *w = [curve getA];
      if (![((OrgBouncycastleMathEcECFieldElement *) nil_chk(w)) isZero] && !Z1IsOne) {
        w = [w multiplyWithOrgBouncycastleMathEcECFieldElement:[Z1 square]];
      }
      w = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(w)) addWithOrgBouncycastleMathEcECFieldElement:[self threeWithOrgBouncycastleMathEcECFieldElement:[((OrgBouncycastleMathEcECFieldElement *) nil_chk(X1)) square]]];
      OrgBouncycastleMathEcECFieldElement *s = Z1IsOne ? Y1 : [Y1 multiplyWithOrgBouncycastleMathEcECFieldElement:Z1];
      OrgBouncycastleMathEcECFieldElement *t = Z1IsOne ? [Y1 square] : [s multiplyWithOrgBouncycastleMathEcECFieldElement:Y1];
      OrgBouncycastleMathEcECFieldElement *B = [X1 multiplyWithOrgBouncycastleMathEcECFieldElement:t];
      OrgBouncycastleMathEcECFieldElement *_4B = [self fourWithOrgBouncycastleMathEcECFieldElement:B];
      OrgBouncycastleMathEcECFieldElement *h = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(w)) square])) subtractWithOrgBouncycastleMathEcECFieldElement:[self twoWithOrgBouncycastleMathEcECFieldElement:_4B]];
      OrgBouncycastleMathEcECFieldElement *_2s = [self twoWithOrgBouncycastleMathEcECFieldElement:s];
      OrgBouncycastleMathEcECFieldElement *X3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(h)) multiplyWithOrgBouncycastleMathEcECFieldElement:_2s];
      OrgBouncycastleMathEcECFieldElement *_2t = [self twoWithOrgBouncycastleMathEcECFieldElement:t];
      OrgBouncycastleMathEcECFieldElement *Y3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(_4B)) subtractWithOrgBouncycastleMathEcECFieldElement:h])) multiplyWithOrgBouncycastleMathEcECFieldElement:w])) subtractWithOrgBouncycastleMathEcECFieldElement:[self twoWithOrgBouncycastleMathEcECFieldElement:[((OrgBouncycastleMathEcECFieldElement *) nil_chk(_2t)) square]]];
      OrgBouncycastleMathEcECFieldElement *_4sSquared = Z1IsOne ? [self twoWithOrgBouncycastleMathEcECFieldElement:_2t] : [((OrgBouncycastleMathEcECFieldElement *) nil_chk(_2s)) square];
      OrgBouncycastleMathEcECFieldElement *Z3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([self twoWithOrgBouncycastleMathEcECFieldElement:_4sSquared])) multiplyWithOrgBouncycastleMathEcECFieldElement:s];
      return new_OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_(curve, X3, Y3, [IOSObjectArray newArrayWithObjects:(id[]){ Z3 } count:1 type:OrgBouncycastleMathEcECFieldElement_class_()], self->withCompression_);
    }
    case OrgBouncycastleMathEcECCurve_COORD_JACOBIAN:
    {
      OrgBouncycastleMathEcECFieldElement *Z1 = IOSObjectArray_Get(nil_chk(self->zs_), 0);
      jboolean Z1IsOne = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z1)) isOne];
      OrgBouncycastleMathEcECFieldElement *Y1Squared = [Y1 square];
      OrgBouncycastleMathEcECFieldElement *T = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y1Squared)) square];
      OrgBouncycastleMathEcECFieldElement *a4 = [curve getA];
      OrgBouncycastleMathEcECFieldElement *a4Neg = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(a4)) negate];
      OrgBouncycastleMathEcECFieldElement *M, *S;
      if ([((JavaMathBigInteger *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(a4Neg)) toBigInteger])) isEqual:JavaMathBigInteger_valueOfWithLong_(3)]) {
        OrgBouncycastleMathEcECFieldElement *Z1Squared = Z1IsOne ? Z1 : [Z1 square];
        M = [self threeWithOrgBouncycastleMathEcECFieldElement:[((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(X1)) addWithOrgBouncycastleMathEcECFieldElement:Z1Squared])) multiplyWithOrgBouncycastleMathEcECFieldElement:[X1 subtractWithOrgBouncycastleMathEcECFieldElement:Z1Squared]]];
        S = [self fourWithOrgBouncycastleMathEcECFieldElement:[Y1Squared multiplyWithOrgBouncycastleMathEcECFieldElement:X1]];
      }
      else {
        OrgBouncycastleMathEcECFieldElement *X1Squared = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(X1)) square];
        M = [self threeWithOrgBouncycastleMathEcECFieldElement:X1Squared];
        if (Z1IsOne) {
          M = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(M)) addWithOrgBouncycastleMathEcECFieldElement:a4];
        }
        else if (![a4 isZero]) {
          OrgBouncycastleMathEcECFieldElement *Z1Squared = Z1IsOne ? Z1 : [Z1 square];
          OrgBouncycastleMathEcECFieldElement *Z1Pow4 = [Z1Squared square];
          if ([a4Neg bitLength] < [a4 bitLength]) {
            M = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(M)) subtractWithOrgBouncycastleMathEcECFieldElement:[((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z1Pow4)) multiplyWithOrgBouncycastleMathEcECFieldElement:a4Neg]];
          }
          else {
            M = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(M)) addWithOrgBouncycastleMathEcECFieldElement:[((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z1Pow4)) multiplyWithOrgBouncycastleMathEcECFieldElement:a4]];
          }
        }
        S = [self fourWithOrgBouncycastleMathEcECFieldElement:[X1 multiplyWithOrgBouncycastleMathEcECFieldElement:Y1Squared]];
      }
      OrgBouncycastleMathEcECFieldElement *X3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(M)) square])) subtractWithOrgBouncycastleMathEcECFieldElement:[self twoWithOrgBouncycastleMathEcECFieldElement:S]];
      OrgBouncycastleMathEcECFieldElement *Y3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(S)) subtractWithOrgBouncycastleMathEcECFieldElement:X3])) multiplyWithOrgBouncycastleMathEcECFieldElement:M])) subtractWithOrgBouncycastleMathEcECFieldElement:[self eightWithOrgBouncycastleMathEcECFieldElement:T]];
      OrgBouncycastleMathEcECFieldElement *Z3 = [self twoWithOrgBouncycastleMathEcECFieldElement:Y1];
      if (!Z1IsOne) {
        Z3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z3)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z1];
      }
      return new_OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_(curve, X3, Y3, [IOSObjectArray newArrayWithObjects:(id[]){ Z3 } count:1 type:OrgBouncycastleMathEcECFieldElement_class_()], self->withCompression_);
    }
    case OrgBouncycastleMathEcECCurve_COORD_JACOBIAN_MODIFIED:
    {
      return [self twiceJacobianModifiedWithBoolean:YES];
    }
    default:
    {
      @throw new_JavaLangIllegalStateException_initWithNSString_(@"unsupported coordinate system");
    }
  }
}

- (OrgBouncycastleMathEcECPoint *)twicePlusWithOrgBouncycastleMathEcECPoint:(OrgBouncycastleMathEcECPoint *)b {
  if (self == b) {
    return [self threeTimes];
  }
  if ([self isInfinity]) {
    return b;
  }
  if ([((OrgBouncycastleMathEcECPoint *) nil_chk(b)) isInfinity]) {
    return [self twice];
  }
  OrgBouncycastleMathEcECFieldElement *Y1 = self->y_;
  if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y1)) isZero]) {
    return b;
  }
  OrgBouncycastleMathEcECCurve *curve = [self getCurve];
  jint coord = [((OrgBouncycastleMathEcECCurve *) nil_chk(curve)) getCoordinateSystem];
  switch (coord) {
    case OrgBouncycastleMathEcECCurve_COORD_AFFINE:
    {
      OrgBouncycastleMathEcECFieldElement *X1 = self->x_;
      OrgBouncycastleMathEcECFieldElement *X2 = b->x_, *Y2 = b->y_;
      OrgBouncycastleMathEcECFieldElement *dx = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(X2)) subtractWithOrgBouncycastleMathEcECFieldElement:X1], *dy = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y2)) subtractWithOrgBouncycastleMathEcECFieldElement:Y1];
      if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(dx)) isZero]) {
        if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(dy)) isZero]) {
          return [self threeTimes];
        }
        return self;
      }
      OrgBouncycastleMathEcECFieldElement *X = [dx square], *Y = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(dy)) square];
      OrgBouncycastleMathEcECFieldElement *d = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(X)) multiplyWithOrgBouncycastleMathEcECFieldElement:[((OrgBouncycastleMathEcECFieldElement *) nil_chk([self twoWithOrgBouncycastleMathEcECFieldElement:X1])) addWithOrgBouncycastleMathEcECFieldElement:X2]])) subtractWithOrgBouncycastleMathEcECFieldElement:Y];
      if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(d)) isZero]) {
        return [curve getInfinity];
      }
      OrgBouncycastleMathEcECFieldElement *D = [d multiplyWithOrgBouncycastleMathEcECFieldElement:dx];
      OrgBouncycastleMathEcECFieldElement *I = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(D)) invert];
      OrgBouncycastleMathEcECFieldElement *L1 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([d multiplyWithOrgBouncycastleMathEcECFieldElement:I])) multiplyWithOrgBouncycastleMathEcECFieldElement:dy];
      OrgBouncycastleMathEcECFieldElement *L2 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([self twoWithOrgBouncycastleMathEcECFieldElement:Y1])) multiplyWithOrgBouncycastleMathEcECFieldElement:X])) multiplyWithOrgBouncycastleMathEcECFieldElement:dx])) multiplyWithOrgBouncycastleMathEcECFieldElement:I])) subtractWithOrgBouncycastleMathEcECFieldElement:L1];
      OrgBouncycastleMathEcECFieldElement *X4 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(([((OrgBouncycastleMathEcECFieldElement *) nil_chk(L2)) subtractWithOrgBouncycastleMathEcECFieldElement:L1]))) multiplyWithOrgBouncycastleMathEcECFieldElement:[((OrgBouncycastleMathEcECFieldElement *) nil_chk(L1)) addWithOrgBouncycastleMathEcECFieldElement:L2]])) addWithOrgBouncycastleMathEcECFieldElement:X2];
      OrgBouncycastleMathEcECFieldElement *Y4 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(([((OrgBouncycastleMathEcECFieldElement *) nil_chk(X1)) subtractWithOrgBouncycastleMathEcECFieldElement:X4]))) multiplyWithOrgBouncycastleMathEcECFieldElement:L2])) subtractWithOrgBouncycastleMathEcECFieldElement:Y1];
      return new_OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(curve, X4, Y4, self->withCompression_);
    }
    case OrgBouncycastleMathEcECCurve_COORD_JACOBIAN_MODIFIED:
    {
      return [((OrgBouncycastleMathEcECPoint_Fp *) nil_chk([self twiceJacobianModifiedWithBoolean:NO])) addWithOrgBouncycastleMathEcECPoint:b];
    }
    default:
    {
      return [((OrgBouncycastleMathEcECPoint *) nil_chk([self twice])) addWithOrgBouncycastleMathEcECPoint:b];
    }
  }
}

- (OrgBouncycastleMathEcECPoint *)threeTimes {
  if ([self isInfinity]) {
    return self;
  }
  OrgBouncycastleMathEcECFieldElement *Y1 = self->y_;
  if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y1)) isZero]) {
    return self;
  }
  OrgBouncycastleMathEcECCurve *curve = [self getCurve];
  jint coord = [((OrgBouncycastleMathEcECCurve *) nil_chk(curve)) getCoordinateSystem];
  switch (coord) {
    case OrgBouncycastleMathEcECCurve_COORD_AFFINE:
    {
      OrgBouncycastleMathEcECFieldElement *X1 = self->x_;
      OrgBouncycastleMathEcECFieldElement *_2Y1 = [self twoWithOrgBouncycastleMathEcECFieldElement:Y1];
      OrgBouncycastleMathEcECFieldElement *X = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(_2Y1)) square];
      OrgBouncycastleMathEcECFieldElement *Z = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([self threeWithOrgBouncycastleMathEcECFieldElement:[((OrgBouncycastleMathEcECFieldElement *) nil_chk(X1)) square]])) addWithOrgBouncycastleMathEcECFieldElement:[((OrgBouncycastleMathEcECCurve *) nil_chk([self getCurve])) getA]];
      OrgBouncycastleMathEcECFieldElement *Y = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z)) square];
      OrgBouncycastleMathEcECFieldElement *d = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([self threeWithOrgBouncycastleMathEcECFieldElement:X1])) multiplyWithOrgBouncycastleMathEcECFieldElement:X])) subtractWithOrgBouncycastleMathEcECFieldElement:Y];
      if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(d)) isZero]) {
        return [((OrgBouncycastleMathEcECCurve *) nil_chk([self getCurve])) getInfinity];
      }
      OrgBouncycastleMathEcECFieldElement *D = [d multiplyWithOrgBouncycastleMathEcECFieldElement:_2Y1];
      OrgBouncycastleMathEcECFieldElement *I = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(D)) invert];
      OrgBouncycastleMathEcECFieldElement *L1 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([d multiplyWithOrgBouncycastleMathEcECFieldElement:I])) multiplyWithOrgBouncycastleMathEcECFieldElement:Z];
      OrgBouncycastleMathEcECFieldElement *L2 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(X)) square])) multiplyWithOrgBouncycastleMathEcECFieldElement:I])) subtractWithOrgBouncycastleMathEcECFieldElement:L1];
      OrgBouncycastleMathEcECFieldElement *X4 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(([((OrgBouncycastleMathEcECFieldElement *) nil_chk(L2)) subtractWithOrgBouncycastleMathEcECFieldElement:L1]))) multiplyWithOrgBouncycastleMathEcECFieldElement:[((OrgBouncycastleMathEcECFieldElement *) nil_chk(L1)) addWithOrgBouncycastleMathEcECFieldElement:L2]])) addWithOrgBouncycastleMathEcECFieldElement:X1];
      OrgBouncycastleMathEcECFieldElement *Y4 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(([X1 subtractWithOrgBouncycastleMathEcECFieldElement:X4]))) multiplyWithOrgBouncycastleMathEcECFieldElement:L2])) subtractWithOrgBouncycastleMathEcECFieldElement:Y1];
      return new_OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(curve, X4, Y4, self->withCompression_);
    }
    case OrgBouncycastleMathEcECCurve_COORD_JACOBIAN_MODIFIED:
    {
      return [((OrgBouncycastleMathEcECPoint_Fp *) nil_chk([self twiceJacobianModifiedWithBoolean:NO])) addWithOrgBouncycastleMathEcECPoint:self];
    }
    default:
    {
      return [((OrgBouncycastleMathEcECPoint *) nil_chk([self twice])) addWithOrgBouncycastleMathEcECPoint:self];
    }
  }
}

- (OrgBouncycastleMathEcECPoint *)timesPow2WithInt:(jint)e {
  if (e < 0) {
    @throw new_JavaLangIllegalArgumentException_initWithNSString_(@"'e' cannot be negative");
  }
  if (e == 0 || [self isInfinity]) {
    return self;
  }
  if (e == 1) {
    return [self twice];
  }
  OrgBouncycastleMathEcECCurve *curve = [self getCurve];
  OrgBouncycastleMathEcECFieldElement *Y1 = self->y_;
  if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y1)) isZero]) {
    return [((OrgBouncycastleMathEcECCurve *) nil_chk(curve)) getInfinity];
  }
  jint coord = [((OrgBouncycastleMathEcECCurve *) nil_chk(curve)) getCoordinateSystem];
  OrgBouncycastleMathEcECFieldElement *W1 = [curve getA];
  OrgBouncycastleMathEcECFieldElement *X1 = self->x_;
  OrgBouncycastleMathEcECFieldElement *Z1 = ((IOSObjectArray *) nil_chk(self->zs_))->size_ < 1 ? [curve fromBigIntegerWithJavaMathBigInteger:OrgBouncycastleMathEcECConstants_get_ONE_()] : IOSObjectArray_Get(self->zs_, 0);
  if (![Z1 isOne]) {
    {
      OrgBouncycastleMathEcECFieldElement *Z1Sq;
      switch (coord) {
        case OrgBouncycastleMathEcECCurve_COORD_HOMOGENEOUS:
        Z1Sq = [Z1 square];
        X1 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(X1)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z1];
        Y1 = [Y1 multiplyWithOrgBouncycastleMathEcECFieldElement:Z1Sq];
        W1 = [self calculateJacobianModifiedWWithOrgBouncycastleMathEcECFieldElement:Z1 withOrgBouncycastleMathEcECFieldElement:Z1Sq];
        break;
        case OrgBouncycastleMathEcECCurve_COORD_JACOBIAN:
        W1 = [self calculateJacobianModifiedWWithOrgBouncycastleMathEcECFieldElement:Z1 withOrgBouncycastleMathEcECFieldElement:nil];
        break;
        case OrgBouncycastleMathEcECCurve_COORD_JACOBIAN_MODIFIED:
        W1 = [self getJacobianModifiedW];
        break;
      }
    }
  }
  for (jint i = 0; i < e; ++i) {
    if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y1)) isZero]) {
      return [curve getInfinity];
    }
    OrgBouncycastleMathEcECFieldElement *X1Squared = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(X1)) square];
    OrgBouncycastleMathEcECFieldElement *M = [self threeWithOrgBouncycastleMathEcECFieldElement:X1Squared];
    OrgBouncycastleMathEcECFieldElement *_2Y1 = [self twoWithOrgBouncycastleMathEcECFieldElement:Y1];
    OrgBouncycastleMathEcECFieldElement *_2Y1Squared = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(_2Y1)) multiplyWithOrgBouncycastleMathEcECFieldElement:Y1];
    OrgBouncycastleMathEcECFieldElement *S = [self twoWithOrgBouncycastleMathEcECFieldElement:[X1 multiplyWithOrgBouncycastleMathEcECFieldElement:_2Y1Squared]];
    OrgBouncycastleMathEcECFieldElement *_4T = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(_2Y1Squared)) square];
    OrgBouncycastleMathEcECFieldElement *_8T = [self twoWithOrgBouncycastleMathEcECFieldElement:_4T];
    if (![((OrgBouncycastleMathEcECFieldElement *) nil_chk(W1)) isZero]) {
      M = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(M)) addWithOrgBouncycastleMathEcECFieldElement:W1];
      W1 = [self twoWithOrgBouncycastleMathEcECFieldElement:[((OrgBouncycastleMathEcECFieldElement *) nil_chk(_8T)) multiplyWithOrgBouncycastleMathEcECFieldElement:W1]];
    }
    X1 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(M)) square])) subtractWithOrgBouncycastleMathEcECFieldElement:[self twoWithOrgBouncycastleMathEcECFieldElement:S]];
    Y1 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([M multiplyWithOrgBouncycastleMathEcECFieldElement:[((OrgBouncycastleMathEcECFieldElement *) nil_chk(S)) subtractWithOrgBouncycastleMathEcECFieldElement:X1]])) subtractWithOrgBouncycastleMathEcECFieldElement:_8T];
    Z1 = [Z1 isOne] ? _2Y1 : [_2Y1 multiplyWithOrgBouncycastleMathEcECFieldElement:Z1];
  }
  {
    OrgBouncycastleMathEcECFieldElement *zInv, *zInv2, *zInv3;
    switch (coord) {
      case OrgBouncycastleMathEcECCurve_COORD_AFFINE:
      zInv = [Z1 invert];
      zInv2 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(zInv)) square];
      zInv3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(zInv2)) multiplyWithOrgBouncycastleMathEcECFieldElement:zInv];
      return new_OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(curve, [((OrgBouncycastleMathEcECFieldElement *) nil_chk(X1)) multiplyWithOrgBouncycastleMathEcECFieldElement:zInv2], [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y1)) multiplyWithOrgBouncycastleMathEcECFieldElement:zInv3], self->withCompression_);
      case OrgBouncycastleMathEcECCurve_COORD_HOMOGENEOUS:
      X1 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(X1)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z1];
      Z1 = [Z1 multiplyWithOrgBouncycastleMathEcECFieldElement:[Z1 square]];
      return new_OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_(curve, X1, Y1, [IOSObjectArray newArrayWithObjects:(id[]){ Z1 } count:1 type:OrgBouncycastleMathEcECFieldElement_class_()], self->withCompression_);
      case OrgBouncycastleMathEcECCurve_COORD_JACOBIAN:
      return new_OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_(curve, X1, Y1, [IOSObjectArray newArrayWithObjects:(id[]){ Z1 } count:1 type:OrgBouncycastleMathEcECFieldElement_class_()], self->withCompression_);
      case OrgBouncycastleMathEcECCurve_COORD_JACOBIAN_MODIFIED:
      return new_OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_(curve, X1, Y1, [IOSObjectArray newArrayWithObjects:(id[]){ Z1, W1 } count:2 type:OrgBouncycastleMathEcECFieldElement_class_()], self->withCompression_);
      default:
      @throw new_JavaLangIllegalStateException_initWithNSString_(@"unsupported coordinate system");
    }
  }
}

- (OrgBouncycastleMathEcECFieldElement *)twoWithOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)x {
  return [((OrgBouncycastleMathEcECFieldElement *) nil_chk(x)) addWithOrgBouncycastleMathEcECFieldElement:x];
}

- (OrgBouncycastleMathEcECFieldElement *)threeWithOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)x {
  return [((OrgBouncycastleMathEcECFieldElement *) nil_chk([self twoWithOrgBouncycastleMathEcECFieldElement:x])) addWithOrgBouncycastleMathEcECFieldElement:x];
}

- (OrgBouncycastleMathEcECFieldElement *)fourWithOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)x {
  return [self twoWithOrgBouncycastleMathEcECFieldElement:[self twoWithOrgBouncycastleMathEcECFieldElement:x]];
}

- (OrgBouncycastleMathEcECFieldElement *)eightWithOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)x {
  return [self fourWithOrgBouncycastleMathEcECFieldElement:[self twoWithOrgBouncycastleMathEcECFieldElement:x]];
}

- (OrgBouncycastleMathEcECFieldElement *)doubleProductFromSquaresWithOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)a
                                                                 withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)b
                                                                 withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)aSquared
                                                                 withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)bSquared {
  return [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(a)) addWithOrgBouncycastleMathEcECFieldElement:b])) square])) subtractWithOrgBouncycastleMathEcECFieldElement:aSquared])) subtractWithOrgBouncycastleMathEcECFieldElement:bSquared];
}

- (OrgBouncycastleMathEcECPoint *)negate {
  if ([self isInfinity]) {
    return self;
  }
  OrgBouncycastleMathEcECCurve *curve = [self getCurve];
  jint coord = [((OrgBouncycastleMathEcECCurve *) nil_chk(curve)) getCoordinateSystem];
  if (OrgBouncycastleMathEcECCurve_COORD_AFFINE != coord) {
    return new_OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_(curve, self->x_, [((OrgBouncycastleMathEcECFieldElement *) nil_chk(self->y_)) negate], self->zs_, self->withCompression_);
  }
  return new_OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(curve, self->x_, [((OrgBouncycastleMathEcECFieldElement *) nil_chk(self->y_)) negate], self->withCompression_);
}

- (OrgBouncycastleMathEcECFieldElement *)calculateJacobianModifiedWWithOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)Z
                                                                   withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)ZSquared {
  OrgBouncycastleMathEcECFieldElement *a4 = [((OrgBouncycastleMathEcECCurve *) nil_chk([self getCurve])) getA];
  if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(a4)) isZero] || [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z)) isOne]) {
    return a4;
  }
  if (ZSquared == nil) {
    ZSquared = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z)) square];
  }
  OrgBouncycastleMathEcECFieldElement *W = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(ZSquared)) square];
  OrgBouncycastleMathEcECFieldElement *a4Neg = [a4 negate];
  if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(a4Neg)) bitLength] < [a4 bitLength]) {
    W = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(W)) multiplyWithOrgBouncycastleMathEcECFieldElement:a4Neg])) negate];
  }
  else {
    W = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(W)) multiplyWithOrgBouncycastleMathEcECFieldElement:a4];
  }
  return W;
}

- (OrgBouncycastleMathEcECFieldElement *)getJacobianModifiedW {
  OrgBouncycastleMathEcECFieldElement *W = IOSObjectArray_Get(nil_chk(self->zs_), 1);
  if (W == nil) {
    (void) IOSObjectArray_Set(self->zs_, 1, W = [self calculateJacobianModifiedWWithOrgBouncycastleMathEcECFieldElement:IOSObjectArray_Get(self->zs_, 0) withOrgBouncycastleMathEcECFieldElement:nil]);
  }
  return W;
}

- (OrgBouncycastleMathEcECPoint_Fp *)twiceJacobianModifiedWithBoolean:(jboolean)calculateW {
  OrgBouncycastleMathEcECFieldElement *X1 = self->x_, *Y1 = self->y_, *Z1 = IOSObjectArray_Get(nil_chk(self->zs_), 0), *W1 = [self getJacobianModifiedW];
  OrgBouncycastleMathEcECFieldElement *X1Squared = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(X1)) square];
  OrgBouncycastleMathEcECFieldElement *M = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([self threeWithOrgBouncycastleMathEcECFieldElement:X1Squared])) addWithOrgBouncycastleMathEcECFieldElement:W1];
  OrgBouncycastleMathEcECFieldElement *_2Y1 = [self twoWithOrgBouncycastleMathEcECFieldElement:Y1];
  OrgBouncycastleMathEcECFieldElement *_2Y1Squared = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(_2Y1)) multiplyWithOrgBouncycastleMathEcECFieldElement:Y1];
  OrgBouncycastleMathEcECFieldElement *S = [self twoWithOrgBouncycastleMathEcECFieldElement:[X1 multiplyWithOrgBouncycastleMathEcECFieldElement:_2Y1Squared]];
  OrgBouncycastleMathEcECFieldElement *X3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(M)) square])) subtractWithOrgBouncycastleMathEcECFieldElement:[self twoWithOrgBouncycastleMathEcECFieldElement:S]];
  OrgBouncycastleMathEcECFieldElement *_4T = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(_2Y1Squared)) square];
  OrgBouncycastleMathEcECFieldElement *_8T = [self twoWithOrgBouncycastleMathEcECFieldElement:_4T];
  OrgBouncycastleMathEcECFieldElement *Y3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([M multiplyWithOrgBouncycastleMathEcECFieldElement:[((OrgBouncycastleMathEcECFieldElement *) nil_chk(S)) subtractWithOrgBouncycastleMathEcECFieldElement:X3]])) subtractWithOrgBouncycastleMathEcECFieldElement:_8T];
  OrgBouncycastleMathEcECFieldElement *W3 = calculateW ? [self twoWithOrgBouncycastleMathEcECFieldElement:[((OrgBouncycastleMathEcECFieldElement *) nil_chk(_8T)) multiplyWithOrgBouncycastleMathEcECFieldElement:W1]] : nil;
  OrgBouncycastleMathEcECFieldElement *Z3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z1)) isOne] ? _2Y1 : [_2Y1 multiplyWithOrgBouncycastleMathEcECFieldElement:Z1];
  return new_OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_([self getCurve], X3, Y3, [IOSObjectArray newArrayWithObjects:(id[]){ Z3, W3 } count:2 type:OrgBouncycastleMathEcECFieldElement_class_()], self->withCompression_);
}

@end

void OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_(OrgBouncycastleMathEcECPoint_Fp *self, OrgBouncycastleMathEcECCurve *curve, OrgBouncycastleMathEcECFieldElement *x, OrgBouncycastleMathEcECFieldElement *y) {
  (void) OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(self, curve, x, y, NO);
}

OrgBouncycastleMathEcECPoint_Fp *new_OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_(OrgBouncycastleMathEcECCurve *curve, OrgBouncycastleMathEcECFieldElement *x, OrgBouncycastleMathEcECFieldElement *y) {
  OrgBouncycastleMathEcECPoint_Fp *self = [OrgBouncycastleMathEcECPoint_Fp alloc];
  OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_(self, curve, x, y);
  return self;
}

void OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(OrgBouncycastleMathEcECPoint_Fp *self, OrgBouncycastleMathEcECCurve *curve, OrgBouncycastleMathEcECFieldElement *x, OrgBouncycastleMathEcECFieldElement *y, jboolean withCompression) {
  (void) OrgBouncycastleMathEcECPoint_AbstractFp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_(self, curve, x, y);
  if ((x == nil) != (y == nil)) {
    @throw new_JavaLangIllegalArgumentException_initWithNSString_(@"Exactly one of the field elements is null");
  }
  self->withCompression_ = withCompression;
}

OrgBouncycastleMathEcECPoint_Fp *new_OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(OrgBouncycastleMathEcECCurve *curve, OrgBouncycastleMathEcECFieldElement *x, OrgBouncycastleMathEcECFieldElement *y, jboolean withCompression) {
  OrgBouncycastleMathEcECPoint_Fp *self = [OrgBouncycastleMathEcECPoint_Fp alloc];
  OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(self, curve, x, y, withCompression);
  return self;
}

void OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_(OrgBouncycastleMathEcECPoint_Fp *self, OrgBouncycastleMathEcECCurve *curve, OrgBouncycastleMathEcECFieldElement *x, OrgBouncycastleMathEcECFieldElement *y, IOSObjectArray *zs, jboolean withCompression) {
  (void) OrgBouncycastleMathEcECPoint_AbstractFp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_(self, curve, x, y, zs);
  self->withCompression_ = withCompression;
}

OrgBouncycastleMathEcECPoint_Fp *new_OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_(OrgBouncycastleMathEcECCurve *curve, OrgBouncycastleMathEcECFieldElement *x, OrgBouncycastleMathEcECFieldElement *y, IOSObjectArray *zs, jboolean withCompression) {
  OrgBouncycastleMathEcECPoint_Fp *self = [OrgBouncycastleMathEcECPoint_Fp alloc];
  OrgBouncycastleMathEcECPoint_Fp_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_(self, curve, x, y, zs, withCompression);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgBouncycastleMathEcECPoint_Fp)

@implementation OrgBouncycastleMathEcECPoint_AbstractF2m

- (instancetype)initWithOrgBouncycastleMathEcECCurve:(OrgBouncycastleMathEcECCurve *)curve
             withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)x
             withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)y {
  OrgBouncycastleMathEcECPoint_AbstractF2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_(self, curve, x, y);
  return self;
}

- (instancetype)initWithOrgBouncycastleMathEcECCurve:(OrgBouncycastleMathEcECCurve *)curve
             withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)x
             withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)y
        withOrgBouncycastleMathEcECFieldElementArray:(IOSObjectArray *)zs {
  OrgBouncycastleMathEcECPoint_AbstractF2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_(self, curve, x, y, zs);
  return self;
}

- (jboolean)satisfiesCurveEquation {
  OrgBouncycastleMathEcECCurve *curve = [self getCurve];
  OrgBouncycastleMathEcECFieldElement *X = self->x_, *A = [((OrgBouncycastleMathEcECCurve *) nil_chk(curve)) getA], *B = [curve getB];
  jint coord = [curve getCoordinateSystem];
  if (coord == OrgBouncycastleMathEcECCurve_COORD_LAMBDA_PROJECTIVE) {
    OrgBouncycastleMathEcECFieldElement *Z = IOSObjectArray_Get(nil_chk(self->zs_), 0);
    jboolean ZIsOne = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z)) isOne];
    if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(X)) isZero]) {
      OrgBouncycastleMathEcECFieldElement *Y = self->y_;
      OrgBouncycastleMathEcECFieldElement *lhs = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y)) square], *rhs = B;
      if (!ZIsOne) {
        rhs = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(rhs)) multiplyWithOrgBouncycastleMathEcECFieldElement:[Z square]];
      }
      return [((OrgBouncycastleMathEcECFieldElement *) nil_chk(lhs)) isEqual:rhs];
    }
    OrgBouncycastleMathEcECFieldElement *L = self->y_, *X2 = [X square];
    OrgBouncycastleMathEcECFieldElement *lhs, *rhs;
    if (ZIsOne) {
      lhs = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(L)) square])) addWithOrgBouncycastleMathEcECFieldElement:L])) addWithOrgBouncycastleMathEcECFieldElement:A];
      rhs = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(X2)) square])) addWithOrgBouncycastleMathEcECFieldElement:B];
    }
    else {
      OrgBouncycastleMathEcECFieldElement *Z2 = [Z square], *Z4 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z2)) square];
      lhs = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(L)) addWithOrgBouncycastleMathEcECFieldElement:Z])) multiplyPlusProductWithOrgBouncycastleMathEcECFieldElement:L withOrgBouncycastleMathEcECFieldElement:A withOrgBouncycastleMathEcECFieldElement:Z2];
      rhs = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(X2)) squarePlusProductWithOrgBouncycastleMathEcECFieldElement:B withOrgBouncycastleMathEcECFieldElement:Z4];
    }
    lhs = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(lhs)) multiplyWithOrgBouncycastleMathEcECFieldElement:X2];
    return [((OrgBouncycastleMathEcECFieldElement *) nil_chk(lhs)) isEqual:rhs];
  }
  OrgBouncycastleMathEcECFieldElement *Y = self->y_;
  OrgBouncycastleMathEcECFieldElement *lhs = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y)) addWithOrgBouncycastleMathEcECFieldElement:X])) multiplyWithOrgBouncycastleMathEcECFieldElement:Y];
  switch (coord) {
    case OrgBouncycastleMathEcECCurve_COORD_AFFINE:
    break;
    case OrgBouncycastleMathEcECCurve_COORD_HOMOGENEOUS:
    {
      OrgBouncycastleMathEcECFieldElement *Z = IOSObjectArray_Get(nil_chk(self->zs_), 0);
      if (![((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z)) isOne]) {
        OrgBouncycastleMathEcECFieldElement *Z2 = [Z square], *Z3 = [Z multiplyWithOrgBouncycastleMathEcECFieldElement:Z2];
        lhs = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(lhs)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z];
        A = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(A)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z];
        B = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(B)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z3];
      }
      break;
    }
    default:
    @throw new_JavaLangIllegalStateException_initWithNSString_(@"unsupported coordinate system");
  }
  OrgBouncycastleMathEcECFieldElement *rhs = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(X)) addWithOrgBouncycastleMathEcECFieldElement:A])) multiplyWithOrgBouncycastleMathEcECFieldElement:[X square]])) addWithOrgBouncycastleMathEcECFieldElement:B];
  return [((OrgBouncycastleMathEcECFieldElement *) nil_chk(lhs)) isEqual:rhs];
}

@end

void OrgBouncycastleMathEcECPoint_AbstractF2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_(OrgBouncycastleMathEcECPoint_AbstractF2m *self, OrgBouncycastleMathEcECCurve *curve, OrgBouncycastleMathEcECFieldElement *x, OrgBouncycastleMathEcECFieldElement *y) {
  (void) OrgBouncycastleMathEcECPoint_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_(self, curve, x, y);
}

void OrgBouncycastleMathEcECPoint_AbstractF2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_(OrgBouncycastleMathEcECPoint_AbstractF2m *self, OrgBouncycastleMathEcECCurve *curve, OrgBouncycastleMathEcECFieldElement *x, OrgBouncycastleMathEcECFieldElement *y, IOSObjectArray *zs) {
  (void) OrgBouncycastleMathEcECPoint_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_(self, curve, x, y, zs);
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgBouncycastleMathEcECPoint_AbstractF2m)

@implementation OrgBouncycastleMathEcECPoint_F2m

- (instancetype)initWithOrgBouncycastleMathEcECCurve:(OrgBouncycastleMathEcECCurve *)curve
             withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)x
             withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)y {
  OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_(self, curve, x, y);
  return self;
}

- (instancetype)initWithOrgBouncycastleMathEcECCurve:(OrgBouncycastleMathEcECCurve *)curve
             withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)x
             withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)y
                                         withBoolean:(jboolean)withCompression {
  OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(self, curve, x, y, withCompression);
  return self;
}

- (instancetype)initWithOrgBouncycastleMathEcECCurve:(OrgBouncycastleMathEcECCurve *)curve
             withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)x
             withOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)y
        withOrgBouncycastleMathEcECFieldElementArray:(IOSObjectArray *)zs
                                         withBoolean:(jboolean)withCompression {
  OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_(self, curve, x, y, zs, withCompression);
  return self;
}

- (OrgBouncycastleMathEcECPoint *)detach {
  return new_OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_(nil, [self getAffineXCoord], [self getAffineYCoord]);
}

- (OrgBouncycastleMathEcECFieldElement *)getYCoord {
  jint coord = [self getCurveCoordinateSystem];
  switch (coord) {
    case OrgBouncycastleMathEcECCurve_COORD_LAMBDA_AFFINE:
    case OrgBouncycastleMathEcECCurve_COORD_LAMBDA_PROJECTIVE:
    {
      OrgBouncycastleMathEcECFieldElement *X = x_, *L = y_;
      if ([self isInfinity] || [((OrgBouncycastleMathEcECFieldElement *) nil_chk(X)) isZero]) {
        return L;
      }
      OrgBouncycastleMathEcECFieldElement *Y = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(L)) addWithOrgBouncycastleMathEcECFieldElement:X])) multiplyWithOrgBouncycastleMathEcECFieldElement:X];
      if (OrgBouncycastleMathEcECCurve_COORD_LAMBDA_PROJECTIVE == coord) {
        OrgBouncycastleMathEcECFieldElement *Z = IOSObjectArray_Get(nil_chk(zs_), 0);
        if (![((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z)) isOne]) {
          Y = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y)) divideWithOrgBouncycastleMathEcECFieldElement:Z];
        }
      }
      return Y;
    }
    default:
    {
      return y_;
    }
  }
}

- (OrgBouncycastleMathEcECPoint *)scaleXWithOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)scale_ {
  if ([self isInfinity]) {
    return self;
  }
  jint coord = [self getCurveCoordinateSystem];
  switch (coord) {
    case OrgBouncycastleMathEcECCurve_COORD_LAMBDA_AFFINE:
    {
      OrgBouncycastleMathEcECFieldElement *X = OrgBouncycastleMathEcECPoint_getRawXCoord(self), *L = OrgBouncycastleMathEcECPoint_getRawYCoord(self);
      OrgBouncycastleMathEcECFieldElement *X2 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(X)) multiplyWithOrgBouncycastleMathEcECFieldElement:scale_];
      OrgBouncycastleMathEcECFieldElement *L2 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(L)) addWithOrgBouncycastleMathEcECFieldElement:X])) divideWithOrgBouncycastleMathEcECFieldElement:scale_])) addWithOrgBouncycastleMathEcECFieldElement:X2];
      return [((OrgBouncycastleMathEcECCurve *) nil_chk([self getCurve])) createRawPointWithOrgBouncycastleMathEcECFieldElement:X withOrgBouncycastleMathEcECFieldElement:L2 withOrgBouncycastleMathEcECFieldElementArray:OrgBouncycastleMathEcECPoint_getRawZCoords(self) withBoolean:self->withCompression_];
    }
    case OrgBouncycastleMathEcECCurve_COORD_LAMBDA_PROJECTIVE:
    {
      OrgBouncycastleMathEcECFieldElement *X = OrgBouncycastleMathEcECPoint_getRawXCoord(self), *L = OrgBouncycastleMathEcECPoint_getRawYCoord(self), *Z = IOSObjectArray_Get(nil_chk(OrgBouncycastleMathEcECPoint_getRawZCoords(self)), 0);
      OrgBouncycastleMathEcECFieldElement *X2 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(X)) multiplyWithOrgBouncycastleMathEcECFieldElement:[((OrgBouncycastleMathEcECFieldElement *) nil_chk(scale_)) square]];
      OrgBouncycastleMathEcECFieldElement *L2 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(L)) addWithOrgBouncycastleMathEcECFieldElement:X])) addWithOrgBouncycastleMathEcECFieldElement:X2];
      OrgBouncycastleMathEcECFieldElement *Z2 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z)) multiplyWithOrgBouncycastleMathEcECFieldElement:scale_];
      return [((OrgBouncycastleMathEcECCurve *) nil_chk([self getCurve])) createRawPointWithOrgBouncycastleMathEcECFieldElement:X2 withOrgBouncycastleMathEcECFieldElement:L2 withOrgBouncycastleMathEcECFieldElementArray:[IOSObjectArray newArrayWithObjects:(id[]){ Z2 } count:1 type:OrgBouncycastleMathEcECFieldElement_class_()] withBoolean:self->withCompression_];
    }
    default:
    {
      return [super scaleXWithOrgBouncycastleMathEcECFieldElement:scale_];
    }
  }
}

- (OrgBouncycastleMathEcECPoint *)scaleYWithOrgBouncycastleMathEcECFieldElement:(OrgBouncycastleMathEcECFieldElement *)scale_ {
  if ([self isInfinity]) {
    return self;
  }
  jint coord = [self getCurveCoordinateSystem];
  switch (coord) {
    case OrgBouncycastleMathEcECCurve_COORD_LAMBDA_AFFINE:
    case OrgBouncycastleMathEcECCurve_COORD_LAMBDA_PROJECTIVE:
    {
      OrgBouncycastleMathEcECFieldElement *X = OrgBouncycastleMathEcECPoint_getRawXCoord(self), *L = OrgBouncycastleMathEcECPoint_getRawYCoord(self);
      OrgBouncycastleMathEcECFieldElement *L2 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(L)) addWithOrgBouncycastleMathEcECFieldElement:X])) multiplyWithOrgBouncycastleMathEcECFieldElement:scale_])) addWithOrgBouncycastleMathEcECFieldElement:X];
      return [((OrgBouncycastleMathEcECCurve *) nil_chk([self getCurve])) createRawPointWithOrgBouncycastleMathEcECFieldElement:X withOrgBouncycastleMathEcECFieldElement:L2 withOrgBouncycastleMathEcECFieldElementArray:OrgBouncycastleMathEcECPoint_getRawZCoords(self) withBoolean:self->withCompression_];
    }
    default:
    {
      return [super scaleYWithOrgBouncycastleMathEcECFieldElement:scale_];
    }
  }
}

- (jboolean)getCompressionYTilde {
  OrgBouncycastleMathEcECFieldElement *X = OrgBouncycastleMathEcECPoint_getRawXCoord(self);
  if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(X)) isZero]) {
    return NO;
  }
  OrgBouncycastleMathEcECFieldElement *Y = OrgBouncycastleMathEcECPoint_getRawYCoord(self);
  switch ([self getCurveCoordinateSystem]) {
    case OrgBouncycastleMathEcECCurve_COORD_LAMBDA_AFFINE:
    case OrgBouncycastleMathEcECCurve_COORD_LAMBDA_PROJECTIVE:
    {
      return [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y)) testBitZero] != [X testBitZero];
    }
    default:
    {
      return [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y)) divideWithOrgBouncycastleMathEcECFieldElement:X])) testBitZero];
    }
  }
}

+ (void)checkPointsWithOrgBouncycastleMathEcECPoint:(OrgBouncycastleMathEcECPoint *)a
                   withOrgBouncycastleMathEcECPoint:(OrgBouncycastleMathEcECPoint *)b {
  OrgBouncycastleMathEcECPoint_F2m_checkPointsWithOrgBouncycastleMathEcECPoint_withOrgBouncycastleMathEcECPoint_(a, b);
}

- (OrgBouncycastleMathEcECPoint *)addWithOrgBouncycastleMathEcECPoint:(OrgBouncycastleMathEcECPoint *)b {
  OrgBouncycastleMathEcECPoint_F2m_checkPointsWithOrgBouncycastleMathEcECPoint_withOrgBouncycastleMathEcECPoint_(self, b);
  return [self addSimpleWithOrgBouncycastleMathEcECPoint_F2m:(OrgBouncycastleMathEcECPoint_F2m *) check_class_cast(b, [OrgBouncycastleMathEcECPoint_F2m class])];
}

- (OrgBouncycastleMathEcECPoint_F2m *)addSimpleWithOrgBouncycastleMathEcECPoint_F2m:(OrgBouncycastleMathEcECPoint_F2m *)b {
  if ([self isInfinity]) {
    return b;
  }
  if ([((OrgBouncycastleMathEcECPoint_F2m *) nil_chk(b)) isInfinity]) {
    return self;
  }
  OrgBouncycastleMathEcECCurve *curve = [self getCurve];
  jint coord = [((OrgBouncycastleMathEcECCurve *) nil_chk(curve)) getCoordinateSystem];
  OrgBouncycastleMathEcECFieldElement *X1 = self->x_;
  OrgBouncycastleMathEcECFieldElement *X2 = b->x_;
  switch (coord) {
    case OrgBouncycastleMathEcECCurve_COORD_AFFINE:
    {
      OrgBouncycastleMathEcECFieldElement *Y1 = self->y_;
      OrgBouncycastleMathEcECFieldElement *Y2 = b->y_;
      OrgBouncycastleMathEcECFieldElement *dx = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(X1)) addWithOrgBouncycastleMathEcECFieldElement:X2], *dy = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y1)) addWithOrgBouncycastleMathEcECFieldElement:Y2];
      if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(dx)) isZero]) {
        if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(dy)) isZero]) {
          return (OrgBouncycastleMathEcECPoint_F2m *) check_class_cast([self twice], [OrgBouncycastleMathEcECPoint_F2m class]);
        }
        return (OrgBouncycastleMathEcECPoint_F2m *) check_class_cast([curve getInfinity], [OrgBouncycastleMathEcECPoint_F2m class]);
      }
      OrgBouncycastleMathEcECFieldElement *L = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(dy)) divideWithOrgBouncycastleMathEcECFieldElement:dx];
      OrgBouncycastleMathEcECFieldElement *X3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(L)) square])) addWithOrgBouncycastleMathEcECFieldElement:L])) addWithOrgBouncycastleMathEcECFieldElement:dx])) addWithOrgBouncycastleMathEcECFieldElement:[curve getA]];
      OrgBouncycastleMathEcECFieldElement *Y3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([L multiplyWithOrgBouncycastleMathEcECFieldElement:[X1 addWithOrgBouncycastleMathEcECFieldElement:X3]])) addWithOrgBouncycastleMathEcECFieldElement:X3])) addWithOrgBouncycastleMathEcECFieldElement:Y1];
      return new_OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(curve, X3, Y3, self->withCompression_);
    }
    case OrgBouncycastleMathEcECCurve_COORD_HOMOGENEOUS:
    {
      OrgBouncycastleMathEcECFieldElement *Y1 = self->y_, *Z1 = IOSObjectArray_Get(nil_chk(self->zs_), 0);
      OrgBouncycastleMathEcECFieldElement *Y2 = b->y_, *Z2 = IOSObjectArray_Get(b->zs_, 0);
      jboolean Z2IsOne = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z2)) isOne];
      OrgBouncycastleMathEcECFieldElement *U1 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z1)) multiplyWithOrgBouncycastleMathEcECFieldElement:Y2];
      OrgBouncycastleMathEcECFieldElement *U2 = Z2IsOne ? Y1 : [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y1)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z2];
      OrgBouncycastleMathEcECFieldElement *U = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(U1)) addWithOrgBouncycastleMathEcECFieldElement:U2];
      OrgBouncycastleMathEcECFieldElement *V1 = [Z1 multiplyWithOrgBouncycastleMathEcECFieldElement:X2];
      OrgBouncycastleMathEcECFieldElement *V2 = Z2IsOne ? X1 : [((OrgBouncycastleMathEcECFieldElement *) nil_chk(X1)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z2];
      OrgBouncycastleMathEcECFieldElement *V = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(V1)) addWithOrgBouncycastleMathEcECFieldElement:V2];
      if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(V)) isZero]) {
        if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(U)) isZero]) {
          return (OrgBouncycastleMathEcECPoint_F2m *) check_class_cast([self twice], [OrgBouncycastleMathEcECPoint_F2m class]);
        }
        return (OrgBouncycastleMathEcECPoint_F2m *) check_class_cast([curve getInfinity], [OrgBouncycastleMathEcECPoint_F2m class]);
      }
      OrgBouncycastleMathEcECFieldElement *VSq = [V square];
      OrgBouncycastleMathEcECFieldElement *VCu = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(VSq)) multiplyWithOrgBouncycastleMathEcECFieldElement:V];
      OrgBouncycastleMathEcECFieldElement *W = Z2IsOne ? Z1 : [Z1 multiplyWithOrgBouncycastleMathEcECFieldElement:Z2];
      OrgBouncycastleMathEcECFieldElement *uv = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(U)) addWithOrgBouncycastleMathEcECFieldElement:V];
      OrgBouncycastleMathEcECFieldElement *A = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(uv)) multiplyPlusProductWithOrgBouncycastleMathEcECFieldElement:U withOrgBouncycastleMathEcECFieldElement:VSq withOrgBouncycastleMathEcECFieldElement:[curve getA]])) multiplyWithOrgBouncycastleMathEcECFieldElement:W])) addWithOrgBouncycastleMathEcECFieldElement:VCu];
      OrgBouncycastleMathEcECFieldElement *X3 = [V multiplyWithOrgBouncycastleMathEcECFieldElement:A];
      OrgBouncycastleMathEcECFieldElement *VSqZ2 = Z2IsOne ? VSq : [VSq multiplyWithOrgBouncycastleMathEcECFieldElement:Z2];
      OrgBouncycastleMathEcECFieldElement *Y3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([U multiplyPlusProductWithOrgBouncycastleMathEcECFieldElement:X1 withOrgBouncycastleMathEcECFieldElement:V withOrgBouncycastleMathEcECFieldElement:Y1])) multiplyPlusProductWithOrgBouncycastleMathEcECFieldElement:VSqZ2 withOrgBouncycastleMathEcECFieldElement:uv withOrgBouncycastleMathEcECFieldElement:A];
      OrgBouncycastleMathEcECFieldElement *Z3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(VCu)) multiplyWithOrgBouncycastleMathEcECFieldElement:W];
      return new_OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_(curve, X3, Y3, [IOSObjectArray newArrayWithObjects:(id[]){ Z3 } count:1 type:OrgBouncycastleMathEcECFieldElement_class_()], self->withCompression_);
    }
    case OrgBouncycastleMathEcECCurve_COORD_LAMBDA_PROJECTIVE:
    {
      if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(X1)) isZero]) {
        if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(X2)) isZero]) {
          return (OrgBouncycastleMathEcECPoint_F2m *) check_class_cast([curve getInfinity], [OrgBouncycastleMathEcECPoint_F2m class]);
        }
        return [b addSimpleWithOrgBouncycastleMathEcECPoint_F2m:self];
      }
      OrgBouncycastleMathEcECFieldElement *L1 = self->y_, *Z1 = IOSObjectArray_Get(nil_chk(self->zs_), 0);
      OrgBouncycastleMathEcECFieldElement *L2 = b->y_, *Z2 = IOSObjectArray_Get(b->zs_, 0);
      jboolean Z1IsOne = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z1)) isOne];
      OrgBouncycastleMathEcECFieldElement *U2 = X2, *S2 = L2;
      if (!Z1IsOne) {
        U2 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(U2)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z1];
        S2 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(S2)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z1];
      }
      jboolean Z2IsOne = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z2)) isOne];
      OrgBouncycastleMathEcECFieldElement *U1 = X1, *S1 = L1;
      if (!Z2IsOne) {
        U1 = [U1 multiplyWithOrgBouncycastleMathEcECFieldElement:Z2];
        S1 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(S1)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z2];
      }
      OrgBouncycastleMathEcECFieldElement *A = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(S1)) addWithOrgBouncycastleMathEcECFieldElement:S2];
      OrgBouncycastleMathEcECFieldElement *B = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(U1)) addWithOrgBouncycastleMathEcECFieldElement:U2];
      if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(B)) isZero]) {
        if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(A)) isZero]) {
          return (OrgBouncycastleMathEcECPoint_F2m *) check_class_cast([self twice], [OrgBouncycastleMathEcECPoint_F2m class]);
        }
        return (OrgBouncycastleMathEcECPoint_F2m *) check_class_cast([curve getInfinity], [OrgBouncycastleMathEcECPoint_F2m class]);
      }
      OrgBouncycastleMathEcECFieldElement *X3, *L3, *Z3;
      if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(X2)) isZero]) {
        OrgBouncycastleMathEcECPoint *p = [self normalize];
        X1 = [((OrgBouncycastleMathEcECPoint *) nil_chk(p)) getXCoord];
        OrgBouncycastleMathEcECFieldElement *Y1 = [p getYCoord];
        OrgBouncycastleMathEcECFieldElement *Y2 = L2;
        OrgBouncycastleMathEcECFieldElement *L = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y1)) addWithOrgBouncycastleMathEcECFieldElement:Y2])) divideWithOrgBouncycastleMathEcECFieldElement:X1];
        X3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(L)) square])) addWithOrgBouncycastleMathEcECFieldElement:L])) addWithOrgBouncycastleMathEcECFieldElement:X1])) addWithOrgBouncycastleMathEcECFieldElement:[curve getA]];
        if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(X3)) isZero]) {
          return new_OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(curve, X3, [((OrgBouncycastleMathEcECFieldElement *) nil_chk([curve getB])) sqrt], self->withCompression_);
        }
        OrgBouncycastleMathEcECFieldElement *Y3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([L multiplyWithOrgBouncycastleMathEcECFieldElement:[((OrgBouncycastleMathEcECFieldElement *) nil_chk(X1)) addWithOrgBouncycastleMathEcECFieldElement:X3]])) addWithOrgBouncycastleMathEcECFieldElement:X3])) addWithOrgBouncycastleMathEcECFieldElement:Y1];
        L3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y3)) divideWithOrgBouncycastleMathEcECFieldElement:X3])) addWithOrgBouncycastleMathEcECFieldElement:X3];
        Z3 = [curve fromBigIntegerWithJavaMathBigInteger:OrgBouncycastleMathEcECConstants_get_ONE_()];
      }
      else {
        B = [B square];
        OrgBouncycastleMathEcECFieldElement *AU1 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(A)) multiplyWithOrgBouncycastleMathEcECFieldElement:U1];
        OrgBouncycastleMathEcECFieldElement *AU2 = [A multiplyWithOrgBouncycastleMathEcECFieldElement:U2];
        X3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(AU1)) multiplyWithOrgBouncycastleMathEcECFieldElement:AU2];
        if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(X3)) isZero]) {
          return new_OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(curve, X3, [((OrgBouncycastleMathEcECFieldElement *) nil_chk([curve getB])) sqrt], self->withCompression_);
        }
        OrgBouncycastleMathEcECFieldElement *ABZ2 = [A multiplyWithOrgBouncycastleMathEcECFieldElement:B];
        if (!Z2IsOne) {
          ABZ2 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(ABZ2)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z2];
        }
        L3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(AU2)) addWithOrgBouncycastleMathEcECFieldElement:B])) squarePlusProductWithOrgBouncycastleMathEcECFieldElement:ABZ2 withOrgBouncycastleMathEcECFieldElement:[((OrgBouncycastleMathEcECFieldElement *) nil_chk(L1)) addWithOrgBouncycastleMathEcECFieldElement:Z1]];
        Z3 = ABZ2;
        if (!Z1IsOne) {
          Z3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z3)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z1];
        }
      }
      return new_OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_(curve, X3, L3, [IOSObjectArray newArrayWithObjects:(id[]){ Z3 } count:1 type:OrgBouncycastleMathEcECFieldElement_class_()], self->withCompression_);
    }
    default:
    {
      @throw new_JavaLangIllegalStateException_initWithNSString_(@"unsupported coordinate system");
    }
  }
}

- (OrgBouncycastleMathEcECPoint *)subtractWithOrgBouncycastleMathEcECPoint:(OrgBouncycastleMathEcECPoint *)b {
  OrgBouncycastleMathEcECPoint_F2m_checkPointsWithOrgBouncycastleMathEcECPoint_withOrgBouncycastleMathEcECPoint_(self, b);
  return [self subtractSimpleWithOrgBouncycastleMathEcECPoint_F2m:(OrgBouncycastleMathEcECPoint_F2m *) check_class_cast(b, [OrgBouncycastleMathEcECPoint_F2m class])];
}

- (OrgBouncycastleMathEcECPoint_F2m *)subtractSimpleWithOrgBouncycastleMathEcECPoint_F2m:(OrgBouncycastleMathEcECPoint_F2m *)b {
  if ([((OrgBouncycastleMathEcECPoint_F2m *) nil_chk(b)) isInfinity]) {
    return self;
  }
  return [self addSimpleWithOrgBouncycastleMathEcECPoint_F2m:(OrgBouncycastleMathEcECPoint_F2m *) check_class_cast([b negate], [OrgBouncycastleMathEcECPoint_F2m class])];
}

- (OrgBouncycastleMathEcECPoint_F2m *)tau {
  if ([self isInfinity]) {
    return self;
  }
  OrgBouncycastleMathEcECCurve *curve = [self getCurve];
  jint coord = [((OrgBouncycastleMathEcECCurve *) nil_chk(curve)) getCoordinateSystem];
  OrgBouncycastleMathEcECFieldElement *X1 = self->x_;
  switch (coord) {
    case OrgBouncycastleMathEcECCurve_COORD_AFFINE:
    case OrgBouncycastleMathEcECCurve_COORD_LAMBDA_AFFINE:
    {
      OrgBouncycastleMathEcECFieldElement *Y1 = self->y_;
      return new_OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(curve, [((OrgBouncycastleMathEcECFieldElement *) nil_chk(X1)) square], [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y1)) square], self->withCompression_);
    }
    case OrgBouncycastleMathEcECCurve_COORD_HOMOGENEOUS:
    case OrgBouncycastleMathEcECCurve_COORD_LAMBDA_PROJECTIVE:
    {
      OrgBouncycastleMathEcECFieldElement *Y1 = self->y_, *Z1 = IOSObjectArray_Get(nil_chk(self->zs_), 0);
      return new_OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_(curve, [((OrgBouncycastleMathEcECFieldElement *) nil_chk(X1)) square], [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y1)) square], [IOSObjectArray newArrayWithObjects:(id[]){ [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z1)) square] } count:1 type:OrgBouncycastleMathEcECFieldElement_class_()], self->withCompression_);
    }
    default:
    {
      @throw new_JavaLangIllegalStateException_initWithNSString_(@"unsupported coordinate system");
    }
  }
}

- (OrgBouncycastleMathEcECPoint *)twice {
  if ([self isInfinity]) {
    return self;
  }
  OrgBouncycastleMathEcECCurve *curve = [self getCurve];
  OrgBouncycastleMathEcECFieldElement *X1 = self->x_;
  if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(X1)) isZero]) {
    return [((OrgBouncycastleMathEcECCurve *) nil_chk(curve)) getInfinity];
  }
  jint coord = [((OrgBouncycastleMathEcECCurve *) nil_chk(curve)) getCoordinateSystem];
  switch (coord) {
    case OrgBouncycastleMathEcECCurve_COORD_AFFINE:
    {
      OrgBouncycastleMathEcECFieldElement *Y1 = self->y_;
      OrgBouncycastleMathEcECFieldElement *L1 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y1)) divideWithOrgBouncycastleMathEcECFieldElement:X1])) addWithOrgBouncycastleMathEcECFieldElement:X1];
      OrgBouncycastleMathEcECFieldElement *X3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(L1)) square])) addWithOrgBouncycastleMathEcECFieldElement:L1])) addWithOrgBouncycastleMathEcECFieldElement:[curve getA]];
      OrgBouncycastleMathEcECFieldElement *Y3 = [X1 squarePlusProductWithOrgBouncycastleMathEcECFieldElement:X3 withOrgBouncycastleMathEcECFieldElement:[L1 addOne]];
      return new_OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(curve, X3, Y3, self->withCompression_);
    }
    case OrgBouncycastleMathEcECCurve_COORD_HOMOGENEOUS:
    {
      OrgBouncycastleMathEcECFieldElement *Y1 = self->y_, *Z1 = IOSObjectArray_Get(nil_chk(self->zs_), 0);
      jboolean Z1IsOne = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z1)) isOne];
      OrgBouncycastleMathEcECFieldElement *X1Z1 = Z1IsOne ? X1 : [X1 multiplyWithOrgBouncycastleMathEcECFieldElement:Z1];
      OrgBouncycastleMathEcECFieldElement *Y1Z1 = Z1IsOne ? Y1 : [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y1)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z1];
      OrgBouncycastleMathEcECFieldElement *X1Sq = [X1 square];
      OrgBouncycastleMathEcECFieldElement *S = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(X1Sq)) addWithOrgBouncycastleMathEcECFieldElement:Y1Z1];
      OrgBouncycastleMathEcECFieldElement *V = X1Z1;
      OrgBouncycastleMathEcECFieldElement *vSquared = [V square];
      OrgBouncycastleMathEcECFieldElement *sv = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(S)) addWithOrgBouncycastleMathEcECFieldElement:V];
      OrgBouncycastleMathEcECFieldElement *h = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(sv)) multiplyPlusProductWithOrgBouncycastleMathEcECFieldElement:S withOrgBouncycastleMathEcECFieldElement:vSquared withOrgBouncycastleMathEcECFieldElement:[curve getA]];
      OrgBouncycastleMathEcECFieldElement *X3 = [V multiplyWithOrgBouncycastleMathEcECFieldElement:h];
      OrgBouncycastleMathEcECFieldElement *Y3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([X1Sq square])) multiplyPlusProductWithOrgBouncycastleMathEcECFieldElement:V withOrgBouncycastleMathEcECFieldElement:h withOrgBouncycastleMathEcECFieldElement:sv];
      OrgBouncycastleMathEcECFieldElement *Z3 = [V multiplyWithOrgBouncycastleMathEcECFieldElement:vSquared];
      return new_OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_(curve, X3, Y3, [IOSObjectArray newArrayWithObjects:(id[]){ Z3 } count:1 type:OrgBouncycastleMathEcECFieldElement_class_()], self->withCompression_);
    }
    case OrgBouncycastleMathEcECCurve_COORD_LAMBDA_PROJECTIVE:
    {
      OrgBouncycastleMathEcECFieldElement *L1 = self->y_, *Z1 = IOSObjectArray_Get(nil_chk(self->zs_), 0);
      jboolean Z1IsOne = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z1)) isOne];
      OrgBouncycastleMathEcECFieldElement *L1Z1 = Z1IsOne ? L1 : [((OrgBouncycastleMathEcECFieldElement *) nil_chk(L1)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z1];
      OrgBouncycastleMathEcECFieldElement *Z1Sq = Z1IsOne ? Z1 : [Z1 square];
      OrgBouncycastleMathEcECFieldElement *a = [curve getA];
      OrgBouncycastleMathEcECFieldElement *aZ1Sq = Z1IsOne ? a : [((OrgBouncycastleMathEcECFieldElement *) nil_chk(a)) multiplyWithOrgBouncycastleMathEcECFieldElement:Z1Sq];
      OrgBouncycastleMathEcECFieldElement *T = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(L1)) square])) addWithOrgBouncycastleMathEcECFieldElement:L1Z1])) addWithOrgBouncycastleMathEcECFieldElement:aZ1Sq];
      if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(T)) isZero]) {
        return new_OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(curve, T, [((OrgBouncycastleMathEcECFieldElement *) nil_chk([curve getB])) sqrt], withCompression_);
      }
      OrgBouncycastleMathEcECFieldElement *X3 = [T square];
      OrgBouncycastleMathEcECFieldElement *Z3 = Z1IsOne ? T : [T multiplyWithOrgBouncycastleMathEcECFieldElement:Z1Sq];
      OrgBouncycastleMathEcECFieldElement *b = [curve getB];
      OrgBouncycastleMathEcECFieldElement *L3;
      if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(b)) bitLength] < (RShift32([curve getFieldSize], 1))) {
        OrgBouncycastleMathEcECFieldElement *t1 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([L1 addWithOrgBouncycastleMathEcECFieldElement:X1])) square];
        OrgBouncycastleMathEcECFieldElement *t2;
        if ([b isOne]) {
          t2 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([aZ1Sq addWithOrgBouncycastleMathEcECFieldElement:Z1Sq])) square];
        }
        else {
          t2 = [aZ1Sq squarePlusProductWithOrgBouncycastleMathEcECFieldElement:b withOrgBouncycastleMathEcECFieldElement:[Z1Sq square]];
        }
        L3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(t1)) addWithOrgBouncycastleMathEcECFieldElement:T])) addWithOrgBouncycastleMathEcECFieldElement:Z1Sq])) multiplyWithOrgBouncycastleMathEcECFieldElement:t1])) addWithOrgBouncycastleMathEcECFieldElement:t2])) addWithOrgBouncycastleMathEcECFieldElement:X3];
        if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(a)) isZero]) {
          L3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(L3)) addWithOrgBouncycastleMathEcECFieldElement:Z3];
        }
        else if (![a isOne]) {
          L3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(L3)) addWithOrgBouncycastleMathEcECFieldElement:[((OrgBouncycastleMathEcECFieldElement *) nil_chk([a addOne])) multiplyWithOrgBouncycastleMathEcECFieldElement:Z3]];
        }
      }
      else {
        OrgBouncycastleMathEcECFieldElement *X1Z1 = Z1IsOne ? X1 : [X1 multiplyWithOrgBouncycastleMathEcECFieldElement:Z1];
        L3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([X1Z1 squarePlusProductWithOrgBouncycastleMathEcECFieldElement:T withOrgBouncycastleMathEcECFieldElement:L1Z1])) addWithOrgBouncycastleMathEcECFieldElement:X3])) addWithOrgBouncycastleMathEcECFieldElement:Z3];
      }
      return new_OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_(curve, X3, L3, [IOSObjectArray newArrayWithObjects:(id[]){ Z3 } count:1 type:OrgBouncycastleMathEcECFieldElement_class_()], self->withCompression_);
    }
    default:
    {
      @throw new_JavaLangIllegalStateException_initWithNSString_(@"unsupported coordinate system");
    }
  }
}

- (OrgBouncycastleMathEcECPoint *)twicePlusWithOrgBouncycastleMathEcECPoint:(OrgBouncycastleMathEcECPoint *)b {
  if ([self isInfinity]) {
    return b;
  }
  if ([((OrgBouncycastleMathEcECPoint *) nil_chk(b)) isInfinity]) {
    return [self twice];
  }
  OrgBouncycastleMathEcECCurve *curve = [self getCurve];
  OrgBouncycastleMathEcECFieldElement *X1 = self->x_;
  if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(X1)) isZero]) {
    return b;
  }
  jint coord = [((OrgBouncycastleMathEcECCurve *) nil_chk(curve)) getCoordinateSystem];
  switch (coord) {
    case OrgBouncycastleMathEcECCurve_COORD_LAMBDA_PROJECTIVE:
    {
      OrgBouncycastleMathEcECFieldElement *X2 = b->x_, *Z2 = IOSObjectArray_Get(nil_chk(b->zs_), 0);
      if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(X2)) isZero] || ![((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z2)) isOne]) {
        return [((OrgBouncycastleMathEcECPoint *) nil_chk([self twice])) addWithOrgBouncycastleMathEcECPoint:b];
      }
      OrgBouncycastleMathEcECFieldElement *L1 = self->y_, *Z1 = IOSObjectArray_Get(self->zs_, 0);
      OrgBouncycastleMathEcECFieldElement *L2 = b->y_;
      OrgBouncycastleMathEcECFieldElement *X1Sq = [X1 square];
      OrgBouncycastleMathEcECFieldElement *L1Sq = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(L1)) square];
      OrgBouncycastleMathEcECFieldElement *Z1Sq = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Z1)) square];
      OrgBouncycastleMathEcECFieldElement *L1Z1 = [L1 multiplyWithOrgBouncycastleMathEcECFieldElement:Z1];
      OrgBouncycastleMathEcECFieldElement *T = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([curve getA])) multiplyWithOrgBouncycastleMathEcECFieldElement:Z1Sq])) addWithOrgBouncycastleMathEcECFieldElement:L1Sq])) addWithOrgBouncycastleMathEcECFieldElement:L1Z1];
      OrgBouncycastleMathEcECFieldElement *L2plus1 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk(L2)) addOne];
      OrgBouncycastleMathEcECFieldElement *A = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([curve getA])) addWithOrgBouncycastleMathEcECFieldElement:L2plus1])) multiplyWithOrgBouncycastleMathEcECFieldElement:Z1Sq])) addWithOrgBouncycastleMathEcECFieldElement:L1Sq])) multiplyPlusProductWithOrgBouncycastleMathEcECFieldElement:T withOrgBouncycastleMathEcECFieldElement:X1Sq withOrgBouncycastleMathEcECFieldElement:Z1Sq];
      OrgBouncycastleMathEcECFieldElement *X2Z1Sq = [X2 multiplyWithOrgBouncycastleMathEcECFieldElement:Z1Sq];
      OrgBouncycastleMathEcECFieldElement *B = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk(X2Z1Sq)) addWithOrgBouncycastleMathEcECFieldElement:T])) square];
      if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(B)) isZero]) {
        if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(A)) isZero]) {
          return [b twice];
        }
        return [curve getInfinity];
      }
      if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(A)) isZero]) {
        return new_OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(curve, A, [((OrgBouncycastleMathEcECFieldElement *) nil_chk([curve getB])) sqrt], withCompression_);
      }
      OrgBouncycastleMathEcECFieldElement *X3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([A square])) multiplyWithOrgBouncycastleMathEcECFieldElement:X2Z1Sq];
      OrgBouncycastleMathEcECFieldElement *Z3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([A multiplyWithOrgBouncycastleMathEcECFieldElement:B])) multiplyWithOrgBouncycastleMathEcECFieldElement:Z1Sq];
      OrgBouncycastleMathEcECFieldElement *L3 = [((OrgBouncycastleMathEcECFieldElement *) nil_chk([((OrgBouncycastleMathEcECFieldElement *) nil_chk([A addWithOrgBouncycastleMathEcECFieldElement:B])) square])) multiplyPlusProductWithOrgBouncycastleMathEcECFieldElement:T withOrgBouncycastleMathEcECFieldElement:L2plus1 withOrgBouncycastleMathEcECFieldElement:Z3];
      return new_OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_(curve, X3, L3, [IOSObjectArray newArrayWithObjects:(id[]){ Z3 } count:1 type:OrgBouncycastleMathEcECFieldElement_class_()], self->withCompression_);
    }
    default:
    {
      return [((OrgBouncycastleMathEcECPoint *) nil_chk([self twice])) addWithOrgBouncycastleMathEcECPoint:b];
    }
  }
}

- (OrgBouncycastleMathEcECPoint *)negate {
  if ([self isInfinity]) {
    return self;
  }
  OrgBouncycastleMathEcECFieldElement *X = self->x_;
  if ([((OrgBouncycastleMathEcECFieldElement *) nil_chk(X)) isZero]) {
    return self;
  }
  switch ([self getCurveCoordinateSystem]) {
    case OrgBouncycastleMathEcECCurve_COORD_AFFINE:
    {
      OrgBouncycastleMathEcECFieldElement *Y = self->y_;
      return new_OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(curve_, X, [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y)) addWithOrgBouncycastleMathEcECFieldElement:X], self->withCompression_);
    }
    case OrgBouncycastleMathEcECCurve_COORD_HOMOGENEOUS:
    {
      OrgBouncycastleMathEcECFieldElement *Y = self->y_, *Z = IOSObjectArray_Get(nil_chk(self->zs_), 0);
      return new_OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_(curve_, X, [((OrgBouncycastleMathEcECFieldElement *) nil_chk(Y)) addWithOrgBouncycastleMathEcECFieldElement:X], [IOSObjectArray newArrayWithObjects:(id[]){ Z } count:1 type:OrgBouncycastleMathEcECFieldElement_class_()], self->withCompression_);
    }
    case OrgBouncycastleMathEcECCurve_COORD_LAMBDA_AFFINE:
    {
      OrgBouncycastleMathEcECFieldElement *L = self->y_;
      return new_OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(curve_, X, [((OrgBouncycastleMathEcECFieldElement *) nil_chk(L)) addOne], self->withCompression_);
    }
    case OrgBouncycastleMathEcECCurve_COORD_LAMBDA_PROJECTIVE:
    {
      OrgBouncycastleMathEcECFieldElement *L = self->y_, *Z = IOSObjectArray_Get(nil_chk(self->zs_), 0);
      return new_OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_(curve_, X, [((OrgBouncycastleMathEcECFieldElement *) nil_chk(L)) addWithOrgBouncycastleMathEcECFieldElement:Z], [IOSObjectArray newArrayWithObjects:(id[]){ Z } count:1 type:OrgBouncycastleMathEcECFieldElement_class_()], self->withCompression_);
    }
    default:
    {
      @throw new_JavaLangIllegalStateException_initWithNSString_(@"unsupported coordinate system");
    }
  }
}

@end

void OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_(OrgBouncycastleMathEcECPoint_F2m *self, OrgBouncycastleMathEcECCurve *curve, OrgBouncycastleMathEcECFieldElement *x, OrgBouncycastleMathEcECFieldElement *y) {
  (void) OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(self, curve, x, y, NO);
}

OrgBouncycastleMathEcECPoint_F2m *new_OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_(OrgBouncycastleMathEcECCurve *curve, OrgBouncycastleMathEcECFieldElement *x, OrgBouncycastleMathEcECFieldElement *y) {
  OrgBouncycastleMathEcECPoint_F2m *self = [OrgBouncycastleMathEcECPoint_F2m alloc];
  OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_(self, curve, x, y);
  return self;
}

void OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(OrgBouncycastleMathEcECPoint_F2m *self, OrgBouncycastleMathEcECCurve *curve, OrgBouncycastleMathEcECFieldElement *x, OrgBouncycastleMathEcECFieldElement *y, jboolean withCompression) {
  (void) OrgBouncycastleMathEcECPoint_AbstractF2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_(self, curve, x, y);
  if ((x == nil) != (y == nil)) {
    @throw new_JavaLangIllegalArgumentException_initWithNSString_(@"Exactly one of the field elements is null");
  }
  if (x != nil) {
    OrgBouncycastleMathEcECFieldElement_F2m_checkFieldElementsWithOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_(self->x_, self->y_);
    if (curve != nil) {
      OrgBouncycastleMathEcECFieldElement_F2m_checkFieldElementsWithOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_(self->x_, [((OrgBouncycastleMathEcECCurve *) nil_chk(self->curve_)) getA]);
    }
  }
  self->withCompression_ = withCompression;
}

OrgBouncycastleMathEcECPoint_F2m *new_OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(OrgBouncycastleMathEcECCurve *curve, OrgBouncycastleMathEcECFieldElement *x, OrgBouncycastleMathEcECFieldElement *y, jboolean withCompression) {
  OrgBouncycastleMathEcECPoint_F2m *self = [OrgBouncycastleMathEcECPoint_F2m alloc];
  OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withBoolean_(self, curve, x, y, withCompression);
  return self;
}

void OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_(OrgBouncycastleMathEcECPoint_F2m *self, OrgBouncycastleMathEcECCurve *curve, OrgBouncycastleMathEcECFieldElement *x, OrgBouncycastleMathEcECFieldElement *y, IOSObjectArray *zs, jboolean withCompression) {
  (void) OrgBouncycastleMathEcECPoint_AbstractF2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_(self, curve, x, y, zs);
  self->withCompression_ = withCompression;
}

OrgBouncycastleMathEcECPoint_F2m *new_OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_(OrgBouncycastleMathEcECCurve *curve, OrgBouncycastleMathEcECFieldElement *x, OrgBouncycastleMathEcECFieldElement *y, IOSObjectArray *zs, jboolean withCompression) {
  OrgBouncycastleMathEcECPoint_F2m *self = [OrgBouncycastleMathEcECPoint_F2m alloc];
  OrgBouncycastleMathEcECPoint_F2m_initWithOrgBouncycastleMathEcECCurve_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElement_withOrgBouncycastleMathEcECFieldElementArray_withBoolean_(self, curve, x, y, zs, withCompression);
  return self;
}

void OrgBouncycastleMathEcECPoint_F2m_checkPointsWithOrgBouncycastleMathEcECPoint_withOrgBouncycastleMathEcECPoint_(OrgBouncycastleMathEcECPoint *a, OrgBouncycastleMathEcECPoint *b) {
  OrgBouncycastleMathEcECPoint_F2m_initialize();
  if (((OrgBouncycastleMathEcECPoint *) nil_chk(a))->curve_ != ((OrgBouncycastleMathEcECPoint *) nil_chk(b))->curve_) {
    @throw new_JavaLangIllegalArgumentException_initWithNSString_(@"Only points on the same curve can be added or subtracted");
  }
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgBouncycastleMathEcECPoint_F2m)
