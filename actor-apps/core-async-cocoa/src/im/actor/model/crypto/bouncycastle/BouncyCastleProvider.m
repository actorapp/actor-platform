//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/ex3ndr/Develop/actor-platform/actor-apps/library/core-crypto/src/main/java/im/actor/model/crypto/bouncycastle/BouncyCastleProvider.java
//


#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "im/actor/model/crypto/AesCipher.h"
#include "im/actor/model/crypto/CryptoKeyPair.h"
#include "im/actor/model/crypto/RsaCipher.h"
#include "im/actor/model/crypto/RsaEncryptCipher.h"
#include "im/actor/model/crypto/bouncycastle/BcAesCipher.h"
#include "im/actor/model/crypto/bouncycastle/BcRsaCipher.h"
#include "im/actor/model/crypto/bouncycastle/BcRsaEncryptCipher.h"
#include "im/actor/model/crypto/bouncycastle/BouncyCastleProvider.h"
#include "im/actor/model/crypto/bouncycastle/RandomProvider.h"
#include "im/actor/model/crypto/encoding/PKS8RsaPrivateKey.h"
#include "im/actor/model/crypto/encoding/X509RsaPublicKey.h"
#include "im/actor/model/log/Log.h"
#include "java/math/BigInteger.h"
#include "org/bouncycastle/crypto/AsymmetricCipherKeyPair.h"
#include "org/bouncycastle/crypto/digests/MD5Digest.h"
#include "org/bouncycastle/crypto/digests/SHA256Digest.h"
#include "org/bouncycastle/crypto/digests/SHA512Digest.h"
#include "org/bouncycastle/crypto/generators/RSAKeyPairGenerator.h"
#include "org/bouncycastle/crypto/params/AsymmetricKeyParameter.h"
#include "org/bouncycastle/crypto/params/RSAKeyGenerationParameters.h"
#include "org/bouncycastle/crypto/params/RSAKeyParameters.h"
#include "org/bouncycastle/crypto/params/RSAPrivateCrtKeyParameters.h"

#define BCBouncyCastleProvider_RSA_CERTAINITY 80
#define BCBouncyCastleProvider_RSA_1024_STREIGHT 1024

@interface BCBouncyCastleProvider () {
 @public
  id<BCRandomProvider> provider_;
}

@end

J2OBJC_FIELD_SETTER(BCBouncyCastleProvider, provider_, id<BCRandomProvider>)

static JavaMathBigInteger *BCBouncyCastleProvider_RSA_EXPONENT_;
J2OBJC_STATIC_FIELD_GETTER(BCBouncyCastleProvider, RSA_EXPONENT_, JavaMathBigInteger *)

J2OBJC_STATIC_FIELD_GETTER(BCBouncyCastleProvider, RSA_CERTAINITY, jint)

J2OBJC_STATIC_FIELD_GETTER(BCBouncyCastleProvider, RSA_1024_STREIGHT, jint)

static JavaMathBigInteger *BCBouncyCastleProvider_ZERO_;
J2OBJC_STATIC_FIELD_GETTER(BCBouncyCastleProvider, ZERO_, JavaMathBigInteger *)

J2OBJC_INITIALIZED_DEFN(BCBouncyCastleProvider)

@implementation BCBouncyCastleProvider

- (instancetype)initWithBCRandomProvider:(id<BCRandomProvider>)provider {
  BCBouncyCastleProvider_initWithBCRandomProvider_(self, provider);
  return self;
}

- (AMCryptoKeyPair *)generateRSA1024KeyPair {
  OrgBouncycastleCryptoGeneratorsRSAKeyPairGenerator *generator = new_OrgBouncycastleCryptoGeneratorsRSAKeyPairGenerator_init();
  [generator init__WithOrgBouncycastleCryptoKeyGenerationParameters:new_OrgBouncycastleCryptoParamsRSAKeyGenerationParameters_initWithJavaMathBigInteger_withBCRandomProvider_withInt_withInt_(BCBouncyCastleProvider_RSA_EXPONENT_, provider_, BCBouncyCastleProvider_RSA_1024_STREIGHT, BCBouncyCastleProvider_RSA_CERTAINITY)];
  AMLog_dWithNSString_withNSString_(@"RSA", @"Starting key generation...");
  OrgBouncycastleCryptoAsymmetricCipherKeyPair *res = [generator generateKeyPair];
  OrgBouncycastleCryptoParamsRSAKeyParameters *rsaPublicKey = (OrgBouncycastleCryptoParamsRSAKeyParameters *) check_class_cast([((OrgBouncycastleCryptoAsymmetricCipherKeyPair *) nil_chk(res)) getPublic], [OrgBouncycastleCryptoParamsRSAKeyParameters class]);
  IOSByteArray *publicKey = [new_BCX509RsaPublicKey_initWithJavaMathBigInteger_withJavaMathBigInteger_([((OrgBouncycastleCryptoParamsRSAKeyParameters *) nil_chk(rsaPublicKey)) getModulus], [rsaPublicKey getExponent]) serialize];
  OrgBouncycastleCryptoParamsRSAPrivateCrtKeyParameters *parameter = (OrgBouncycastleCryptoParamsRSAPrivateCrtKeyParameters *) check_class_cast([res getPrivate], [OrgBouncycastleCryptoParamsRSAPrivateCrtKeyParameters class]);
  IOSByteArray *privateKey = [new_BCPKS8RsaPrivateKey_initWithJavaMathBigInteger_withJavaMathBigInteger_([((OrgBouncycastleCryptoParamsRSAPrivateCrtKeyParameters *) nil_chk(parameter)) getModulus], [parameter getExponent]) serialize];
  return new_AMCryptoKeyPair_initWithByteArray_withByteArray_(publicKey, privateKey);
}

- (id<AMRsaEncryptCipher>)createRSAOAEPSHA1CipherWithPublicKey:(IOSByteArray *)key {
  return new_BCBcRsaEncryptCipher_initWithBCRandomProvider_withByteArray_(provider_, key);
}

- (id<AMRsaCipher>)createRSAOAEPSHA1CipherWithPublicKey:(IOSByteArray *)publicKey
                                         withPrivateKey:(IOSByteArray *)privateKey {
  return new_BCBcRsaCipher_initWithBCRandomProvider_withByteArray_withByteArray_(provider_, publicKey, privateKey);
}

- (id<AMAesCipher>)createAESCBCPKS7CipherWithKey:(IOSByteArray *)key
                                          withIv:(IOSByteArray *)iv {
  return new_BCBcAesCipher_initWithByteArray_withByteArray_(key, iv);
}

- (IOSByteArray *)MD5WithData:(IOSByteArray *)data {
  OrgBouncycastleCryptoDigestsMD5Digest *digest = new_OrgBouncycastleCryptoDigestsMD5Digest_init();
  [digest updateWithByteArray:data withInt:0 withInt:((IOSByteArray *) nil_chk(data))->size_];
  IOSByteArray *res = [IOSByteArray newArrayWithLength:16];
  [digest doFinalWithByteArray:res withInt:0];
  return res;
}

- (IOSByteArray *)SHA256WithData:(IOSByteArray *)data {
  OrgBouncycastleCryptoDigestsSHA256Digest *digest = new_OrgBouncycastleCryptoDigestsSHA256Digest_init();
  [digest updateWithByteArray:data withInt:0 withInt:((IOSByteArray *) nil_chk(data))->size_];
  IOSByteArray *res = [IOSByteArray newArrayWithLength:32];
  [digest doFinalWithByteArray:res withInt:0];
  return res;
}

- (IOSByteArray *)SHA512WithData:(IOSByteArray *)data {
  OrgBouncycastleCryptoDigestsSHA512Digest *digest = new_OrgBouncycastleCryptoDigestsSHA512Digest_init();
  [digest updateWithByteArray:data withInt:0 withInt:((IOSByteArray *) nil_chk(data))->size_];
  IOSByteArray *res = [IOSByteArray newArrayWithLength:64];
  [digest doFinalWithByteArray:res withInt:0];
  return res;
}

- (IOSByteArray *)randomBytesWithLength:(jint)length {
  return [((id<BCRandomProvider>) nil_chk(provider_)) randomBytesWithInt:length];
}

- (jint)randomIntWithMaxValue:(jint)maxValue {
  return [((id<BCRandomProvider>) nil_chk(provider_)) randomIntWithInt:maxValue];
}

+ (void)initialize {
  if (self == [BCBouncyCastleProvider class]) {
    BCBouncyCastleProvider_RSA_EXPONENT_ = new_JavaMathBigInteger_initWithNSString_(@"3");
    BCBouncyCastleProvider_ZERO_ = JavaMathBigInteger_valueOfWithLong_(0);
    J2OBJC_SET_INITIALIZED(BCBouncyCastleProvider)
  }
}

@end

void BCBouncyCastleProvider_initWithBCRandomProvider_(BCBouncyCastleProvider *self, id<BCRandomProvider> provider) {
  (void) NSObject_init(self);
  self->provider_ = provider;
}

BCBouncyCastleProvider *new_BCBouncyCastleProvider_initWithBCRandomProvider_(id<BCRandomProvider> provider) {
  BCBouncyCastleProvider *self = [BCBouncyCastleProvider alloc];
  BCBouncyCastleProvider_initWithBCRandomProvider_(self, provider);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(BCBouncyCastleProvider)
