//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/ex3ndr/Develop/actor-proprietary/actor-apps/core/src/main/java/im/actor/model/modules/messages/entity/MessagesStorage.java
//


#include "IOSClass.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "im/actor/model/droidkit/bser/Bser.h"
#include "im/actor/model/droidkit/bser/BserObject.h"
#include "im/actor/model/droidkit/bser/BserValues.h"
#include "im/actor/model/droidkit/bser/BserWriter.h"
#include "im/actor/model/modules/messages/entity/MessageRef.h"
#include "im/actor/model/modules/messages/entity/MessagesStorage.h"
#include "java/io/IOException.h"
#include "java/lang/Long.h"
#include "java/util/ArrayList.h"
#include "java/util/List.h"

@interface ImActorModelModulesMessagesEntityMessagesStorage () {
 @public
  JavaUtilArrayList *messages_;
}

@end

J2OBJC_FIELD_SETTER(ImActorModelModulesMessagesEntityMessagesStorage, messages_, JavaUtilArrayList *)

@implementation ImActorModelModulesMessagesEntityMessagesStorage

+ (ImActorModelModulesMessagesEntityMessagesStorage *)fromBytesWithByteArray:(IOSByteArray *)data {
  return ImActorModelModulesMessagesEntityMessagesStorage_fromBytesWithByteArray_(data);
}

- (JavaUtilArrayList *)getMessages {
  return messages_;
}

- (void)addOrUpdateWithLong:(jlong)rid
                   withLong:(jlong)date {
  for (ImActorModelModulesMessagesEntityMessageRef * __strong ref in nil_chk(messages_)) {
    if ([((ImActorModelModulesMessagesEntityMessageRef *) nil_chk(ref)) getRid] == rid) {
      [messages_ removeWithId:ref];
      break;
    }
  }
  [messages_ addWithId:new_ImActorModelModulesMessagesEntityMessageRef_initWithLong_withLong_(rid, date)];
}

- (jboolean)updateWithLong:(jlong)rid
                  withLong:(jlong)date {
  for (ImActorModelModulesMessagesEntityMessageRef * __strong ref in nil_chk(messages_)) {
    if ([((ImActorModelModulesMessagesEntityMessageRef *) nil_chk(ref)) getRid] == rid) {
      [messages_ removeWithId:ref];
      [messages_ addWithId:new_ImActorModelModulesMessagesEntityMessageRef_initWithLong_withLong_(rid, date)];
      return YES;
    }
  }
  return NO;
}

- (jboolean)removeWithLong:(jlong)rid {
  for (ImActorModelModulesMessagesEntityMessageRef * __strong ref in nil_chk(messages_)) {
    if ([((ImActorModelModulesMessagesEntityMessageRef *) nil_chk(ref)) getRid] == rid) {
      [messages_ removeWithId:ref];
      return YES;
    }
  }
  return NO;
}

- (jboolean)removeWithJavaUtilList:(id<JavaUtilList>)rids {
  JavaUtilArrayList *toRemove = [self findWithJavaUtilList:rids];
  if ([((JavaUtilArrayList *) nil_chk(toRemove)) size] > 0) {
    [((JavaUtilArrayList *) nil_chk(messages_)) removeAllWithJavaUtilCollection:toRemove];
    return NO;
  }
  return NO;
}

- (JavaUtilArrayList *)findWithJavaUtilList:(id<JavaUtilList>)rids {
  JavaUtilArrayList *res = new_JavaUtilArrayList_init();
  for (ImActorModelModulesMessagesEntityMessageRef * __strong ref in nil_chk(messages_)) {
    {
      for (JavaLangLong * __strong l in nil_chk(rids)) {
        if ([((ImActorModelModulesMessagesEntityMessageRef *) nil_chk(ref)) getRid] == [((JavaLangLong *) nil_chk(l)) longLongValue]) {
          [res addWithId:ref];
          goto continue_outer;
        }
      }
    }
    continue_outer: ;
  }
  return res;
}

- (JavaUtilArrayList *)removeBeforeDateWithLong:(jlong)date {
  JavaUtilArrayList *res = [self findBeforeDateWithLong:date];
  [((JavaUtilArrayList *) nil_chk(messages_)) removeAllWithJavaUtilCollection:res];
  return res;
}

- (JavaUtilArrayList *)findBeforeDateWithLong:(jlong)date {
  JavaUtilArrayList *res = new_JavaUtilArrayList_init();
  for (ImActorModelModulesMessagesEntityMessageRef * __strong ref in nil_chk(messages_)) {
    if ([((ImActorModelModulesMessagesEntityMessageRef *) nil_chk(ref)) getDate] <= date) {
      [res addWithId:ref];
    }
  }
  return res;
}

- (void)clear {
  [((JavaUtilArrayList *) nil_chk(messages_)) clear];
}

- (jint)getCount {
  return [((JavaUtilArrayList *) nil_chk(messages_)) size];
}

- (void)parseWithBSBserValues:(BSBserValues *)values {
  [((JavaUtilArrayList *) nil_chk(messages_)) clear];
  jint count = [((BSBserValues *) nil_chk(values)) getRepeatedCountWithInt:1];
  id<JavaUtilList> tmp = new_JavaUtilArrayList_init();
  for (jint i = 0; i < count; i++) {
    [tmp addWithId:new_ImActorModelModulesMessagesEntityMessageRef_init()];
  }
  [messages_ addAllWithJavaUtilCollection:[values getRepeatedObjWithInt:1 withJavaUtilList:tmp]];
}

- (void)serializeWithBSBserWriter:(BSBserWriter *)writer {
  [((BSBserWriter *) nil_chk(writer)) writeRepeatedObjWithInt:1 withJavaUtilList:messages_];
}

- (instancetype)init {
  ImActorModelModulesMessagesEntityMessagesStorage_init(self);
  return self;
}

@end

ImActorModelModulesMessagesEntityMessagesStorage *ImActorModelModulesMessagesEntityMessagesStorage_fromBytesWithByteArray_(IOSByteArray *data) {
  ImActorModelModulesMessagesEntityMessagesStorage_initialize();
  return ((ImActorModelModulesMessagesEntityMessagesStorage *) BSBser_parseWithBSBserObject_withByteArray_(new_ImActorModelModulesMessagesEntityMessagesStorage_init(), data));
}

void ImActorModelModulesMessagesEntityMessagesStorage_init(ImActorModelModulesMessagesEntityMessagesStorage *self) {
  (void) BSBserObject_init(self);
  self->messages_ = new_JavaUtilArrayList_init();
}

ImActorModelModulesMessagesEntityMessagesStorage *new_ImActorModelModulesMessagesEntityMessagesStorage_init() {
  ImActorModelModulesMessagesEntityMessagesStorage *self = [ImActorModelModulesMessagesEntityMessagesStorage alloc];
  ImActorModelModulesMessagesEntityMessagesStorage_init(self);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesMessagesEntityMessagesStorage)
