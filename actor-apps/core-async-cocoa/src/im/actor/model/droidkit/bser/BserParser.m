//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/ex3ndr/Develop/actor-proprietary/actor-apps/core/src/main/java/im/actor/model/droidkit/bser/BserParser.java
//


#include "IOSClass.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "im/actor/model/droidkit/bser/BserParser.h"
#include "im/actor/model/droidkit/bser/DataInput.h"
#include "im/actor/model/droidkit/bser/WireTypes.h"
#include "im/actor/model/droidkit/bser/util/SparseArray.h"
#include "java/io/IOException.h"
#include "java/lang/Long.h"
#include "java/util/ArrayList.h"
#include "java/util/List.h"

@interface BSBserParser ()

+ (void)putWithInt:(jint)id_
            withId:(id)res
withImActorModelDroidkitBserUtilSparseArray:(ImActorModelDroidkitBserUtilSparseArray *)hashMap;

- (instancetype)init;

@end

__attribute__((unused)) static void BSBserParser_putWithInt_withId_withImActorModelDroidkitBserUtilSparseArray_(jint id_, id res, ImActorModelDroidkitBserUtilSparseArray *hashMap);

__attribute__((unused)) static void BSBserParser_init(BSBserParser *self);

__attribute__((unused)) static BSBserParser *new_BSBserParser_init() NS_RETURNS_RETAINED;

@implementation BSBserParser

+ (ImActorModelDroidkitBserUtilSparseArray *)deserializeWithBSDataInput:(BSDataInput *)is {
  return BSBserParser_deserializeWithBSDataInput_(is);
}

+ (void)putWithInt:(jint)id_
            withId:(id)res
withImActorModelDroidkitBserUtilSparseArray:(ImActorModelDroidkitBserUtilSparseArray *)hashMap {
  BSBserParser_putWithInt_withId_withImActorModelDroidkitBserUtilSparseArray_(id_, res, hashMap);
}

- (instancetype)init {
  BSBserParser_init(self);
  return self;
}

@end

ImActorModelDroidkitBserUtilSparseArray *BSBserParser_deserializeWithBSDataInput_(BSDataInput *is) {
  BSBserParser_initialize();
  ImActorModelDroidkitBserUtilSparseArray *hashMap = new_ImActorModelDroidkitBserUtilSparseArray_init();
  while (![((BSDataInput *) nil_chk(is)) isEOF]) {
    jlong currentTag = [is readVarInt];
    jint id_ = (jint) (RShift64(currentTag, 3));
    jint type = (jint) (currentTag & (jint) 0x7);
    if (type == BSWireTypes_TYPE_VARINT) {
      BSBserParser_putWithInt_withId_withImActorModelDroidkitBserUtilSparseArray_(id_, JavaLangLong_valueOfWithLong_([is readVarInt]), hashMap);
    }
    else if (type == BSWireTypes_TYPE_LENGTH_DELIMITED) {
      jint size = (jint) [is readVarInt];
      BSBserParser_putWithInt_withId_withImActorModelDroidkitBserUtilSparseArray_(id_, [is readBytesWithInt:size], hashMap);
    }
    else if (type == BSWireTypes_TYPE_64BIT) {
      BSBserParser_putWithInt_withId_withImActorModelDroidkitBserUtilSparseArray_(id_, JavaLangLong_valueOfWithLong_([is readLong]), hashMap);
    }
    else if (type == BSWireTypes_TYPE_32BIT) {
      BSBserParser_putWithInt_withId_withImActorModelDroidkitBserUtilSparseArray_(id_, JavaLangLong_valueOfWithLong_([is readUInt]), hashMap);
    }
    else {
      @throw new_JavaIoIOException_initWithNSString_(JreStrcat("$I", @"Unknown Wire Type #", type));
    }
  }
  return hashMap;
}

void BSBserParser_putWithInt_withId_withImActorModelDroidkitBserUtilSparseArray_(jint id_, id res, ImActorModelDroidkitBserUtilSparseArray *hashMap) {
  BSBserParser_initialize();
  if ([((ImActorModelDroidkitBserUtilSparseArray *) nil_chk(hashMap)) getWithInt:id_] != nil) {
    if ([JavaUtilList_class_() isInstance:[hashMap getWithInt:id_]]) {
      [((id<JavaUtilList>) nil_chk(((id<JavaUtilList>) check_protocol_cast([hashMap getWithInt:id_], @protocol(JavaUtilList))))) addWithId:res];
    }
    else {
      JavaUtilArrayList *list = new_JavaUtilArrayList_init();
      [list addWithId:[hashMap getWithInt:id_]];
      [list addWithId:res];
      [hashMap putWithInt:id_ withId:list];
    }
  }
  else {
    [hashMap putWithInt:id_ withId:res];
  }
}

void BSBserParser_init(BSBserParser *self) {
  (void) NSObject_init(self);
}

BSBserParser *new_BSBserParser_init() {
  BSBserParser *self = [BSBserParser alloc];
  BSBserParser_init(self);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(BSBserParser)
