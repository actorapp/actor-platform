//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/ex3ndr/Develop/actor-model/library/actor-cocoa-base/build/java/im/actor/model/network/api/ApiBroker.java
//


#include "IOSClass.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "im/actor/model/NetworkProvider.h"
#include "im/actor/model/api/parser/RpcParser.h"
#include "im/actor/model/droidkit/actors/Actor.h"
#include "im/actor/model/droidkit/actors/ActorCreator.h"
#include "im/actor/model/droidkit/actors/ActorRef.h"
#include "im/actor/model/droidkit/actors/ActorSystem.h"
#include "im/actor/model/droidkit/actors/Environment.h"
#include "im/actor/model/droidkit/actors/Props.h"
#include "im/actor/model/log/Log.h"
#include "im/actor/model/network/ActorApiCallback.h"
#include "im/actor/model/network/AuthKeyStorage.h"
#include "im/actor/model/network/Endpoints.h"
#include "im/actor/model/network/RpcCallback.h"
#include "im/actor/model/network/RpcException.h"
#include "im/actor/model/network/RpcInternalException.h"
#include "im/actor/model/network/api/ApiBroker.h"
#include "im/actor/model/network/mtp/AuthIdRetriever.h"
#include "im/actor/model/network/mtp/MTProto.h"
#include "im/actor/model/network/mtp/MTProtoCallback.h"
#include "im/actor/model/network/mtp/entity/ProtoSerializer.h"
#include "im/actor/model/network/mtp/entity/ProtoStruct.h"
#include "im/actor/model/network/mtp/entity/rpc/Push.h"
#include "im/actor/model/network/mtp/entity/rpc/RpcError.h"
#include "im/actor/model/network/mtp/entity/rpc/RpcFloodWait.h"
#include "im/actor/model/network/mtp/entity/rpc/RpcInternalError.h"
#include "im/actor/model/network/mtp/entity/rpc/RpcOk.h"
#include "im/actor/model/network/mtp/entity/rpc/RpcRequest.h"
#include "im/actor/model/network/parser/Request.h"
#include "im/actor/model/network/parser/Response.h"
#include "im/actor/model/network/parser/RpcScope.h"
#include "im/actor/model/util/AtomicLongCompat.h"
#include "im/actor/model/util/ExponentialBackoff.h"
#include "java/io/IOException.h"
#include "java/lang/Long.h"
#include "java/util/Collection.h"
#include "java/util/HashMap.h"
#include "java/util/Random.h"

@interface ImActorModelNetworkApiApiBroker () {
 @public
  AMEndpoints *endpoints_;
  id<AMAuthKeyStorage> keyStorage_;
  id<AMActorApiCallback> callback_;
  JavaUtilHashMap *requests_;
  JavaUtilHashMap *idMap_;
  MTMTProto *proto_;
  id<AMNetworkProvider> networkProvider_;
  AMExponentialBackoff *authIdBackOff_;
}

- (void)onNetworkChanged;

- (void)requestAuthId;

- (void)createMtProtoWithLong:(jlong)key;

- (void)performRequestWithLong:(jlong)randomId
                 withAPRequest:(APRequest *)message
             withAMRpcCallback:(id<AMRpcCallback>)callback;

- (void)processResponseWithLong:(jlong)mid
                  withByteArray:(IOSByteArray *)content;

- (void)forceResendWithLong:(jlong)randomId;

- (void)cancelRequestWithLong:(jlong)randomId;

- (void)processUpdateWithByteArray:(IOSByteArray *)content;

@end

J2OBJC_FIELD_SETTER(ImActorModelNetworkApiApiBroker, endpoints_, AMEndpoints *)
J2OBJC_FIELD_SETTER(ImActorModelNetworkApiApiBroker, keyStorage_, id<AMAuthKeyStorage>)
J2OBJC_FIELD_SETTER(ImActorModelNetworkApiApiBroker, callback_, id<AMActorApiCallback>)
J2OBJC_FIELD_SETTER(ImActorModelNetworkApiApiBroker, requests_, JavaUtilHashMap *)
J2OBJC_FIELD_SETTER(ImActorModelNetworkApiApiBroker, idMap_, JavaUtilHashMap *)
J2OBJC_FIELD_SETTER(ImActorModelNetworkApiApiBroker, proto_, MTMTProto *)
J2OBJC_FIELD_SETTER(ImActorModelNetworkApiApiBroker, networkProvider_, id<AMNetworkProvider>)
J2OBJC_FIELD_SETTER(ImActorModelNetworkApiApiBroker, authIdBackOff_, AMExponentialBackoff *)

static NSString *ImActorModelNetworkApiApiBroker_TAG_ = @"ApiBroker";
J2OBJC_STATIC_FIELD_GETTER(ImActorModelNetworkApiApiBroker, TAG_, NSString *)

static AMAtomicLongCompat *ImActorModelNetworkApiApiBroker_NEXT_RPC_ID_;
J2OBJC_STATIC_FIELD_GETTER(ImActorModelNetworkApiApiBroker, NEXT_RPC_ID_, AMAtomicLongCompat *)

__attribute__((unused)) static void ImActorModelNetworkApiApiBroker_onNetworkChanged(ImActorModelNetworkApiApiBroker *self);

__attribute__((unused)) static void ImActorModelNetworkApiApiBroker_requestAuthId(ImActorModelNetworkApiApiBroker *self);

__attribute__((unused)) static void ImActorModelNetworkApiApiBroker_createMtProtoWithLong_(ImActorModelNetworkApiApiBroker *self, jlong key);

__attribute__((unused)) static void ImActorModelNetworkApiApiBroker_performRequestWithLong_withAPRequest_withAMRpcCallback_(ImActorModelNetworkApiApiBroker *self, jlong randomId, APRequest *message, id<AMRpcCallback> callback);

__attribute__((unused)) static void ImActorModelNetworkApiApiBroker_processResponseWithLong_withByteArray_(ImActorModelNetworkApiApiBroker *self, jlong mid, IOSByteArray *content);

__attribute__((unused)) static void ImActorModelNetworkApiApiBroker_forceResendWithLong_(ImActorModelNetworkApiApiBroker *self, jlong randomId);

__attribute__((unused)) static void ImActorModelNetworkApiApiBroker_cancelRequestWithLong_(ImActorModelNetworkApiApiBroker *self, jlong randomId);

__attribute__((unused)) static void ImActorModelNetworkApiApiBroker_processUpdateWithByteArray_(ImActorModelNetworkApiApiBroker *self, IOSByteArray *content);

@interface ImActorModelNetworkApiApiBroker_PerformRequest () {
 @public
  APRequest *message_;
  id<AMRpcCallback> callback_;
}

@end

J2OBJC_FIELD_SETTER(ImActorModelNetworkApiApiBroker_PerformRequest, message_, APRequest *)
J2OBJC_FIELD_SETTER(ImActorModelNetworkApiApiBroker_PerformRequest, callback_, id<AMRpcCallback>)

@interface ImActorModelNetworkApiApiBroker_CancelRequest () {
 @public
  jlong randomId_;
}

@end

@interface ImActorModelNetworkApiApiBroker_RequestAuthId : NSObject

- (instancetype)initWithImActorModelNetworkApiApiBroker:(ImActorModelNetworkApiApiBroker *)outer$;

@end

J2OBJC_EMPTY_STATIC_INIT(ImActorModelNetworkApiApiBroker_RequestAuthId)

__attribute__((unused)) static void ImActorModelNetworkApiApiBroker_RequestAuthId_initWithImActorModelNetworkApiApiBroker_(ImActorModelNetworkApiApiBroker_RequestAuthId *self, ImActorModelNetworkApiApiBroker *outer$);

__attribute__((unused)) static ImActorModelNetworkApiApiBroker_RequestAuthId *new_ImActorModelNetworkApiApiBroker_RequestAuthId_initWithImActorModelNetworkApiApiBroker_(ImActorModelNetworkApiApiBroker *outer$) NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(ImActorModelNetworkApiApiBroker_RequestAuthId)

@interface ImActorModelNetworkApiApiBroker_InitMTProto : NSObject {
 @public
  jlong authId_;
}

- (instancetype)initWithImActorModelNetworkApiApiBroker:(ImActorModelNetworkApiApiBroker *)outer$
                                               withLong:(jlong)authId;

- (jlong)getAuthId;

@end

J2OBJC_EMPTY_STATIC_INIT(ImActorModelNetworkApiApiBroker_InitMTProto)

__attribute__((unused)) static void ImActorModelNetworkApiApiBroker_InitMTProto_initWithImActorModelNetworkApiApiBroker_withLong_(ImActorModelNetworkApiApiBroker_InitMTProto *self, ImActorModelNetworkApiApiBroker *outer$, jlong authId);

__attribute__((unused)) static ImActorModelNetworkApiApiBroker_InitMTProto *new_ImActorModelNetworkApiApiBroker_InitMTProto_initWithImActorModelNetworkApiApiBroker_withLong_(ImActorModelNetworkApiApiBroker *outer$, jlong authId) NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(ImActorModelNetworkApiApiBroker_InitMTProto)

@interface ImActorModelNetworkApiApiBroker_ProtoResponse : NSObject {
 @public
  jlong responseId_;
  IOSByteArray *data_;
}

- (instancetype)initWithImActorModelNetworkApiApiBroker:(ImActorModelNetworkApiApiBroker *)outer$
                                               withLong:(jlong)responseId
                                          withByteArray:(IOSByteArray *)data;

- (jlong)getResponseId;

- (IOSByteArray *)getData;

@end

J2OBJC_EMPTY_STATIC_INIT(ImActorModelNetworkApiApiBroker_ProtoResponse)

J2OBJC_FIELD_SETTER(ImActorModelNetworkApiApiBroker_ProtoResponse, data_, IOSByteArray *)

__attribute__((unused)) static void ImActorModelNetworkApiApiBroker_ProtoResponse_initWithImActorModelNetworkApiApiBroker_withLong_withByteArray_(ImActorModelNetworkApiApiBroker_ProtoResponse *self, ImActorModelNetworkApiApiBroker *outer$, jlong responseId, IOSByteArray *data);

__attribute__((unused)) static ImActorModelNetworkApiApiBroker_ProtoResponse *new_ImActorModelNetworkApiApiBroker_ProtoResponse_initWithImActorModelNetworkApiApiBroker_withLong_withByteArray_(ImActorModelNetworkApiApiBroker *outer$, jlong responseId, IOSByteArray *data) NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(ImActorModelNetworkApiApiBroker_ProtoResponse)

@interface ImActorModelNetworkApiApiBroker_ProtoUpdate : NSObject {
 @public
  IOSByteArray *data_;
}

- (instancetype)initWithImActorModelNetworkApiApiBroker:(ImActorModelNetworkApiApiBroker *)outer$
                                          withByteArray:(IOSByteArray *)data;

- (IOSByteArray *)getData;

@end

J2OBJC_EMPTY_STATIC_INIT(ImActorModelNetworkApiApiBroker_ProtoUpdate)

J2OBJC_FIELD_SETTER(ImActorModelNetworkApiApiBroker_ProtoUpdate, data_, IOSByteArray *)

__attribute__((unused)) static void ImActorModelNetworkApiApiBroker_ProtoUpdate_initWithImActorModelNetworkApiApiBroker_withByteArray_(ImActorModelNetworkApiApiBroker_ProtoUpdate *self, ImActorModelNetworkApiApiBroker *outer$, IOSByteArray *data);

__attribute__((unused)) static ImActorModelNetworkApiApiBroker_ProtoUpdate *new_ImActorModelNetworkApiApiBroker_ProtoUpdate_initWithImActorModelNetworkApiApiBroker_withByteArray_(ImActorModelNetworkApiApiBroker *outer$, IOSByteArray *data) NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(ImActorModelNetworkApiApiBroker_ProtoUpdate)

@interface ImActorModelNetworkApiApiBroker_ForceResend : NSObject {
 @public
  jlong id__;
}

- (instancetype)initWithImActorModelNetworkApiApiBroker:(ImActorModelNetworkApiApiBroker *)outer$
                                               withLong:(jlong)id_;

- (jlong)getId;

@end

J2OBJC_EMPTY_STATIC_INIT(ImActorModelNetworkApiApiBroker_ForceResend)

__attribute__((unused)) static void ImActorModelNetworkApiApiBroker_ForceResend_initWithImActorModelNetworkApiApiBroker_withLong_(ImActorModelNetworkApiApiBroker_ForceResend *self, ImActorModelNetworkApiApiBroker *outer$, jlong id_);

__attribute__((unused)) static ImActorModelNetworkApiApiBroker_ForceResend *new_ImActorModelNetworkApiApiBroker_ForceResend_initWithImActorModelNetworkApiApiBroker_withLong_(ImActorModelNetworkApiApiBroker *outer$, jlong id_) NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(ImActorModelNetworkApiApiBroker_ForceResend)

@interface ImActorModelNetworkApiApiBroker_RequestHolder : NSObject {
 @public
  MTRpcRequest *message_;
  jlong publicId_;
  id<AMRpcCallback> callback_;
  jlong protoId_;
}

- (instancetype)initWithImActorModelNetworkApiApiBroker:(ImActorModelNetworkApiApiBroker *)outer$
                                               withLong:(jlong)publicId
                                       withMTRpcRequest:(MTRpcRequest *)message
                                      withAMRpcCallback:(id<AMRpcCallback>)callback;

@end

J2OBJC_EMPTY_STATIC_INIT(ImActorModelNetworkApiApiBroker_RequestHolder)

J2OBJC_FIELD_SETTER(ImActorModelNetworkApiApiBroker_RequestHolder, message_, MTRpcRequest *)
J2OBJC_FIELD_SETTER(ImActorModelNetworkApiApiBroker_RequestHolder, callback_, id<AMRpcCallback>)

__attribute__((unused)) static void ImActorModelNetworkApiApiBroker_RequestHolder_initWithImActorModelNetworkApiApiBroker_withLong_withMTRpcRequest_withAMRpcCallback_(ImActorModelNetworkApiApiBroker_RequestHolder *self, ImActorModelNetworkApiApiBroker *outer$, jlong publicId, MTRpcRequest *message, id<AMRpcCallback> callback);

__attribute__((unused)) static ImActorModelNetworkApiApiBroker_RequestHolder *new_ImActorModelNetworkApiApiBroker_RequestHolder_initWithImActorModelNetworkApiApiBroker_withLong_withMTRpcRequest_withAMRpcCallback_(ImActorModelNetworkApiApiBroker *outer$, jlong publicId, MTRpcRequest *message, id<AMRpcCallback> callback) NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(ImActorModelNetworkApiApiBroker_RequestHolder)

@interface ImActorModelNetworkApiApiBroker_$1 : NSObject < DKActorCreator > {
 @public
  AMEndpoints *val$endpoints_;
  id<AMAuthKeyStorage> val$keyStorage_;
  id<AMActorApiCallback> val$callback_;
  id<AMNetworkProvider> val$networkProvider_;
}

- (ImActorModelNetworkApiApiBroker *)create;

- (instancetype)initWithAMEndpoints:(AMEndpoints *)capture$0
               withAMAuthKeyStorage:(id<AMAuthKeyStorage>)capture$1
             withAMActorApiCallback:(id<AMActorApiCallback>)capture$2
              withAMNetworkProvider:(id<AMNetworkProvider>)capture$3;

@end

J2OBJC_EMPTY_STATIC_INIT(ImActorModelNetworkApiApiBroker_$1)

J2OBJC_FIELD_SETTER(ImActorModelNetworkApiApiBroker_$1, val$endpoints_, AMEndpoints *)
J2OBJC_FIELD_SETTER(ImActorModelNetworkApiApiBroker_$1, val$keyStorage_, id<AMAuthKeyStorage>)
J2OBJC_FIELD_SETTER(ImActorModelNetworkApiApiBroker_$1, val$callback_, id<AMActorApiCallback>)
J2OBJC_FIELD_SETTER(ImActorModelNetworkApiApiBroker_$1, val$networkProvider_, id<AMNetworkProvider>)

__attribute__((unused)) static void ImActorModelNetworkApiApiBroker_$1_initWithAMEndpoints_withAMAuthKeyStorage_withAMActorApiCallback_withAMNetworkProvider_(ImActorModelNetworkApiApiBroker_$1 *self, AMEndpoints *capture$0, id<AMAuthKeyStorage> capture$1, id<AMActorApiCallback> capture$2, id<AMNetworkProvider> capture$3);

__attribute__((unused)) static ImActorModelNetworkApiApiBroker_$1 *new_ImActorModelNetworkApiApiBroker_$1_initWithAMEndpoints_withAMAuthKeyStorage_withAMActorApiCallback_withAMNetworkProvider_(AMEndpoints *capture$0, id<AMAuthKeyStorage> capture$1, id<AMActorApiCallback> capture$2, id<AMNetworkProvider> capture$3) NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(ImActorModelNetworkApiApiBroker_$1)

@interface ImActorModelNetworkApiApiBroker_$2 : NSObject < MTAuthIdRetriever_AuthIdCallback > {
 @public
  ImActorModelNetworkApiApiBroker *this$0_;
}

- (void)onSuccessWithLong:(jlong)authId;

- (void)onFailure;

- (instancetype)initWithImActorModelNetworkApiApiBroker:(ImActorModelNetworkApiApiBroker *)outer$;

@end

J2OBJC_EMPTY_STATIC_INIT(ImActorModelNetworkApiApiBroker_$2)

J2OBJC_FIELD_SETTER(ImActorModelNetworkApiApiBroker_$2, this$0_, ImActorModelNetworkApiApiBroker *)

__attribute__((unused)) static void ImActorModelNetworkApiApiBroker_$2_initWithImActorModelNetworkApiApiBroker_(ImActorModelNetworkApiApiBroker_$2 *self, ImActorModelNetworkApiApiBroker *outer$);

__attribute__((unused)) static ImActorModelNetworkApiApiBroker_$2 *new_ImActorModelNetworkApiApiBroker_$2_initWithImActorModelNetworkApiApiBroker_(ImActorModelNetworkApiApiBroker *outer$) NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(ImActorModelNetworkApiApiBroker_$2)

@interface ImActorModelNetworkApiApiBroker_$3 : NSObject < MTMTProtoCallback > {
 @public
  ImActorModelNetworkApiApiBroker *this$0_;
}

- (void)onRpcResponseWithLong:(jlong)mid
                withByteArray:(IOSByteArray *)content;

- (void)onUpdateWithByteArray:(IOSByteArray *)content;

- (void)onAuthKeyInvalidatedWithLong:(jlong)authKey;

- (void)onSessionCreated;

- (instancetype)initWithImActorModelNetworkApiApiBroker:(ImActorModelNetworkApiApiBroker *)outer$;

@end

J2OBJC_EMPTY_STATIC_INIT(ImActorModelNetworkApiApiBroker_$3)

J2OBJC_FIELD_SETTER(ImActorModelNetworkApiApiBroker_$3, this$0_, ImActorModelNetworkApiApiBroker *)

__attribute__((unused)) static void ImActorModelNetworkApiApiBroker_$3_initWithImActorModelNetworkApiApiBroker_(ImActorModelNetworkApiApiBroker_$3 *self, ImActorModelNetworkApiApiBroker *outer$);

__attribute__((unused)) static ImActorModelNetworkApiApiBroker_$3 *new_ImActorModelNetworkApiApiBroker_$3_initWithImActorModelNetworkApiApiBroker_(ImActorModelNetworkApiApiBroker *outer$) NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(ImActorModelNetworkApiApiBroker_$3)

J2OBJC_INITIALIZED_DEFN(ImActorModelNetworkApiApiBroker)

@implementation ImActorModelNetworkApiApiBroker

+ (DKActorRef *)getWithAMEndpoints:(AMEndpoints *)endpoints
              withAMAuthKeyStorage:(id<AMAuthKeyStorage>)keyStorage
            withAMActorApiCallback:(id<AMActorApiCallback>)callback
             withAMNetworkProvider:(id<AMNetworkProvider>)networkProvider {
  return ImActorModelNetworkApiApiBroker_getWithAMEndpoints_withAMAuthKeyStorage_withAMActorApiCallback_withAMNetworkProvider_(endpoints, keyStorage, callback, networkProvider);
}

- (instancetype)initWithAMEndpoints:(AMEndpoints *)endpoints
               withAMAuthKeyStorage:(id<AMAuthKeyStorage>)keyStorage
             withAMActorApiCallback:(id<AMActorApiCallback>)callback
              withAMNetworkProvider:(id<AMNetworkProvider>)networkProvider {
  ImActorModelNetworkApiApiBroker_initWithAMEndpoints_withAMAuthKeyStorage_withAMActorApiCallback_withAMNetworkProvider_(self, endpoints, keyStorage, callback, networkProvider);
  return self;
}

- (void)preStart {
  if ([((id<AMAuthKeyStorage>) nil_chk(keyStorage_)) getAuthKey] == 0) {
    [((DKActorRef *) nil_chk([self self__])) sendWithId:new_ImActorModelNetworkApiApiBroker_RequestAuthId_initWithImActorModelNetworkApiApiBroker_(self)];
  }
  else {
    AMLog_dWithNSString_withNSString_(ImActorModelNetworkApiApiBroker_TAG_, JreStrcat("$J", @"Key loaded: ", [keyStorage_ getAuthKey]));
    [((DKActorRef *) nil_chk([self self__])) sendWithId:new_ImActorModelNetworkApiApiBroker_InitMTProto_initWithImActorModelNetworkApiApiBroker_withLong_(self, [keyStorage_ getAuthKey])];
  }
}

- (void)onReceiveWithId:(id)message {
  if ([message isKindOfClass:[ImActorModelNetworkApiApiBroker_RequestAuthId class]]) {
    ImActorModelNetworkApiApiBroker_requestAuthId(self);
  }
  else if ([message isKindOfClass:[ImActorModelNetworkApiApiBroker_InitMTProto class]]) {
    ImActorModelNetworkApiApiBroker_createMtProtoWithLong_(self, [((ImActorModelNetworkApiApiBroker_InitMTProto *) nil_chk(((ImActorModelNetworkApiApiBroker_InitMTProto *) check_class_cast(message, [ImActorModelNetworkApiApiBroker_InitMTProto class])))) getAuthId]);
  }
  else if ([message isKindOfClass:[ImActorModelNetworkApiApiBroker_PerformRequest class]]) {
    ImActorModelNetworkApiApiBroker_performRequestWithLong_withAPRequest_withAMRpcCallback_(self, [((AMAtomicLongCompat *) nil_chk(ImActorModelNetworkApiApiBroker_NEXT_RPC_ID_)) getAndIncrement], [((ImActorModelNetworkApiApiBroker_PerformRequest *) nil_chk(((ImActorModelNetworkApiApiBroker_PerformRequest *) check_class_cast(message, [ImActorModelNetworkApiApiBroker_PerformRequest class])))) getMessage], [((ImActorModelNetworkApiApiBroker_PerformRequest *) nil_chk(((ImActorModelNetworkApiApiBroker_PerformRequest *) check_class_cast(message, [ImActorModelNetworkApiApiBroker_PerformRequest class])))) getCallback]);
  }
  else if ([message isKindOfClass:[ImActorModelNetworkApiApiBroker_CancelRequest class]]) {
    ImActorModelNetworkApiApiBroker_cancelRequestWithLong_(self, [((ImActorModelNetworkApiApiBroker_CancelRequest *) nil_chk(((ImActorModelNetworkApiApiBroker_CancelRequest *) check_class_cast(message, [ImActorModelNetworkApiApiBroker_CancelRequest class])))) getRandomId]);
  }
  else if ([message isKindOfClass:[ImActorModelNetworkApiApiBroker_ProtoResponse class]]) {
    ImActorModelNetworkApiApiBroker_processResponseWithLong_withByteArray_(self, [((ImActorModelNetworkApiApiBroker_ProtoResponse *) nil_chk(((ImActorModelNetworkApiApiBroker_ProtoResponse *) check_class_cast(message, [ImActorModelNetworkApiApiBroker_ProtoResponse class])))) getResponseId], [((ImActorModelNetworkApiApiBroker_ProtoResponse *) nil_chk(((ImActorModelNetworkApiApiBroker_ProtoResponse *) check_class_cast(message, [ImActorModelNetworkApiApiBroker_ProtoResponse class])))) getData]);
  }
  else if ([message isKindOfClass:[ImActorModelNetworkApiApiBroker_ForceResend class]]) {
    ImActorModelNetworkApiApiBroker_forceResendWithLong_(self, ((ImActorModelNetworkApiApiBroker_ForceResend *) nil_chk(((ImActorModelNetworkApiApiBroker_ForceResend *) check_class_cast(message, [ImActorModelNetworkApiApiBroker_ForceResend class]))))->id__);
  }
  else if ([message isKindOfClass:[ImActorModelNetworkApiApiBroker_ProtoUpdate class]]) {
    ImActorModelNetworkApiApiBroker_processUpdateWithByteArray_(self, [((ImActorModelNetworkApiApiBroker_ProtoUpdate *) nil_chk(((ImActorModelNetworkApiApiBroker_ProtoUpdate *) check_class_cast(message, [ImActorModelNetworkApiApiBroker_ProtoUpdate class])))) getData]);
  }
  else if ([message isKindOfClass:[ImActorModelNetworkApiApiBroker_NetworkChanged class]]) {
    ImActorModelNetworkApiApiBroker_onNetworkChanged(self);
  }
}

- (void)onNetworkChanged {
  ImActorModelNetworkApiApiBroker_onNetworkChanged(self);
}

- (void)requestAuthId {
  ImActorModelNetworkApiApiBroker_requestAuthId(self);
}

- (void)createMtProtoWithLong:(jlong)key {
  ImActorModelNetworkApiApiBroker_createMtProtoWithLong_(self, key);
}

- (void)performRequestWithLong:(jlong)randomId
                 withAPRequest:(APRequest *)message
             withAMRpcCallback:(id<AMRpcCallback>)callback {
  ImActorModelNetworkApiApiBroker_performRequestWithLong_withAPRequest_withAMRpcCallback_(self, randomId, message, callback);
}

- (void)processResponseWithLong:(jlong)mid
                  withByteArray:(IOSByteArray *)content {
  ImActorModelNetworkApiApiBroker_processResponseWithLong_withByteArray_(self, mid, content);
}

- (void)forceResendWithLong:(jlong)randomId {
  ImActorModelNetworkApiApiBroker_forceResendWithLong_(self, randomId);
}

- (void)cancelRequestWithLong:(jlong)randomId {
  ImActorModelNetworkApiApiBroker_cancelRequestWithLong_(self, randomId);
}

- (void)processUpdateWithByteArray:(IOSByteArray *)content {
  ImActorModelNetworkApiApiBroker_processUpdateWithByteArray_(self, content);
}

+ (void)initialize {
  if (self == [ImActorModelNetworkApiApiBroker class]) {
    ImActorModelNetworkApiApiBroker_NEXT_RPC_ID_ = DKEnvironment_createAtomicLongWithLong_(1);
    J2OBJC_SET_INITIALIZED(ImActorModelNetworkApiApiBroker)
  }
}

@end

DKActorRef *ImActorModelNetworkApiApiBroker_getWithAMEndpoints_withAMAuthKeyStorage_withAMActorApiCallback_withAMNetworkProvider_(AMEndpoints *endpoints, id<AMAuthKeyStorage> keyStorage, id<AMActorApiCallback> callback, id<AMNetworkProvider> networkProvider) {
  ImActorModelNetworkApiApiBroker_initialize();
  return [((DKActorSystem *) nil_chk(DKActorSystem_system())) actorOfWithDKProps:DKProps_createWithIOSClass_withDKActorCreator_(ImActorModelNetworkApiApiBroker_class_(), new_ImActorModelNetworkApiApiBroker_$1_initWithAMEndpoints_withAMAuthKeyStorage_withAMActorApiCallback_withAMNetworkProvider_(endpoints, keyStorage, callback, networkProvider)) withNSString:@"api/broker"];
}

void ImActorModelNetworkApiApiBroker_initWithAMEndpoints_withAMAuthKeyStorage_withAMActorApiCallback_withAMNetworkProvider_(ImActorModelNetworkApiApiBroker *self, AMEndpoints *endpoints, id<AMAuthKeyStorage> keyStorage, id<AMActorApiCallback> callback, id<AMNetworkProvider> networkProvider) {
  (void) DKActor_init(self);
  self->requests_ = new_JavaUtilHashMap_init();
  self->idMap_ = new_JavaUtilHashMap_init();
  self->authIdBackOff_ = new_AMExponentialBackoff_init();
  self->endpoints_ = endpoints;
  self->keyStorage_ = keyStorage;
  self->callback_ = callback;
  self->networkProvider_ = networkProvider;
}

ImActorModelNetworkApiApiBroker *new_ImActorModelNetworkApiApiBroker_initWithAMEndpoints_withAMAuthKeyStorage_withAMActorApiCallback_withAMNetworkProvider_(AMEndpoints *endpoints, id<AMAuthKeyStorage> keyStorage, id<AMActorApiCallback> callback, id<AMNetworkProvider> networkProvider) {
  ImActorModelNetworkApiApiBroker *self = [ImActorModelNetworkApiApiBroker alloc];
  ImActorModelNetworkApiApiBroker_initWithAMEndpoints_withAMAuthKeyStorage_withAMActorApiCallback_withAMNetworkProvider_(self, endpoints, keyStorage, callback, networkProvider);
  return self;
}

void ImActorModelNetworkApiApiBroker_onNetworkChanged(ImActorModelNetworkApiApiBroker *self) {
  if (self->proto_ != nil) {
    [self->proto_ onNetworkChanged];
  }
}

void ImActorModelNetworkApiApiBroker_requestAuthId(ImActorModelNetworkApiApiBroker *self) {
  AMLog_dWithNSString_withNSString_(ImActorModelNetworkApiApiBroker_TAG_, @"Creating auth key...");
  MTAuthIdRetriever_requestAuthIdWithAMEndpoints_withAMNetworkProvider_withMTAuthIdRetriever_AuthIdCallback_(self->endpoints_, self->networkProvider_, new_ImActorModelNetworkApiApiBroker_$2_initWithImActorModelNetworkApiApiBroker_(self));
}

void ImActorModelNetworkApiApiBroker_createMtProtoWithLong_(ImActorModelNetworkApiApiBroker *self, jlong key) {
  AMLog_dWithNSString_withNSString_(ImActorModelNetworkApiApiBroker_TAG_, @"Creating proto");
  [((id<AMAuthKeyStorage>) nil_chk(self->keyStorage_)) saveAuthKey:key];
  self->proto_ = new_MTMTProto_initWithLong_withLong_withAMEndpoints_withMTMTProtoCallback_withAMNetworkProvider_(key, [new_JavaUtilRandom_init() nextLong], self->endpoints_, new_ImActorModelNetworkApiApiBroker_$3_initWithImActorModelNetworkApiApiBroker_(self), self->networkProvider_);
  for (ImActorModelNetworkApiApiBroker_RequestHolder * __strong holder in nil_chk([((JavaUtilHashMap *) nil_chk(self->requests_)) values])) {
    ((ImActorModelNetworkApiApiBroker_RequestHolder *) nil_chk(holder))->protoId_ = [self->proto_ sendRpcMessageWithMTProtoStruct:holder->message_];
    (void) [((JavaUtilHashMap *) nil_chk(self->idMap_)) putWithId:JavaLangLong_valueOfWithLong_(holder->protoId_) withId:JavaLangLong_valueOfWithLong_(holder->publicId_)];
  }
}

void ImActorModelNetworkApiApiBroker_performRequestWithLong_withAPRequest_withAMRpcCallback_(ImActorModelNetworkApiApiBroker *self, jlong randomId, APRequest *message, id<AMRpcCallback> callback) {
  AMLog_dWithNSString_withNSString_(ImActorModelNetworkApiApiBroker_TAG_, JreStrcat("$J$@", @"-> request#", randomId, @": ", message));
  ImActorModelNetworkApiApiBroker_RequestHolder *holder = new_ImActorModelNetworkApiApiBroker_RequestHolder_initWithImActorModelNetworkApiApiBroker_withLong_withMTRpcRequest_withAMRpcCallback_(self, randomId, new_MTRpcRequest_initWithInt_withByteArray_([((APRequest *) nil_chk(message)) getHeaderKey], [message toByteArray]), callback);
  (void) [((JavaUtilHashMap *) nil_chk(self->requests_)) putWithId:JavaLangLong_valueOfWithLong_(holder->publicId_) withId:holder];
  if (self->proto_ != nil) {
    jlong mid = [self->proto_ sendRpcMessageWithMTProtoStruct:holder->message_];
    holder->protoId_ = mid;
    (void) [((JavaUtilHashMap *) nil_chk(self->idMap_)) putWithId:JavaLangLong_valueOfWithLong_(mid) withId:JavaLangLong_valueOfWithLong_(randomId)];
  }
}

void ImActorModelNetworkApiApiBroker_processResponseWithLong_withByteArray_(ImActorModelNetworkApiApiBroker *self, jlong mid, IOSByteArray *content) {
  MTProtoStruct *protoStruct;
  @try {
    protoStruct = MTProtoSerializer_readRpcResponsePayloadWithByteArray_(content);
  }
  @catch (JavaIoIOException *e) {
    [((JavaIoIOException *) nil_chk(e)) printStackTrace];
    AMLog_wWithNSString_withNSString_(ImActorModelNetworkApiApiBroker_TAG_, JreStrcat("$J", @"Broken response mid#", mid));
    return;
  }
  jlong rid;
  if ([((JavaUtilHashMap *) nil_chk(self->idMap_)) containsKeyWithId:JavaLangLong_valueOfWithLong_(mid)]) {
    rid = [((JavaLangLong *) nil_chk([self->idMap_ getWithId:JavaLangLong_valueOfWithLong_(mid)])) longLongValue];
  }
  else {
    return;
  }
  ImActorModelNetworkApiApiBroker_RequestHolder *holder;
  if ([((JavaUtilHashMap *) nil_chk(self->requests_)) containsKeyWithId:JavaLangLong_valueOfWithLong_(rid)]) {
    holder = [self->requests_ getWithId:JavaLangLong_valueOfWithLong_(rid)];
  }
  else {
    return;
  }
  if ([protoStruct isKindOfClass:[MTRpcOk class]]) {
    MTRpcOk *ok = (MTRpcOk *) check_class_cast(protoStruct, [MTRpcOk class]);
    (void) [self->requests_ removeWithId:JavaLangLong_valueOfWithLong_(rid)];
    if (((ImActorModelNetworkApiApiBroker_RequestHolder *) nil_chk(holder))->protoId_ != 0) {
      (void) [self->idMap_ removeWithId:JavaLangLong_valueOfWithLong_(holder->protoId_)];
    }
    APResponse *response;
    @try {
      response = (APResponse *) check_class_cast([new_ImActorModelApiParserRpcParser_init() readWithInt:((MTRpcOk *) nil_chk(ok))->responseType_ withByteArray:ok->payload_], [APResponse class]);
    }
    @catch (JavaIoIOException *e) {
      [((JavaIoIOException *) nil_chk(e)) printStackTrace];
      return;
    }
    AMLog_dWithNSString_withNSString_(ImActorModelNetworkApiApiBroker_TAG_, JreStrcat("$J$@", @"<- response#", holder->publicId_, @": ", response));
    [((id<AMRpcCallback>) nil_chk(holder->callback_)) onResult:response];
  }
  else if ([protoStruct isKindOfClass:[MTRpcError class]]) {
    MTRpcError *e = (MTRpcError *) check_class_cast(protoStruct, [MTRpcError class]);
    (void) [self->requests_ removeWithId:JavaLangLong_valueOfWithLong_(rid)];
    if (((ImActorModelNetworkApiApiBroker_RequestHolder *) nil_chk(holder))->protoId_ != 0) {
      (void) [self->idMap_ removeWithId:JavaLangLong_valueOfWithLong_(holder->protoId_)];
    }
    AMLog_wWithNSString_withNSString_(ImActorModelNetworkApiApiBroker_TAG_, JreStrcat("$J$$CIC$", @"<- error#", holder->publicId_, @": ", ((MTRpcError *) nil_chk(e))->errorTag_, ' ', e->errorCode_, ' ', e->userMessage_));
    [((id<AMRpcCallback>) nil_chk(holder->callback_)) onError:new_AMRpcException_initWithNSString_withInt_withNSString_withBoolean_withByteArray_(e->errorTag_, e->errorCode_, e->userMessage_, e->canTryAgain_, e->relatedData_)];
  }
  else if ([protoStruct isKindOfClass:[MTRpcInternalError class]]) {
    MTRpcInternalError *e = ((MTRpcInternalError *) check_class_cast(protoStruct, [MTRpcInternalError class]));
    AMLog_dWithNSString_withNSString_(ImActorModelNetworkApiApiBroker_TAG_, JreStrcat("$JCI$", @"<- internal_error#", ((ImActorModelNetworkApiApiBroker_RequestHolder *) nil_chk(holder))->publicId_, ' ', [((MTRpcInternalError *) nil_chk(e)) getTryAgainDelay], @" sec"));
    if ([e isCanTryAgain]) {
      [((DKActorRef *) nil_chk([self self__])) sendWithId:new_ImActorModelNetworkApiApiBroker_ForceResend_initWithImActorModelNetworkApiApiBroker_withLong_(self, rid) withLong:[e getTryAgainDelay] * 1000LL];
    }
    else {
      (void) [self->requests_ removeWithId:JavaLangLong_valueOfWithLong_(rid)];
      if (holder->protoId_ != 0) {
        (void) [self->idMap_ removeWithId:JavaLangLong_valueOfWithLong_(holder->protoId_)];
      }
      [((id<AMRpcCallback>) nil_chk(holder->callback_)) onError:new_AMRpcInternalException_init()];
    }
  }
  else if ([protoStruct isKindOfClass:[MTRpcFloodWait class]]) {
    MTRpcFloodWait *f = (MTRpcFloodWait *) check_class_cast(protoStruct, [MTRpcFloodWait class]);
    AMLog_dWithNSString_withNSString_(ImActorModelNetworkApiApiBroker_TAG_, JreStrcat("$JCI$", @"<- flood_wait#", ((ImActorModelNetworkApiApiBroker_RequestHolder *) nil_chk(holder))->publicId_, ' ', [((MTRpcFloodWait *) nil_chk(f)) getDelay], @" sec"));
    [((DKActorRef *) nil_chk([self self__])) sendWithId:new_ImActorModelNetworkApiApiBroker_ForceResend_initWithImActorModelNetworkApiApiBroker_withLong_(self, rid) withLong:[f getDelay] * 1000LL];
  }
  else {
    AMLog_dWithNSString_withNSString_(ImActorModelNetworkApiApiBroker_TAG_, JreStrcat("$J", @"<- unknown_package#", ((ImActorModelNetworkApiApiBroker_RequestHolder *) nil_chk(holder))->publicId_));
  }
}

void ImActorModelNetworkApiApiBroker_forceResendWithLong_(ImActorModelNetworkApiApiBroker *self, jlong randomId) {
  AMLog_dWithNSString_withNSString_(ImActorModelNetworkApiApiBroker_TAG_, JreStrcat("$J", @"force resend #", randomId));
  ImActorModelNetworkApiApiBroker_RequestHolder *holder = [((JavaUtilHashMap *) nil_chk(self->requests_)) getWithId:JavaLangLong_valueOfWithLong_(randomId)];
  if (holder != nil) {
    if (holder->protoId_ != 0) {
      (void) [((JavaUtilHashMap *) nil_chk(self->idMap_)) removeWithId:JavaLangLong_valueOfWithLong_(holder->protoId_)];
      [((MTMTProto *) nil_chk(self->proto_)) cancelRpcWithLong:holder->protoId_];
    }
    AMLog_dWithNSString_withNSString_(ImActorModelNetworkApiApiBroker_TAG_, @"Post message send");
    jlong mid = [((MTMTProto *) nil_chk(self->proto_)) sendRpcMessageWithMTProtoStruct:holder->message_];
    holder->protoId_ = mid;
    (void) [((JavaUtilHashMap *) nil_chk(self->idMap_)) putWithId:JavaLangLong_valueOfWithLong_(mid) withId:JavaLangLong_valueOfWithLong_(randomId)];
  }
}

void ImActorModelNetworkApiApiBroker_cancelRequestWithLong_(ImActorModelNetworkApiApiBroker *self, jlong randomId) {
  ImActorModelNetworkApiApiBroker_RequestHolder *holder = [((JavaUtilHashMap *) nil_chk(self->requests_)) getWithId:JavaLangLong_valueOfWithLong_(randomId)];
  if (holder != nil) {
    (void) [self->requests_ removeWithId:JavaLangLong_valueOfWithLong_(randomId)];
    if (holder->protoId_ != 0 && self->proto_ != nil) {
      (void) [((JavaUtilHashMap *) nil_chk(self->idMap_)) removeWithId:JavaLangLong_valueOfWithLong_(holder->protoId_)];
      [self->proto_ cancelRpcWithLong:holder->protoId_];
    }
  }
}

void ImActorModelNetworkApiApiBroker_processUpdateWithByteArray_(ImActorModelNetworkApiApiBroker *self, IOSByteArray *content) {
  MTProtoStruct *protoStruct;
  @try {
    protoStruct = MTProtoSerializer_readUpdateWithByteArray_(content);
  }
  @catch (JavaIoIOException *e) {
    [((JavaIoIOException *) nil_chk(e)) printStackTrace];
    AMLog_wWithNSString_withNSString_(ImActorModelNetworkApiApiBroker_TAG_, @"Broken mt update");
    return;
  }
  jint type = ((MTPush *) nil_chk(((MTPush *) check_class_cast(protoStruct, [MTPush class]))))->updateType_;
  IOSByteArray *body = ((MTPush *) nil_chk(((MTPush *) check_class_cast(protoStruct, [MTPush class]))))->body_;
  APRpcScope *updateBox;
  @try {
    updateBox = [new_ImActorModelApiParserRpcParser_init() readWithInt:type withByteArray:body];
  }
  @catch (JavaIoIOException *e) {
    [((JavaIoIOException *) nil_chk(e)) printStackTrace];
    AMLog_wWithNSString_withNSString_(ImActorModelNetworkApiApiBroker_TAG_, @"Broken update box");
    return;
  }
  [((id<AMActorApiCallback>) nil_chk(self->callback_)) onUpdateReceived:updateBox];
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelNetworkApiApiBroker)

@implementation ImActorModelNetworkApiApiBroker_PerformRequest

- (instancetype)initWithAPRequest:(APRequest *)message
                withAMRpcCallback:(id<AMRpcCallback>)callback {
  ImActorModelNetworkApiApiBroker_PerformRequest_initWithAPRequest_withAMRpcCallback_(self, message, callback);
  return self;
}

- (APRequest *)getMessage {
  return message_;
}

- (id<AMRpcCallback>)getCallback {
  return callback_;
}

@end

void ImActorModelNetworkApiApiBroker_PerformRequest_initWithAPRequest_withAMRpcCallback_(ImActorModelNetworkApiApiBroker_PerformRequest *self, APRequest *message, id<AMRpcCallback> callback) {
  (void) NSObject_init(self);
  self->message_ = message;
  self->callback_ = callback;
}

ImActorModelNetworkApiApiBroker_PerformRequest *new_ImActorModelNetworkApiApiBroker_PerformRequest_initWithAPRequest_withAMRpcCallback_(APRequest *message, id<AMRpcCallback> callback) {
  ImActorModelNetworkApiApiBroker_PerformRequest *self = [ImActorModelNetworkApiApiBroker_PerformRequest alloc];
  ImActorModelNetworkApiApiBroker_PerformRequest_initWithAPRequest_withAMRpcCallback_(self, message, callback);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelNetworkApiApiBroker_PerformRequest)

@implementation ImActorModelNetworkApiApiBroker_CancelRequest

- (instancetype)initWithLong:(jlong)randomId {
  ImActorModelNetworkApiApiBroker_CancelRequest_initWithLong_(self, randomId);
  return self;
}

- (jlong)getRandomId {
  return randomId_;
}

@end

void ImActorModelNetworkApiApiBroker_CancelRequest_initWithLong_(ImActorModelNetworkApiApiBroker_CancelRequest *self, jlong randomId) {
  (void) NSObject_init(self);
  self->randomId_ = randomId;
}

ImActorModelNetworkApiApiBroker_CancelRequest *new_ImActorModelNetworkApiApiBroker_CancelRequest_initWithLong_(jlong randomId) {
  ImActorModelNetworkApiApiBroker_CancelRequest *self = [ImActorModelNetworkApiApiBroker_CancelRequest alloc];
  ImActorModelNetworkApiApiBroker_CancelRequest_initWithLong_(self, randomId);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelNetworkApiApiBroker_CancelRequest)

@implementation ImActorModelNetworkApiApiBroker_NetworkChanged

- (instancetype)init {
  ImActorModelNetworkApiApiBroker_NetworkChanged_init(self);
  return self;
}

@end

void ImActorModelNetworkApiApiBroker_NetworkChanged_init(ImActorModelNetworkApiApiBroker_NetworkChanged *self) {
  (void) NSObject_init(self);
}

ImActorModelNetworkApiApiBroker_NetworkChanged *new_ImActorModelNetworkApiApiBroker_NetworkChanged_init() {
  ImActorModelNetworkApiApiBroker_NetworkChanged *self = [ImActorModelNetworkApiApiBroker_NetworkChanged alloc];
  ImActorModelNetworkApiApiBroker_NetworkChanged_init(self);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelNetworkApiApiBroker_NetworkChanged)

@implementation ImActorModelNetworkApiApiBroker_RequestAuthId

- (instancetype)initWithImActorModelNetworkApiApiBroker:(ImActorModelNetworkApiApiBroker *)outer$ {
  ImActorModelNetworkApiApiBroker_RequestAuthId_initWithImActorModelNetworkApiApiBroker_(self, outer$);
  return self;
}

@end

void ImActorModelNetworkApiApiBroker_RequestAuthId_initWithImActorModelNetworkApiApiBroker_(ImActorModelNetworkApiApiBroker_RequestAuthId *self, ImActorModelNetworkApiApiBroker *outer$) {
  (void) NSObject_init(self);
}

ImActorModelNetworkApiApiBroker_RequestAuthId *new_ImActorModelNetworkApiApiBroker_RequestAuthId_initWithImActorModelNetworkApiApiBroker_(ImActorModelNetworkApiApiBroker *outer$) {
  ImActorModelNetworkApiApiBroker_RequestAuthId *self = [ImActorModelNetworkApiApiBroker_RequestAuthId alloc];
  ImActorModelNetworkApiApiBroker_RequestAuthId_initWithImActorModelNetworkApiApiBroker_(self, outer$);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelNetworkApiApiBroker_RequestAuthId)

@implementation ImActorModelNetworkApiApiBroker_InitMTProto

- (instancetype)initWithImActorModelNetworkApiApiBroker:(ImActorModelNetworkApiApiBroker *)outer$
                                               withLong:(jlong)authId {
  ImActorModelNetworkApiApiBroker_InitMTProto_initWithImActorModelNetworkApiApiBroker_withLong_(self, outer$, authId);
  return self;
}

- (jlong)getAuthId {
  return authId_;
}

@end

void ImActorModelNetworkApiApiBroker_InitMTProto_initWithImActorModelNetworkApiApiBroker_withLong_(ImActorModelNetworkApiApiBroker_InitMTProto *self, ImActorModelNetworkApiApiBroker *outer$, jlong authId) {
  (void) NSObject_init(self);
  self->authId_ = authId;
}

ImActorModelNetworkApiApiBroker_InitMTProto *new_ImActorModelNetworkApiApiBroker_InitMTProto_initWithImActorModelNetworkApiApiBroker_withLong_(ImActorModelNetworkApiApiBroker *outer$, jlong authId) {
  ImActorModelNetworkApiApiBroker_InitMTProto *self = [ImActorModelNetworkApiApiBroker_InitMTProto alloc];
  ImActorModelNetworkApiApiBroker_InitMTProto_initWithImActorModelNetworkApiApiBroker_withLong_(self, outer$, authId);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelNetworkApiApiBroker_InitMTProto)

@implementation ImActorModelNetworkApiApiBroker_ProtoResponse

- (instancetype)initWithImActorModelNetworkApiApiBroker:(ImActorModelNetworkApiApiBroker *)outer$
                                               withLong:(jlong)responseId
                                          withByteArray:(IOSByteArray *)data {
  ImActorModelNetworkApiApiBroker_ProtoResponse_initWithImActorModelNetworkApiApiBroker_withLong_withByteArray_(self, outer$, responseId, data);
  return self;
}

- (jlong)getResponseId {
  return responseId_;
}

- (IOSByteArray *)getData {
  return data_;
}

@end

void ImActorModelNetworkApiApiBroker_ProtoResponse_initWithImActorModelNetworkApiApiBroker_withLong_withByteArray_(ImActorModelNetworkApiApiBroker_ProtoResponse *self, ImActorModelNetworkApiApiBroker *outer$, jlong responseId, IOSByteArray *data) {
  (void) NSObject_init(self);
  self->responseId_ = responseId;
  self->data_ = data;
}

ImActorModelNetworkApiApiBroker_ProtoResponse *new_ImActorModelNetworkApiApiBroker_ProtoResponse_initWithImActorModelNetworkApiApiBroker_withLong_withByteArray_(ImActorModelNetworkApiApiBroker *outer$, jlong responseId, IOSByteArray *data) {
  ImActorModelNetworkApiApiBroker_ProtoResponse *self = [ImActorModelNetworkApiApiBroker_ProtoResponse alloc];
  ImActorModelNetworkApiApiBroker_ProtoResponse_initWithImActorModelNetworkApiApiBroker_withLong_withByteArray_(self, outer$, responseId, data);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelNetworkApiApiBroker_ProtoResponse)

@implementation ImActorModelNetworkApiApiBroker_ProtoUpdate

- (instancetype)initWithImActorModelNetworkApiApiBroker:(ImActorModelNetworkApiApiBroker *)outer$
                                          withByteArray:(IOSByteArray *)data {
  ImActorModelNetworkApiApiBroker_ProtoUpdate_initWithImActorModelNetworkApiApiBroker_withByteArray_(self, outer$, data);
  return self;
}

- (IOSByteArray *)getData {
  return data_;
}

@end

void ImActorModelNetworkApiApiBroker_ProtoUpdate_initWithImActorModelNetworkApiApiBroker_withByteArray_(ImActorModelNetworkApiApiBroker_ProtoUpdate *self, ImActorModelNetworkApiApiBroker *outer$, IOSByteArray *data) {
  (void) NSObject_init(self);
  self->data_ = data;
}

ImActorModelNetworkApiApiBroker_ProtoUpdate *new_ImActorModelNetworkApiApiBroker_ProtoUpdate_initWithImActorModelNetworkApiApiBroker_withByteArray_(ImActorModelNetworkApiApiBroker *outer$, IOSByteArray *data) {
  ImActorModelNetworkApiApiBroker_ProtoUpdate *self = [ImActorModelNetworkApiApiBroker_ProtoUpdate alloc];
  ImActorModelNetworkApiApiBroker_ProtoUpdate_initWithImActorModelNetworkApiApiBroker_withByteArray_(self, outer$, data);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelNetworkApiApiBroker_ProtoUpdate)

@implementation ImActorModelNetworkApiApiBroker_ForceResend

- (instancetype)initWithImActorModelNetworkApiApiBroker:(ImActorModelNetworkApiApiBroker *)outer$
                                               withLong:(jlong)id_ {
  ImActorModelNetworkApiApiBroker_ForceResend_initWithImActorModelNetworkApiApiBroker_withLong_(self, outer$, id_);
  return self;
}

- (jlong)getId {
  return id__;
}

@end

void ImActorModelNetworkApiApiBroker_ForceResend_initWithImActorModelNetworkApiApiBroker_withLong_(ImActorModelNetworkApiApiBroker_ForceResend *self, ImActorModelNetworkApiApiBroker *outer$, jlong id_) {
  (void) NSObject_init(self);
  self->id__ = id_;
}

ImActorModelNetworkApiApiBroker_ForceResend *new_ImActorModelNetworkApiApiBroker_ForceResend_initWithImActorModelNetworkApiApiBroker_withLong_(ImActorModelNetworkApiApiBroker *outer$, jlong id_) {
  ImActorModelNetworkApiApiBroker_ForceResend *self = [ImActorModelNetworkApiApiBroker_ForceResend alloc];
  ImActorModelNetworkApiApiBroker_ForceResend_initWithImActorModelNetworkApiApiBroker_withLong_(self, outer$, id_);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelNetworkApiApiBroker_ForceResend)

@implementation ImActorModelNetworkApiApiBroker_RequestHolder

- (instancetype)initWithImActorModelNetworkApiApiBroker:(ImActorModelNetworkApiApiBroker *)outer$
                                               withLong:(jlong)publicId
                                       withMTRpcRequest:(MTRpcRequest *)message
                                      withAMRpcCallback:(id<AMRpcCallback>)callback {
  ImActorModelNetworkApiApiBroker_RequestHolder_initWithImActorModelNetworkApiApiBroker_withLong_withMTRpcRequest_withAMRpcCallback_(self, outer$, publicId, message, callback);
  return self;
}

@end

void ImActorModelNetworkApiApiBroker_RequestHolder_initWithImActorModelNetworkApiApiBroker_withLong_withMTRpcRequest_withAMRpcCallback_(ImActorModelNetworkApiApiBroker_RequestHolder *self, ImActorModelNetworkApiApiBroker *outer$, jlong publicId, MTRpcRequest *message, id<AMRpcCallback> callback) {
  (void) NSObject_init(self);
  self->message_ = message;
  self->publicId_ = publicId;
  self->callback_ = callback;
}

ImActorModelNetworkApiApiBroker_RequestHolder *new_ImActorModelNetworkApiApiBroker_RequestHolder_initWithImActorModelNetworkApiApiBroker_withLong_withMTRpcRequest_withAMRpcCallback_(ImActorModelNetworkApiApiBroker *outer$, jlong publicId, MTRpcRequest *message, id<AMRpcCallback> callback) {
  ImActorModelNetworkApiApiBroker_RequestHolder *self = [ImActorModelNetworkApiApiBroker_RequestHolder alloc];
  ImActorModelNetworkApiApiBroker_RequestHolder_initWithImActorModelNetworkApiApiBroker_withLong_withMTRpcRequest_withAMRpcCallback_(self, outer$, publicId, message, callback);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelNetworkApiApiBroker_RequestHolder)

@implementation ImActorModelNetworkApiApiBroker_$1

- (ImActorModelNetworkApiApiBroker *)create {
  return new_ImActorModelNetworkApiApiBroker_initWithAMEndpoints_withAMAuthKeyStorage_withAMActorApiCallback_withAMNetworkProvider_(val$endpoints_, val$keyStorage_, val$callback_, val$networkProvider_);
}

- (instancetype)initWithAMEndpoints:(AMEndpoints *)capture$0
               withAMAuthKeyStorage:(id<AMAuthKeyStorage>)capture$1
             withAMActorApiCallback:(id<AMActorApiCallback>)capture$2
              withAMNetworkProvider:(id<AMNetworkProvider>)capture$3 {
  ImActorModelNetworkApiApiBroker_$1_initWithAMEndpoints_withAMAuthKeyStorage_withAMActorApiCallback_withAMNetworkProvider_(self, capture$0, capture$1, capture$2, capture$3);
  return self;
}

@end

void ImActorModelNetworkApiApiBroker_$1_initWithAMEndpoints_withAMAuthKeyStorage_withAMActorApiCallback_withAMNetworkProvider_(ImActorModelNetworkApiApiBroker_$1 *self, AMEndpoints *capture$0, id<AMAuthKeyStorage> capture$1, id<AMActorApiCallback> capture$2, id<AMNetworkProvider> capture$3) {
  self->val$endpoints_ = capture$0;
  self->val$keyStorage_ = capture$1;
  self->val$callback_ = capture$2;
  self->val$networkProvider_ = capture$3;
  (void) NSObject_init(self);
}

ImActorModelNetworkApiApiBroker_$1 *new_ImActorModelNetworkApiApiBroker_$1_initWithAMEndpoints_withAMAuthKeyStorage_withAMActorApiCallback_withAMNetworkProvider_(AMEndpoints *capture$0, id<AMAuthKeyStorage> capture$1, id<AMActorApiCallback> capture$2, id<AMNetworkProvider> capture$3) {
  ImActorModelNetworkApiApiBroker_$1 *self = [ImActorModelNetworkApiApiBroker_$1 alloc];
  ImActorModelNetworkApiApiBroker_$1_initWithAMEndpoints_withAMAuthKeyStorage_withAMActorApiCallback_withAMNetworkProvider_(self, capture$0, capture$1, capture$2, capture$3);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelNetworkApiApiBroker_$1)

@implementation ImActorModelNetworkApiApiBroker_$2

- (void)onSuccessWithLong:(jlong)authId {
  AMLog_dWithNSString_withNSString_(ImActorModelNetworkApiApiBroker_get_TAG_(), JreStrcat("$J", @"Key created: ", authId));
  [((DKActorRef *) nil_chk([this$0_ self__])) sendWithId:new_ImActorModelNetworkApiApiBroker_InitMTProto_initWithImActorModelNetworkApiApiBroker_withLong_(this$0_, authId)];
}

- (void)onFailure {
  AMLog_dWithNSString_withNSString_(ImActorModelNetworkApiApiBroker_get_TAG_(), @"Key creation failure");
  [((AMExponentialBackoff *) nil_chk(this$0_->authIdBackOff_)) onFailure];
  jlong delay = [this$0_->authIdBackOff_ exponentialWait];
  AMLog_dWithNSString_withNSString_(ImActorModelNetworkApiApiBroker_get_TAG_(), JreStrcat("$J$", @"Key creation delay in ", delay, @" ms"));
  [((DKActorRef *) nil_chk([this$0_ self__])) sendWithId:new_ImActorModelNetworkApiApiBroker_RequestAuthId_initWithImActorModelNetworkApiApiBroker_(this$0_) withLong:delay];
}

- (instancetype)initWithImActorModelNetworkApiApiBroker:(ImActorModelNetworkApiApiBroker *)outer$ {
  ImActorModelNetworkApiApiBroker_$2_initWithImActorModelNetworkApiApiBroker_(self, outer$);
  return self;
}

@end

void ImActorModelNetworkApiApiBroker_$2_initWithImActorModelNetworkApiApiBroker_(ImActorModelNetworkApiApiBroker_$2 *self, ImActorModelNetworkApiApiBroker *outer$) {
  self->this$0_ = outer$;
  (void) NSObject_init(self);
}

ImActorModelNetworkApiApiBroker_$2 *new_ImActorModelNetworkApiApiBroker_$2_initWithImActorModelNetworkApiApiBroker_(ImActorModelNetworkApiApiBroker *outer$) {
  ImActorModelNetworkApiApiBroker_$2 *self = [ImActorModelNetworkApiApiBroker_$2 alloc];
  ImActorModelNetworkApiApiBroker_$2_initWithImActorModelNetworkApiApiBroker_(self, outer$);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelNetworkApiApiBroker_$2)

@implementation ImActorModelNetworkApiApiBroker_$3

- (void)onRpcResponseWithLong:(jlong)mid
                withByteArray:(IOSByteArray *)content {
  [((DKActorRef *) nil_chk([this$0_ self__])) sendWithId:new_ImActorModelNetworkApiApiBroker_ProtoResponse_initWithImActorModelNetworkApiApiBroker_withLong_withByteArray_(this$0_, mid, content)];
}

- (void)onUpdateWithByteArray:(IOSByteArray *)content {
  [((DKActorRef *) nil_chk([this$0_ self__])) sendWithId:new_ImActorModelNetworkApiApiBroker_ProtoUpdate_initWithImActorModelNetworkApiApiBroker_withByteArray_(this$0_, content)];
}

- (void)onAuthKeyInvalidatedWithLong:(jlong)authKey {
  [((id<AMActorApiCallback>) nil_chk(this$0_->callback_)) onAuthIdInvalidatedWithAuthKey:authKey];
}

- (void)onSessionCreated {
  [((id<AMActorApiCallback>) nil_chk(this$0_->callback_)) onNewSessionCreated];
}

- (instancetype)initWithImActorModelNetworkApiApiBroker:(ImActorModelNetworkApiApiBroker *)outer$ {
  ImActorModelNetworkApiApiBroker_$3_initWithImActorModelNetworkApiApiBroker_(self, outer$);
  return self;
}

@end

void ImActorModelNetworkApiApiBroker_$3_initWithImActorModelNetworkApiApiBroker_(ImActorModelNetworkApiApiBroker_$3 *self, ImActorModelNetworkApiApiBroker *outer$) {
  self->this$0_ = outer$;
  (void) NSObject_init(self);
}

ImActorModelNetworkApiApiBroker_$3 *new_ImActorModelNetworkApiApiBroker_$3_initWithImActorModelNetworkApiApiBroker_(ImActorModelNetworkApiApiBroker *outer$) {
  ImActorModelNetworkApiApiBroker_$3 *self = [ImActorModelNetworkApiApiBroker_$3 alloc];
  ImActorModelNetworkApiApiBroker_$3_initWithImActorModelNetworkApiApiBroker_(self, outer$);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelNetworkApiApiBroker_$3)
