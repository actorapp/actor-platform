//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/ex3ndr/Develop/actor-model/library/actor-cocoa-base/build/java/im/actor/model/viewmodel/AppStateVM.java
//


#line 1 "/Users/ex3ndr/Develop/actor-model/library/actor-cocoa-base/build/java/im/actor/model/viewmodel/AppStateVM.java"

#include "J2ObjC_source.h"
#include "im/actor/model/droidkit/engine/PreferencesStorage.h"
#include "im/actor/model/modules/Modules.h"
#include "im/actor/model/mvvm/ValueModel.h"
#include "im/actor/model/viewmodel/AppStateVM.h"
#include "java/lang/Boolean.h"

@interface AMAppStateVM () {
 @public
  ImActorModelModulesModules *modules_;
  AMValueModel *isDialogsEmpty_;
  AMValueModel *isContactsEmpty_;
  AMValueModel *isAppEmpty_;
  AMValueModel *isAppLoaded_;
  jboolean isBookImported_;
  jboolean isDialogsLoaded_;
  jboolean isContactsLoaded_;
}

- (void)updateLoaded;

@end

J2OBJC_FIELD_SETTER(AMAppStateVM, modules_, ImActorModelModulesModules *)
J2OBJC_FIELD_SETTER(AMAppStateVM, isDialogsEmpty_, AMValueModel *)
J2OBJC_FIELD_SETTER(AMAppStateVM, isContactsEmpty_, AMValueModel *)
J2OBJC_FIELD_SETTER(AMAppStateVM, isAppEmpty_, AMValueModel *)
J2OBJC_FIELD_SETTER(AMAppStateVM, isAppLoaded_, AMValueModel *)

__attribute__((unused)) static void AMAppStateVM_updateLoaded(AMAppStateVM *self);


#line 13
@implementation AMAppStateVM


#line 29
- (instancetype)initWithImActorModelModulesModules:(ImActorModelModulesModules *)modules {
  AMAppStateVM_initWithImActorModelModulesModules_(self, modules);
  return self;
}


#line 42
- (void)updateLoaded {
  AMAppStateVM_updateLoaded(self);
}


#line 54
- (void)onDialogsChangedWithBoolean:(jboolean)isEmpty {
  @synchronized(self) {
    
#line 55
    if ([((JavaLangBoolean *) nil_chk([((AMValueModel *) nil_chk(isDialogsEmpty_)) get])) booleanValue] != isEmpty) {
      [((id<DKPreferencesStorage>) nil_chk([((ImActorModelModulesModules *) nil_chk(modules_)) getPreferences])) putBool:@"app.dialogs.empty" withValue:isEmpty];
      [isDialogsEmpty_ changeWithId:JavaLangBoolean_valueOfWithBoolean_(isEmpty)];
    }
    if (!isEmpty) {
      if ([((JavaLangBoolean *) nil_chk([((AMValueModel *) nil_chk(isAppEmpty_)) get])) booleanValue]) {
        [((id<DKPreferencesStorage>) nil_chk([((ImActorModelModulesModules *) nil_chk(modules_)) getPreferences])) putBool:@"app.empty" withValue:NO];
        [isAppEmpty_ changeWithId:JavaLangBoolean_valueOfWithBoolean_(NO)];
      }
    }
  }
}


#line 72
- (void)onContactsChangedWithBoolean:(jboolean)isEmpty {
  @synchronized(self) {
    
#line 73
    if ([((JavaLangBoolean *) nil_chk([((AMValueModel *) nil_chk(isContactsEmpty_)) get])) booleanValue] != isEmpty) {
      [((id<DKPreferencesStorage>) nil_chk([((ImActorModelModulesModules *) nil_chk(modules_)) getPreferences])) putBool:@"app.contacts.empty" withValue:isEmpty];
      [isContactsEmpty_ changeWithId:JavaLangBoolean_valueOfWithBoolean_(isEmpty)];
    }
    if (!isEmpty) {
      if ([((JavaLangBoolean *) nil_chk([((AMValueModel *) nil_chk(isAppEmpty_)) get])) booleanValue]) {
        [((id<DKPreferencesStorage>) nil_chk([((ImActorModelModulesModules *) nil_chk(modules_)) getPreferences])) putBool:@"app.empty" withValue:NO];
        [isAppEmpty_ changeWithId:JavaLangBoolean_valueOfWithBoolean_(NO)];
      }
    }
  }
}


#line 88
- (void)onPhoneImported {
  @synchronized(self) {
    
#line 89
    if (!isBookImported_) {
      isBookImported_ = YES;
      [((id<DKPreferencesStorage>) nil_chk([((ImActorModelModulesModules *) nil_chk(modules_)) getPreferences])) putBool:@"app.contacts.imported" withValue:YES];
      AMAppStateVM_updateLoaded(self);
    }
  }
}


#line 99
- (void)onDialogsLoaded {
  @synchronized(self) {
    
#line 100
    if (!isDialogsLoaded_) {
      isDialogsLoaded_ = YES;
      [((id<DKPreferencesStorage>) nil_chk([((ImActorModelModulesModules *) nil_chk(modules_)) getPreferences])) putBool:@"app.dialogs.loaded" withValue:YES];
      AMAppStateVM_updateLoaded(self);
    }
  }
}


#line 110
- (void)onContactsLoaded {
  @synchronized(self) {
    
#line 111
    if (!isContactsLoaded_) {
      isContactsLoaded_ = YES;
      [((id<DKPreferencesStorage>) nil_chk([((ImActorModelModulesModules *) nil_chk(modules_)) getPreferences])) putBool:@"app.contacts.loaded" withValue:YES];
      AMAppStateVM_updateLoaded(self);
    }
  }
}


#line 123
- (AMValueModel *)getIsDialogsEmpty {
  return isDialogsEmpty_;
}


#line 132
- (AMValueModel *)getIsContactsEmpty {
  return isContactsEmpty_;
}


#line 141
- (AMValueModel *)getIsAppLoaded {
  return isAppLoaded_;
}


#line 150
- (AMValueModel *)getIsAppEmpty {
  return isAppEmpty_;
}

@end


#line 29
void AMAppStateVM_initWithImActorModelModulesModules_(AMAppStateVM *self, ImActorModelModulesModules *modules) {
  (void) NSObject_init(self);
  
#line 30
  self->modules_ = modules;
  self->isDialogsEmpty_ = new_AMValueModel_initWithNSString_withId_(@"app.dialogs.empty", JavaLangBoolean_valueOfWithBoolean_([((id<DKPreferencesStorage>) nil_chk([((ImActorModelModulesModules *) nil_chk(modules)) getPreferences])) getBool:@"app.dialogs.empty" withDefault:YES]));
  self->isContactsEmpty_ = new_AMValueModel_initWithNSString_withId_(@"app.contacts.empty", JavaLangBoolean_valueOfWithBoolean_([((id<DKPreferencesStorage>) nil_chk([modules getPreferences])) getBool:@"app.contacts.empty" withDefault:YES]));
  self->isAppEmpty_ = new_AMValueModel_initWithNSString_withId_(@"app.empty", JavaLangBoolean_valueOfWithBoolean_([((id<DKPreferencesStorage>) nil_chk([modules getPreferences])) getBool:@"app.empty" withDefault:YES]));
  
#line 35
  self->isBookImported_ = [((id<DKPreferencesStorage>) nil_chk([modules getPreferences])) getBool:@"app.contacts.imported" withDefault:NO];
  self->isDialogsLoaded_ = [((id<DKPreferencesStorage>) nil_chk([modules getPreferences])) getBool:@"app.dialogs.loaded" withDefault:NO];
  self->isContactsLoaded_ = [((id<DKPreferencesStorage>) nil_chk([modules getPreferences])) getBool:@"app.contacts.loaded" withDefault:NO];
  
#line 39
  self->isAppLoaded_ = new_AMValueModel_initWithNSString_withId_(@"app.loaded", JavaLangBoolean_valueOfWithBoolean_(self->isBookImported_ && self->isDialogsLoaded_ && self->isContactsLoaded_));
}


#line 29
AMAppStateVM *new_AMAppStateVM_initWithImActorModelModulesModules_(ImActorModelModulesModules *modules) {
  AMAppStateVM *self = [AMAppStateVM alloc];
  AMAppStateVM_initWithImActorModelModulesModules_(self, modules);
  return self;
}


#line 42
void AMAppStateVM_updateLoaded(AMAppStateVM *self) {
  jboolean val = self->isBookImported_ && self->isDialogsLoaded_ && self->isContactsLoaded_;
  if ([((JavaLangBoolean *) nil_chk([((AMValueModel *) nil_chk(self->isAppLoaded_)) get])) booleanValue] != val) {
    [self->isAppLoaded_ changeWithId:JavaLangBoolean_valueOfWithBoolean_(val)];
  }
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(AMAppStateVM)
